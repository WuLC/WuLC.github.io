<!doctype html><html lang=zh-CN><meta charset=UTF-8><meta content="width=device-width" name=viewport><meta content=#222 name=theme-color><meta content="Hexo 7.3.0" name=generator><link href=/imgs/favicon.ico rel=apple-touch-icon sizes=180x180><link href=/imgs/favicon.ico rel=icon sizes=32x32 type=image/png><link href=/imgs/favicon.ico rel=icon sizes=16x16 type=image/png><link color=#222 href=/imgs/favicon.ico rel=mask-icon><meta content=VcC-PHB4Om9SIR3Roqm7k1N-SHiBtQ6c3LJLVMKgU4U name=google-site-verification><meta content=cc79d2405dbf4293a4d12323dfb8ef24 name=msvalidate.01><meta content=z0l07oey8Mtx46FB name=baidu-site-verification><style>:root{--body-bg-color:#f5f7f9;--content-bg-color:#fff;--card-bg-color:#f5f5f5;--text-color:#555;--selection-bg:#262a30;--selection-color:#eee;--blockquote-color:#666;--link-color:#555;--link-hover-color:#222;--brand-color:#fff;--brand-hover-color:#fff;--table-row-odd-bg-color:#f9f9f9;--table-row-hover-bg-color:#f5f5f5;--menu-item-bg-color:#f5f5f5;--theme-color:#222;--btn-default-bg:#fff;--btn-default-color:#555;--btn-default-border-color:#555;--btn-default-hover-bg:#222;--btn-default-hover-color:#fff;--btn-default-hover-border-color:#222;--highlight-background:#f3f3f3;--highlight-foreground:#444;--highlight-gutter-background:#e1e1e1;--highlight-gutter-foreground:#555;color-scheme:light}html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{margin:.67em 0;font-size:2em}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace;font-size:1em}a{background:0 0}abbr[title]{border-bottom:none;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace;font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:100%;line-height:1.15}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted buttontext}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;white-space:normal;max-width:100%;padding:0;display:table}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}details{display:block}summary{display:list-item}template,[hidden]{display:none}::selection{background:var(--selection-bg);color:var(--selection-color)}html,body{height:100%}body{background:var(--body-bg-color);box-sizing:border-box;color:var(--text-color);min-height:100%;font-family:Lato,PingFang SC,Microsoft YaHei,sans-serif;font-size:1em;line-height:2;transition:padding .2s ease-in-out;position:relative}h1,h2,h3,h4,h5,h6{margin:30px 0 15px;font-family:Lato,PingFang SC,Microsoft YaHei,sans-serif;font-weight:700;line-height:1.5}h1{font-size:1.5em}h2{font-size:1.375em}h3{font-size:1.25em}h4{font-size:1.125em}h5{font-size:1em}h6{font-size:.875em}a{color:var(--link-color);cursor:pointer;overflow-wrap:break-word;border-bottom:1px solid #999;outline:0;text-decoration:none}a:hover{border-bottom-color:var(--link-hover-color);color:var(--link-hover-color)}iframe,img,video,embed{max-width:100%;margin-left:auto;margin-right:auto;display:block}hr{background-image:repeating-linear-gradient(-45deg,#ddd,#ddd 4px,#0000 4px 8px);border:0;height:3px;margin:40px 0}blockquote{color:var(--blockquote-color);border-left:4px solid #ddd;margin:0;padding:0 15px}blockquote cite:before{content:"-";padding:0 5px}dt{font-weight:700}dd{margin:0;padding:0}.table-container{overflow:auto}table{border-collapse:collapse;border-spacing:0;width:100%;margin:0 0 20px;font-size:.875em}tbody tr:nth-of-type(odd){background:var(--table-row-odd-bg-color)}tbody tr:hover{background:var(--table-row-hover-bg-color)}caption,th,td{padding:8px}th,td{border:1px solid #ddd;border-bottom-width:3px}th{padding-bottom:10px;font-weight:700}td{border-bottom-width:1px}.btn{background:var(--btn-default-bg);border:2px solid var(--btn-default-border-color);color:var(--btn-default-color);border-radius:2px;padding:0 20px;font-size:.875em;line-height:2;transition:background-color .2s ease-in-out;display:inline-block}.btn:hover{background:var(--btn-default-hover-bg);border-color:var(--btn-default-hover-border-color);color:var(--btn-default-hover-color)}.btn+.btn{margin:0 0 8px 8px}.btn .fa-fw{text-align:left;width:1.28571em}.toggle{line-height:0}.toggle .toggle-line{background:#fff;width:100%;height:2px;transition:left .4s,opacity .4s,top .4s,transform .4s,width .4s;display:block;position:relative;top:0;left:0}.toggle .toggle-line:first-child{margin-top:1px}.toggle .toggle-line:not(:first-child){margin-top:4px}.toggle.toggle-arrow :first-child{width:50%;top:2px;left:50%;transform:rotate(45deg)}.toggle.toggle-arrow :last-child{width:50%;top:-2px;left:50%;transform:rotate(-45deg)}.toggle.toggle-close :nth-child(2){opacity:0}.toggle.toggle-close :first-child{top:6px;transform:rotate(45deg)}.toggle.toggle-close :last-child{top:-6px;transform:rotate(-45deg)}pre code.hljs{padding:1em;display:block;overflow-x:auto}code.hljs{padding:3px 5px}.hljs{color:#444;background:#f3f3f3}.hljs-comment{color:#697070}.hljs-tag,.hljs-punctuation{color:#444a}.hljs-tag .hljs-name,.hljs-tag .hljs-attr{color:#444}.hljs-keyword,.hljs-attribute,.hljs-selector-tag,.hljs-meta .hljs-keyword,.hljs-doctag,.hljs-name{font-weight:700}.hljs-type,.hljs-string,.hljs-number,.hljs-selector-id,.hljs-selector-class,.hljs-quote,.hljs-template-tag,.hljs-deletion{color:#800}.hljs-title,.hljs-section{color:#800;font-weight:700}.hljs-regexp,.hljs-symbol,.hljs-variable,.hljs-template-variable,.hljs-link,.hljs-selector-attr,.hljs-operator,.hljs-selector-pseudo{color:#ab5656}.hljs-literal{color:#695}.hljs-built_in,.hljs-bullet,.hljs-code,.hljs-addition{color:#397300}.hljs-meta{color:#1f7199}.hljs-meta .hljs-string{color:#38a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.highlight:hover .copy-btn,.code-container:hover .copy-btn{opacity:1}.code-container{position:relative}.code-lang{opacity:.1;pointer-events:none;font-size:40px;line-height:1;position:absolute;right:5px}.copy-btn{color:#333;cursor:pointer;opacity:0;background:#fff;border:0;padding:2px 6px;font-size:.8125em;line-height:1.6;transition:opacity .2s ease-in-out;position:absolute;top:0;right:0}code,kbd,figure.highlight,pre{background:var(--highlight-background);color:var(--highlight-foreground)}figure.highlight,pre{margin:0 auto 20px;line-height:1.6}figure.highlight figcaption,pre .caption{background:var(--highlight-gutter-background);color:var(--highlight-foreground);padding:.5em;font-size:.875em;line-height:1.2;display:flow-root}figure.highlight figcaption a,pre .caption a{color:var(--highlight-foreground);float:right}figure.highlight figcaption a:hover,pre .caption a:hover{border-bottom-color:var(--highlight-foreground)}pre,code{font-family:consolas,Menlo,monospace,PingFang SC,Microsoft YaHei}code{overflow-wrap:break-word;border-radius:3px;padding:2px 4px;font-size:.875em}kbd{white-space:nowrap;border:2px solid #ccc;border-radius:.2em;padding:.1em .3em;font-family:inherit;box-shadow:.1em .1em .2em #0000001a}figure.highlight{position:relative;overflow:auto}figure.highlight pre{border:0;margin:0;padding:10px 0}figure.highlight table{border:0;width:auto;margin:0}figure.highlight td{border:0;padding:0}figure.highlight .gutter{-webkit-user-select:none;user-select:none}figure.highlight .gutter pre{background:var(--highlight-gutter-background);color:var(--highlight-gutter-foreground);text-align:right;padding-left:10px;padding-right:10px}figure.highlight .code pre{width:100%;padding-left:10px}figure.highlight .marked{background:#0000004d}pre .caption{margin-bottom:10px}.gist table{width:auto}.gist table td{border:0}pre{padding:10px;overflow:auto}pre code{text-shadow:none;background:0 0;padding:0}.blockquote-center{text-align:center;border-left:0;margin:40px 0;padding:0;position:relative}.blockquote-center:before,.blockquote-center:after{opacity:.6;width:100%;line-height:1;position:absolute;left:0}.blockquote-center:before{text-align:left;content:"";border-top:1px solid #ccc;font-family:"Font Awesome 7 Free";font-weight:900;top:-20px}.blockquote-center:after{text-align:right;content:"";border-bottom:1px solid #ccc;font-family:"Font Awesome 7 Free";font-weight:900;bottom:-20px}.blockquote-center p,.blockquote-center div{text-align:center}.group-picture{margin-bottom:20px}.group-picture .group-picture-row{gap:3px;margin-bottom:3px;display:flex}.group-picture .group-picture-column{flex:1}.group-picture .group-picture-column img{object-fit:cover;width:100%;height:100%;margin:0}.post-body .label{color:#555;padding:0 2px}.post-body .label.default{background:#f0f0f0}.post-body .label.primary{background:#efe6f7}.post-body .label.info{background:#e5f2f8}.post-body .label.success{background:#e7f4e9}.post-body .label.warning{background:#fcf6e1}.post-body .label.danger{background:#fae8eb}.post-body .link-grid{grid-gap:1.5rem;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.5rem;margin-bottom:20px;padding:1rem;display:grid}.post-body .link-grid .link-grid-container{border:solid #ddd;min-width:0;min-height:5rem;padding:.5rem;transition:background .3s;position:relative;box-shadow:1rem 1rem .5rem #00000080}.post-body .link-grid .link-grid-container:hover{background:var(--card-bg-color);animation:.5s next-shake}.post-body .link-grid .link-grid-container:active{transform:translate(.2rem,.2rem);box-shadow:.5rem .5rem .25rem #00000080}.post-body .link-grid .link-grid-container .link-grid-image{box-sizing:border-box;border:1px solid #ddd;border-radius:50%;width:5rem;height:5rem;padding:3px;position:absolute}.post-body .link-grid .link-grid-container p{margin:0 1rem 0 6rem}.post-body .link-grid .link-grid-container p:first-of-type{font-size:1.2em}.post-body .link-grid .link-grid-container p:last-of-type{opacity:.7;font-size:.8em;line-height:1.3rem}.post-body .link-grid .link-grid-container a{border:0;width:100%;height:100%;position:absolute;top:0;left:0}@keyframes next-shake{0%{transform:translate(1pt,1pt)rotate(0)}10%{transform:translate(-1pt,-2pt)rotate(-1deg)}20%{transform:translate(-3pt)rotate(1deg)}30%{transform:translate(3pt,2pt)rotate(0)}40%{transform:translate(1pt,-1pt)rotate(1deg)}50%{transform:translate(-1pt,2pt)rotate(-1deg)}60%{transform:translate(-3pt,1pt)rotate(0)}70%{transform:translate(3pt,1pt)rotate(-1deg)}80%{transform:translate(-1pt,-1pt)rotate(1deg)}90%{transform:translate(1pt,2pt)rotate(0)}to{transform:translate(1pt,-2pt)rotate(-1deg)}}.post-body .note{border:1px solid #eee;border-left-width:5px;border-radius:3px;margin-bottom:20px;padding:1em;position:relative}.post-body .note summary{cursor:pointer;outline:0}.post-body .note summary p{display:inline}.post-body .note h2,.post-body .note h3,.post-body .note h4,.post-body .note h5,.post-body .note h6{border-bottom:initial;margin:0;padding-top:0}.post-body .note :first-child{margin-top:0}.post-body .note :last-child{margin-bottom:0}.post-body .note.default{border-left-color:#777}.post-body .note.default h2,.post-body .note.default h3,.post-body .note.default h4,.post-body .note.default h5,.post-body .note.default h6{color:#777}.post-body .note.primary{border-left-color:#6f42c1}.post-body .note.primary h2,.post-body .note.primary h3,.post-body .note.primary h4,.post-body .note.primary h5,.post-body .note.primary h6{color:#6f42c1}.post-body .note.info{border-left-color:#428bca}.post-body .note.info h2,.post-body .note.info h3,.post-body .note.info h4,.post-body .note.info h5,.post-body .note.info h6{color:#428bca}.post-body .note.success{border-left-color:#5cb85c}.post-body .note.success h2,.post-body .note.success h3,.post-body .note.success h4,.post-body .note.success h5,.post-body .note.success h6{color:#5cb85c}.post-body .note.warning{border-left-color:#f0ad4e}.post-body .note.warning h2,.post-body .note.warning h3,.post-body .note.warning h4,.post-body .note.warning h5,.post-body .note.warning h6{color:#f0ad4e}.post-body .note.danger{border-left-color:#d9534f}.post-body .note.danger h2,.post-body .note.danger h3,.post-body .note.danger h4,.post-body .note.danger h5,.post-body .note.danger h6{color:#d9534f}.post-body .tabs{margin-bottom:20px}.post-body .tabs,.tabs-comment{padding-top:10px}.post-body .tabs ul.nav-tabs,.tabs-comment ul.nav-tabs{background:var(--content-bg-color);z-index:5;flex-wrap:wrap;justify-content:center;margin:0;padding:0;display:flex;position:sticky;top:0}@media (width<=413px){.post-body .tabs ul.nav-tabs,.tabs-comment ul.nav-tabs{margin-bottom:5px;display:block}}.post-body .tabs ul.nav-tabs li.tab,.tabs-comment ul.nav-tabs li.tab{border:1px solid #0000;border-top-width:3px;border-bottom-color:#ddd;border-radius:0;flex-grow:1;list-style-type:none}@media (width<=413px){.post-body .tabs ul.nav-tabs li.tab,.tabs-comment ul.nav-tabs li.tab{border:1px solid #0000;border-left-width:3px;border-radius:0}}.post-body .tabs ul.nav-tabs li.tab a,.tabs-comment ul.nav-tabs li.tab a{border-bottom:initial;text-align:center;padding:.25em .75em;line-height:1.8;transition:all .2s ease-out;display:block}.post-body .tabs ul.nav-tabs li.tab a i[class^=fa],.tabs-comment ul.nav-tabs li.tab a i[class^=fa]{width:1.28571em}.post-body .tabs ul.nav-tabs li.tab.active,.tabs-comment ul.nav-tabs li.tab.active{border-color:#fc6423 #ddd #0000}@media (width<=413px){.post-body .tabs ul.nav-tabs li.tab.active,.tabs-comment ul.nav-tabs li.tab.active{border-color:#ddd #ddd #ddd #fc6423}}.post-body .tabs ul.nav-tabs li.tab.active a,.tabs-comment ul.nav-tabs li.tab.active a{cursor:default}.post-body .tabs .tab-content,.tabs-comment .tab-content{border:1px solid #ddd;border-top-color:#0000;border-radius:0}@media (width<=413px){.post-body .tabs .tab-content,.tabs-comment .tab-content{border-top-color:#ddd;border-radius:0}}.post-body .tabs .tab-content .tab-pane,.tabs-comment .tab-content .tab-pane{padding:20px 20px 0}.post-body .tabs .tab-content .tab-pane:not(.active),.tabs-comment .tab-content .tab-pane:not(.active){display:none}.pagination .prev,.pagination .next,.pagination .page-number,.pagination .space{margin:-1px 10px 0;padding:0 10px;display:inline-block}@media (width<=767px){.pagination .prev,.pagination .next,.pagination .page-number,.pagination .space{margin:0 5px}}.pagination .page-number.current{color:var(--content-bg-color);background:#ccc;border-color:#ccc}.pagination{text-align:center;border-top:1px solid #eee;margin:120px 0 0}.pagination .prev,.pagination .next,.pagination .page-number{border-top:1px solid #eee;border-bottom:0;transition:border-color .2s ease-in-out}.pagination .prev:hover,.pagination .next:hover,.pagination .page-number:hover{border-top-color:var(--link-hover-color)}@media (width<=767px){.pagination{border-top:0}.pagination .prev,.pagination .next,.pagination .page-number{border-top:0;border-bottom:1px solid #eee}.pagination .prev:hover,.pagination .next:hover,.pagination .page-number:hover{border-bottom-color:var(--link-hover-color)}}.pagination .space{margin:0;padding:0}.comments{margin-top:60px;overflow:hidden}.comment-button-group{flex-wrap:wrap;justify-content:center;margin:1em 0;display:flex}.comment-button-group .comment-button{margin:.1em .2em}.comment-button-group .comment-button.active{background:var(--btn-default-hover-bg);border-color:var(--btn-default-hover-border-color);color:var(--btn-default-hover-color)}.comment-position{display:none}.comment-position.active{display:block}.tabs-comment{margin-top:4em;padding-top:0}.tabs-comment .comments{margin-top:0;padding-top:0}.headband{background:var(--theme-color);height:3px}@media (width<=991px){.headband{display:none}}.site-brand-container{flex-shrink:0;padding:0 10px;display:flex}.use-motion .column,.use-motion .site-brand-container .toggle{opacity:0}.site-meta{text-align:center;flex-grow:1}@media (width<=767px){.site-meta{text-align:center}}.custom-logo-image{margin-top:20px}@media (width<=991px){.custom-logo-image{display:none}}.brand{color:var(--brand-color);border-bottom:0;padding:0;display:inline-block}.brand:hover{color:var(--brand-hover-color)}.site-title{margin:0;font-family:Lato,PingFang SC,Microsoft YaHei,sans-serif;font-size:1.375em;font-weight:400;line-height:1.5}.site-subtitle{color:#ddd;margin:10px 10px 0;font-size:.8125em}.use-motion .site-title,.use-motion .site-subtitle,.use-motion .custom-logo-image{opacity:0;position:relative;top:-10px}.site-nav-toggle,.site-nav-right{display:none}@media (width<=767px){.site-nav-toggle,.site-nav-right{flex-direction:column;justify-content:center;display:flex}}.site-nav-toggle .toggle,.site-nav-right .toggle{color:var(--text-color);width:22px;padding:10px}.site-nav-toggle .toggle .toggle-line,.site-nav-right .toggle .toggle-line{background:var(--text-color);border-radius:1px}@media (width<=767px){.site-nav{--scroll-height:0;visibility:hidden;height:0;transition:height .2s ease-in-out,visibility .2s ease-in-out;overflow:hidden}body:not(.site-nav-on) .site-nav .animated{animation:none}body.site-nav-on .site-nav{height:var(--scroll-height);visibility:unset}}.menu{text-align:center;margin:0;padding:1em 0}.menu-item{margin:0 10px;list-style:none;display:inline-block}@media (width<=767px){.menu-item{margin-top:10px;display:block}.menu-item.menu-item-search{display:none}}.menu-item a{border-bottom:0;font-size:.8125em;transition:border-color .2s ease-in-out;display:block}.menu-item a:hover,.menu-item a.menu-item-active{background:var(--menu-item-bg-color)}.menu-item i[class^=fa]{margin-right:8px}.menu-item .badge{color:var(--content-bg-color);text-shadow:1px 1px #0000001a;background:#ccc;border-radius:10px;margin-left:.35em;padding:2px 5px;font-weight:700;line-height:1}.use-motion .menu-item{visibility:hidden}@media (width<=991px){.sidebar{left:-320px}.sidebar-active .sidebar{left:0}.sidebar{z-index:20;background:#222;width:320px;max-height:100vh;transition:left .2s ease-out,right .2s ease-out;position:fixed;top:0;bottom:0;overflow-y:auto;box-shadow:inset 0 2px 6px #000}.sidebar a{color:#999;border-bottom-color:#555}.sidebar a:hover{color:#eee;border-bottom-color:#eee}.links-of-author:not(:first-child){margin-top:15px}.links-of-author a{vertical-align:middle;border-bottom-color:#555;margin-bottom:10px;margin-right:10px;display:inline-block}.links-of-author a:before{content:" ";background:#ebffe0;border-radius:50%;width:4px;height:4px;margin-right:3px;display:inline-block;transform:translateY(-2px)}.links-of-blogroll-item{padding:0 5px}.popular-posts .popular-posts-item .popular-posts-link:hover{background:0 0}.sidebar-dimmer{opacity:0;visibility:hidden;z-index:10;background:#000;width:100%;height:100%;transition:visibility .4s,opacity .4s;position:fixed;top:0;left:0}.sidebar-active .sidebar-dimmer{opacity:.7;visibility:visible}}.sidebar-inner{color:#999;text-align:center;flex-direction:column;justify-content:center;padding:18px 10px;display:flex}.sidebar-toggle{cursor:pointer;opacity:.6;z-index:30;background:#222;width:16px;height:16px;padding:5px;position:fixed;bottom:61px;left:30px}@media (width<=991px){.sidebar-toggle{left:20px}}.sidebar-toggle:hover{opacity:.8}@media (width<=991px){.sidebar-toggle{opacity:.8}}.sidebar-toggle:hover .toggle-line{background:#fc6423}@media (any-hover:hover){body:not(.sidebar-active) .sidebar-toggle:hover :first-child{width:50%;top:2px;left:50%;transform:rotate(45deg)}body:not(.sidebar-active) .sidebar-toggle:hover :last-child{width:50%;top:-2px;left:50%;transform:rotate(-45deg)}}.sidebar-active .sidebar-toggle :nth-child(2){opacity:0}.sidebar-active .sidebar-toggle :first-child{top:6px;transform:rotate(45deg)}.sidebar-active .sidebar-toggle :last-child{top:-6px;transform:rotate(-45deg)}.sidebar-nav{pointer-events:none;visibility:hidden;height:0;margin:0;padding-left:0;font-size:.875em;transition:height .2s ease-in-out,visibility .2s ease-in-out;overflow:hidden}.sidebar-nav-active .sidebar-nav{pointer-events:unset;height:calc(2em + 1px);visibility:unset}.sidebar-nav li{color:var(--text-color);cursor:pointer;border-bottom:1px solid #0000;transition:border-bottom-color .2s ease-in-out,color .2s ease-in-out;display:inline-block}.sidebar-nav li.sidebar-nav-overview{margin-left:10px}.sidebar-nav li:hover{color:#fc6423}.sidebar-toc-active .sidebar-nav-toc,.sidebar-overview-active .sidebar-nav-overview{color:#fc6423;border-bottom-color:#fc6423;transition-delay:.2s}.sidebar-toc-active .sidebar-nav-toc:hover,.sidebar-overview-active .sidebar-nav-overview:hover{color:#fc6423}.sidebar-panel-container{flex:1;align-items:start;padding-top:0;transition:padding-top .2s ease-in-out;display:grid;overflow:hidden auto}.sidebar-nav-active .sidebar-panel-container{padding-top:20px}.sidebar-panel{opacity:0;pointer-events:none;visibility:hidden;grid-area:1/1;height:0;transition:opacity .2s ease-in-out,transform .2s ease-in-out,visibility .2s ease-in-out;animation:.2s ease-in-out deactivate-sidebar-panel;overflow:hidden;transform:translateY(0)}.sidebar-nav-active .sidebar-panel,.sidebar-overview-active .sidebar-panel.post-toc-wrap{transform:translateY(-20px)}.sidebar-overview-active:not(.sidebar-nav-active) .sidebar-panel.post-toc-wrap{transition-delay:0s,.2s,0s}.sidebar-overview-active .sidebar-panel.site-overview-wrap,.sidebar-toc-active .sidebar-panel.post-toc-wrap{opacity:1;pointer-events:unset;height:auto;visibility:unset;transition-delay:.2s,.2s,0s;animation-name:activate-sidebar-panel;transform:translateY(0)}.sidebar-panel.site-overview-wrap{flex-direction:column;justify-content:flex-start;gap:10px;display:flex}@keyframes deactivate-sidebar-panel{0%{height:var(--inactive-panel-height,0)}to{height:var(--active-panel-height,0)}}@keyframes activate-sidebar-panel{0%{height:var(--inactive-panel-height,auto)}to{height:var(--active-panel-height,auto)}}.post-toc{font-size:.875em}.post-toc ol{text-align:left;margin:0;padding:0 2px 0 10px;list-style:none}.post-toc ol>:last-child{margin-bottom:5px}.post-toc ol>ol{padding-left:0}.post-toc ol a{transition:all .2s ease-in-out}.post-toc .nav-item{text-overflow:ellipsis;white-space:nowrap;line-height:1.8;overflow:hidden}.post-toc .nav .nav-child{--height:0;opacity:0;visibility:hidden;height:0;transition:all .2s ease-in-out;overflow:hidden}.post-toc .nav .active>.nav-child{height:var(--height,auto);opacity:1;visibility:unset}.post-toc .nav .active>a{color:#fc6423;border-bottom-color:#fc6423}.post-toc .nav .active-current>a,.post-toc .nav .active-current>a:hover{color:#fc6423}.site-author-image{border:1px solid #eee;max-width:120px;padding:2px}.site-author-name{color:var(--text-color);margin:0;font-weight:600}.site-description{color:#999;margin-top:0;font-size:.8125em}.site-state{flex-wrap:wrap;justify-content:center;line-height:1.4;display:flex}.site-state-item{padding:0 15px}.site-state-item a{border-bottom:0;display:block}.site-state-item-count{font-size:1em;font-weight:600;display:block}.site-state-item-name{color:#999;font-size:.8125em}.sidebar .sidebar-button:not(:first-child){margin-top:15px}.sidebar .sidebar-button button{color:#fc6423;cursor:pointer;background:0 0;border:1px solid #fc6423;border-radius:4px;padding:0 15px;line-height:2}.sidebar .sidebar-button button:hover{color:#fff;background:#fc6423}.sidebar .sidebar-button button i[class^=fa]{margin-right:5px}.links-of-author a{font-size:.8125em}.links-of-author i[class^=fa]{margin-right:2px}.cc-license .cc-opacity{opacity:.7;border-bottom:0}.cc-license .cc-opacity:hover{opacity:.9}.cc-license img{display:inline-block}.links-of-blogroll{font-size:.8125em}.links-of-blogroll-title{font-size:.875em;font-weight:600}.links-of-blogroll-list{flex-flow:column wrap;justify-content:center;gap:5px;margin:5px 0 0;padding:0;list-style:none;display:flex}.links-of-blogroll-item{max-width:100%}.links-of-blogroll-item a{box-sizing:border-box;text-overflow:ellipsis;white-space:nowrap;max-width:100%;display:inline-block;overflow:hidden}.footer{color:#999;padding:20px 0;font-size:.875em;transition:left .2s ease-in-out,right .2s ease-in-out}.footer.footer-fixed{position:absolute;bottom:0;left:0;right:0}.footer-inner{box-sizing:border-box;text-align:center;flex-direction:column;justify-content:center;width:calc(100% - 20px);margin:0 auto;display:flex}@media (width<=767px){.footer-inner{width:auto}}@media (width>=1200px){.footer-inner{width:1160px}}@media (width>=1600px){.footer-inner{width:73%}}.use-motion .footer{opacity:0}.languages{font-size:1.125em;display:inline-block;position:relative}.languages .lang-select-label span{margin:0 .5em}.languages .lang-select{opacity:0;width:100%;height:100%;position:absolute;top:0;left:0}.with-love{color: ;margin:0 5px;display:inline-block}@keyframes icon-animate{0%,to{transform:scale(1)}10%,30%{transform:scale(.9)}20%,40%,60%,80%{transform:scale(1.1)}50%,70%{transform:scale(1.1)}}.back-to-top{color:#fff;cursor:pointer;opacity:.6;z-index:30;background:#222;align-items:center;height:26px;font-size:12px;transition:bottom .2s ease-in-out;display:flex;position:fixed;bottom:-100px;left:30px}.back-to-top span{margin-right:8px}.back-to-top .fa{text-align:center;width:26px}@media (width<=991px){.back-to-top{left:20px}}.back-to-top:hover{opacity:.8}@media (width<=991px){.back-to-top{opacity:.8}}.back-to-top:hover{color:#fc6423}.back-to-top.back-to-top-on{bottom:30px}.reading-progress-bar{--progress:0;z-index:50;height:3px;width:var(--progress);background:#37c6c0;position:fixed;top:0;left:0}.rtl.post-body p,.rtl.post-body a,.rtl.post-body h1,.rtl.post-body h2,.rtl.post-body h3,.rtl.post-body h4,.rtl.post-body h5,.rtl.post-body h6,.rtl.post-body li,.rtl.post-body ul,.rtl.post-body ol{direction:rtl;font-family:UKIJ Ekran}.rtl.post-title{font-family:UKIJ Ekran}.post-button{text-align:center;margin-top:40px}.use-motion .post-block,.use-motion .pagination,.use-motion .comments,.use-motion .post-header,.use-motion .post-body,.use-motion .collection-header{visibility:hidden}.posts-collapse .post-content{margin-bottom:35px;margin-left:35px;position:relative}@media (width<=767px){.posts-collapse .post-content{margin-left:0;margin-right:0}}.posts-collapse .post-content .collection-title{font-size:1.125em;position:relative}.posts-collapse .post-content .collection-title:before{content:" ";background:#999;border:1px solid #fff;border-radius:50%;width:10px;height:10px;margin-top:-4px;margin-left:-6px;position:absolute;top:50%}.posts-collapse .post-content .collection-year{margin:60px 0;font-size:1.5em;font-weight:700;position:relative}.posts-collapse .post-content .collection-year .collection-year-count{color:var(--content-bg-color);text-shadow:1px 1px #0000001a;background:#ccc;border-radius:10px;margin-left:.35em;padding:2px 5px;font-size:.75em;font-weight:700;line-height:1}.posts-collapse .post-content .collection-year:before{content:" ";background:#bbb;border-radius:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;position:absolute;top:50%}.posts-collapse .post-content .collection-header{margin-left:20px;display:block}.posts-collapse .post-content .collection-header small{color:#bbb;margin-left:5px}.posts-collapse .post-content .post-header{border-bottom:1px dashed #ccc;margin:30px 2px 0;padding-left:15px;transition:border .2s ease-in-out;position:relative}.posts-collapse .post-content .post-header:before{content:" ";background:#bbb;border:1px solid #fff;border-radius:50%;width:6px;height:6px;transition:background .2s ease-in-out;position:absolute;top:.75em;left:-6px}.posts-collapse .post-content .post-header:hover{border-bottom-color:#666}.posts-collapse .post-content .post-header:hover:before{background:#222}.posts-collapse .post-content .post-meta-container{margin-right:10px;font-size:.75em;display:inline}.posts-collapse .post-content .post-title{display:inline}.posts-collapse .post-content .post-title a{color:var(--link-color);border-bottom:0}.posts-collapse .post-content .post-title .fa{margin-left:5px;font-size:.875em}.posts-collapse .post-content:before{content:" ";background:#f5f5f5;width:4px;height:100%;margin-left:-2px;position:absolute;top:1.25em}.post-body{overflow-wrap:break-word;font-family:Lato,PingFang SC,Microsoft YaHei,sans-serif}@media (width>=1200px){.post-body{font-size:1.125em}}@media (width>=992px){.post-body{text-align:justify}}@media (width<=991px){.post-body{text-align:justify}}.post-body h1 .header-anchor,.post-body h2 .header-anchor,.post-body h3 .header-anchor,.post-body h4 .header-anchor,.post-body h5 .header-anchor,.post-body h6 .header-anchor,.post-body h1 .headerlink,.post-body h2 .headerlink,.post-body h3 .headerlink,.post-body h4 .headerlink,.post-body h5 .headerlink,.post-body h6 .headerlink{color:inherit;float:right;opacity:0;border-bottom-style:none;margin-left:10px;font-size:.875em}.post-body h1 .header-anchor:before,.post-body h2 .header-anchor:before,.post-body h3 .header-anchor:before,.post-body h4 .header-anchor:before,.post-body h5 .header-anchor:before,.post-body h6 .header-anchor:before,.post-body h1 .headerlink:before,.post-body h2 .headerlink:before,.post-body h3 .headerlink:before,.post-body h4 .headerlink:before,.post-body h5 .headerlink:before,.post-body h6 .headerlink:before{content:"";font-family:"Font Awesome 7 Free";font-weight:900}.post-body h1:hover .header-anchor,.post-body h2:hover .header-anchor,.post-body h3:hover .header-anchor,.post-body h4:hover .header-anchor,.post-body h5:hover .header-anchor,.post-body h6:hover .header-anchor,.post-body h1:hover .headerlink,.post-body h2:hover .headerlink,.post-body h3:hover .headerlink,.post-body h4:hover .headerlink,.post-body h5:hover .headerlink,.post-body h6:hover .headerlink{opacity:.5}.post-body h1:hover .header-anchor:hover,.post-body h2:hover .header-anchor:hover,.post-body h3:hover .header-anchor:hover,.post-body h4:hover .header-anchor:hover,.post-body h5:hover .header-anchor:hover,.post-body h6:hover .header-anchor:hover,.post-body h1:hover .headerlink:hover,.post-body h2:hover .headerlink:hover,.post-body h3:hover .headerlink:hover,.post-body h4:hover .headerlink:hover,.post-body h5:hover .headerlink:hover,.post-body h6:hover .headerlink:hover{opacity:1}.post-body .exturl .fa{margin-left:4px;font-size:.875em}.post-body figure:not(.highlight){margin:0 auto 20px}.post-body figure:not(.highlight) figcaption{color:#999;text-align:center;margin:-15px auto 15px;font-size:.875em;font-weight:700;line-height:1}.post-body iframe,.post-body img,.post-body video,.post-body embed{margin-bottom:20px}.post-body .video-container{width:100%;height:0;margin-bottom:20px;padding-top:75%;position:relative;overflow:hidden}.post-body .video-container iframe,.post-body .video-container object,.post-body .video-container embed{width:100%;height:100%;margin:0;position:absolute;top:0;left:0}.post-gallery{min-height:200px;display:flex}.post-gallery .post-gallery-image{flex:1}.post-gallery .post-gallery-image:not(:first-child){clip-path:polygon(40px 0,100% 0,100% 100%,0 100%);margin-left:-20px}.post-gallery .post-gallery-image:not(:last-child){margin-right:-20px}.post-gallery .post-gallery-image img{object-fit:cover;opacity:1;width:100%;height:100%}.posts-expand .post-gallery{margin-bottom:60px}.posts-collapse .post-gallery{margin:15px 0}.posts-expand .post-header{text-align:center;margin-bottom:60px;font-size:1.125em}.posts-expand .post-title{margin:initial;overflow-wrap:break-word;font-size:1.5em;font-weight:400}.posts-expand .post-title-link{color:var(--link-color);border-bottom:0;max-width:100%;display:inline-block;position:relative}.posts-expand .post-title-link:before{background:var(--link-color);content:"";width:100%;height:2px;transition:transform .2s ease-in-out;position:absolute;bottom:0;left:0;transform:scaleX(0)}.posts-expand .post-title-link:hover:before{transform:scaleX(1)}.posts-expand .post-title-link .fa{margin-left:5px;font-size:.875em}.post-sticky-flag{margin-right:8px;display:inline-block;transform:rotate(30deg)}.posts-expand .post-meta-container{color:#999;margin-top:3px;font-family:Lato,PingFang SC,Microsoft YaHei,sans-serif;font-size:.75em}.posts-expand .post-meta-container .post-description{margin-top:2px;font-size:.875em}.posts-expand .post-meta-container time{border-bottom:1px dashed #999}.post-meta{flex-wrap:wrap;justify-content:center;display:flex}:not(.post-meta-break)+.post-meta-item:before{content:"|";margin:0 .5em}.post-meta-item-icon{margin-right:3px}@media (width<=991px){.post-meta-item-text{display:none}}.post-meta-break{flex-basis:100%;height:0}.post-nav{border-top:1px solid #eee;justify-content:space-between;gap:30px;margin-top:1em;padding:10px 5px 0;display:flex}.post-nav-item{flex:1}.post-nav-item a{border-bottom:0;font-size:.875em;line-height:1.6;display:block}.post-nav-item a:active{top:2px}.post-nav-item .fa{font-size:.75em}.post-nav-item:first-child .fa{margin-right:5px}.post-nav-item:last-child{text-align:right}.post-nav-item:last-child .fa{margin-left:5px}.post-footer{flex-direction:column;justify-content:center;display:flex}.post-eof{background:#ccc;width:8%;height:1px;margin:80px auto 60px}.post-block:last-of-type .post-eof{display:none}.post-copyright ul{background:var(--card-bg-color);border-left:3px solid #ff2a2a;margin:1em 0 0;padding:.5em 1em;list-style:none;position:relative;overflow:hidden}.post-copyright ul:after{content:"";opacity:.1;font-family:"Font Awesome 7 Brands";font-size:200px;position:absolute;top:-150px;right:-50px}.post-tags{text-align:center;margin-top:40px}.post-tags a{font-size:.8125em;display:inline-block}.post-tags a:not(:last-child){margin-right:10px}.social-like{border-top:1px solid #eee;flex-wrap:wrap;justify-content:center;margin-top:1em;padding-top:1em;font-size:.875em;display:flex}.social-like a{border-bottom:none}.reward-container{text-align:center;margin:1em 0 0;padding:1em 0}.reward-container button{color:#fc6423;cursor:pointer;vertical-align:text-top;background:0 0;border:2px solid #fc6423;border-radius:2px;outline:0;padding:0 15px;line-height:2}.reward-container button:hover{color:#fff;background:#fc6423}.post-reward{padding-top:20px;display:none}.post-reward.active{display:block}.post-reward div{display:inline-block}.post-reward div span{display:block}.post-reward img{width:180px;max-width:100%;margin:.8em 2em 0;display:inline-block}@keyframes next-roll{0%{transform:rotate(30deg)}to{transform:rotate(-30deg)}}.category-all-page .category-all-title{text-align:center}.category-all-page .category-all{margin-top:20px}.category-all-page .category-list{margin:0;padding:0;list-style:none}.category-all-page .category-list-item{margin:5px 10px}.category-all-page .category-list-count{color:var(--content-bg-color);text-shadow:1px 1px #0000001a;background:#ccc;border-radius:10px;margin-left:.35em;padding:2px 5px;font-size:.75em;font-weight:700;line-height:1}.category-all-page .category-list-child{padding-left:10px}.event-list hr{background:#222;margin:20px 0 45px}.event-list hr:after{color:#fff;content:"NOW";background:#222;padding:0 5px;font-weight:700;display:inline-block}.event-list .event{--event-background:#222;--event-foreground:#bbb;--event-title:#fff;background:var(--event-background);padding:15px}.event-list .event .event-summary{color:var(--event-title);border-bottom:0;margin:0;padding:0 0 0 35px;position:relative}.event-list .event .event-summary:before{background:var(--event-title);content:" ";border-radius:50%;width:12px;height:12px;margin-top:-6px;animation:1s ease-in-out infinite alternate dot-flash;position:absolute;top:50%;left:0}.event-list .event:nth-of-type(odd) .event-summary:before{animation-delay:.5s}.event-list .event:not(:last-child){margin-bottom:20px}.event-list .event .event-relative-time{color:var(--event-foreground);padding-left:12px;font-size:12px;font-weight:400;display:inline-block}.event-list .event .event-details{color:var(--event-foreground);padding:6px 0 6px 35px;line-height:18px;display:block}.event-list .event .event-details:before{color:var(--event-foreground);width:14px;margin-right:9px;font-family:"Font Awesome 7 Free";font-weight:900;display:inline-block}.event-list .event .event-details.event-location:before{content:""}.event-list .event .event-details.event-duration:before{content:""}.event-list .event .event-details.event-description:before{content:""}.event-list .event-past{--event-background:#f5f5f5;--event-foreground:#999;--event-title:#222}@keyframes dot-flash{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}ul.breadcrumb{text-align:center;margin:1em 0;padding:0 2em;font-size:.75em;list-style:none}ul.breadcrumb li{display:inline}ul.breadcrumb li:not(:first-child):before{content:"/ ";padding:.5em;font-weight:400}ul.breadcrumb li:last-child{font-weight:700}.tag-cloud{text-align:center}.tag-cloud a{margin:10px;display:inline-block}.tag-cloud-0{color:#aaa;border-bottom-color:#aaa}.tag-cloud-1{color:#9a9a9a;border-bottom-color:#9a9a9a}.tag-cloud-2{color:#8b8b8b;border-bottom-color:#8b8b8b}.tag-cloud-3{color:#7c7c7c;border-bottom-color:#7c7c7c}.tag-cloud-4{color:#6c6c6c;border-bottom-color:#6c6c6c}.tag-cloud-5{color:#5d5d5d;border-bottom-color:#5d5d5d}.tag-cloud-6{color:#4e4e4e;border-bottom-color:#4e4e4e}.tag-cloud-7{color:#3e3e3e;border-bottom-color:#3e3e3e}.tag-cloud-8{color:#2f2f2f;border-bottom-color:#2f2f2f}.tag-cloud-9{color:#202020;border-bottom-color:#202020}.tag-cloud-10{color:#111;border-bottom-color:#111}.search-active{margin-right:var(--dialog-scrollgutter,0);overflow:hidden}.search-pop-overlay{visibility:hidden;z-index:40;background:0 0;width:100%;height:100%;transition:visibility .4s,background .4s;display:flex;position:fixed;top:0;left:0}.search-active .search-pop-overlay{visibility:visible;background:#0000004d}.search-popup{background:var(--card-bg-color);border-radius:5px;width:700px;height:80%;margin:auto;transition:transform .4s;transform:scale(0)}.search-active .search-popup{transform:scale(1)}@media (width<=767px){.search-popup{border-radius:0;width:100%;height:100%}}.search-popup .search-icon,.search-popup .popup-btn-close{color:#999;padding:0 10px;font-size:18px}.search-popup .popup-btn-close{cursor:pointer}.search-popup .popup-btn-close:hover .fa{color:#222}.search-popup .search-header{background:#eee;border-top-left-radius:5px;border-top-right-radius:5px;padding:5px;display:flex}.search-popup input.search-input{background:0 0;border:0;outline:0;width:100%}.search-popup input.search-input::-webkit-search-cancel-button{display:none}.search-popup .search-result-container{flex-direction:column;height:calc(100% - 55px);padding:5px 25px;display:flex;overflow:auto}.search-popup .search-result-container hr{flex-shrink:0;margin:5px 0 10px}.search-popup .search-result-container hr:first-child{display:none}.search-popup .search-result-list{margin:0 5px;padding:0}.search-popup a.search-result-title{font-weight:700}.search-popup p.search-result{border-bottom:1px dashed #ccc;margin:0 0 10px;padding:5px 0}.search-popup .search-input-container{flex-grow:1;padding:2px}.search-popup .search-result-icon{color:#ccc;margin:auto}mark.search-keyword{color:#ff2a2a;background:0 0;border-bottom:1px dashed #ff2a2a;font-weight:700}mjx-container[jax=CHTML][display=true],.has-jax{overflow:auto hidden}mjx-container[display=true]+br{display:none}.use-motion .animated{visibility:inherit;animation-fill-mode:none}.use-motion .sidebar .animated{animation-fill-mode:both}header.header{background:var(--content-bg-color);border-radius:initial;box-shadow:initial}@media (width<=991px){header.header{border-radius:initial}}.main{justify-content:space-between;align-items:stretch;width:calc(100% - 20px);margin:0 auto;display:flex}@media (width<=767px){.main{width:auto}}@media (width>=1200px){.main{width:1160px}}@media (width>=1600px){.main{width:73%}}@media (width<=991px){.main{width:auto;display:block}}.main-inner{border-radius:initial;box-sizing:border-box;width:calc(100% - 252px)}@media (width<=991px){.main-inner{border-radius:initial;width:100%}}.footer-inner{padding-left:252px}@media (width<=991px){.footer-inner{width:auto;padding-left:0;padding-right:0}}.column{width:240px}@media (width<=991px){.column{width:auto}}.site-brand-container{background:var(--theme-color)}@media (width<=991px){.site-nav-on .site-brand-container{box-shadow:0 0 16px #00000080}}.site-meta{padding:20px 0}@media (width>=768px) and (width<=991px){.site-nav-toggle,.site-nav-right{flex-direction:column;justify-content:center;display:flex}}.site-nav-toggle .toggle,.site-nav-right .toggle{color:#fff}.site-nav-toggle .toggle .toggle-line,.site-nav-right .toggle .toggle-line{background:#fff}@media (width>=768px) and (width<=991px){.site-nav{--scroll-height:0;visibility:hidden;height:0;transition:height .2s ease-in-out,visibility .2s ease-in-out;overflow:hidden}body:not(.site-nav-on) .site-nav .animated{animation:none}body.site-nav-on .site-nav{height:var(--scroll-height);visibility:unset}}.menu .menu-item{margin:0;display:block}.menu .menu-item a{align-items:center;padding:5px 20px;transition-property:background-color;display:flex;position:relative}.menu .menu-item a .badge{margin-left:auto}@media (width<=991px){.menu .menu-item.menu-item-search{display:none}}.main-menu .menu-item-active:after{content:" ";background:#bbb;border-radius:50%;width:6px;height:6px;margin-top:-3px;position:absolute;top:50%;right:15px}.sub-menu{margin:0;padding:6px 0}.sub-menu .menu-item{display:inline-block}.sub-menu .menu-item a{padding:initial;background:0 0;margin:5px 10px}.sub-menu .menu-item a:hover{color:#fc6423;background:0 0}.sub-menu .menu-item-active{color:#fc6423;border-bottom-color:#fc6423}.sub-menu .menu-item-active:hover{border-bottom-color:#fc6423}@media (width>=992px){.sidebar{position:sticky;top:12px}.sidebar-toggle{display:none}.sidebar-inner{background:var(--content-bg-color);border-radius:initial;box-shadow:initial;box-sizing:border-box;color:var(--text-color);visibility:hidden;max-height:calc(100vh - 24px);margin-top:12px}.site-state-item{padding:0 10px}.sidebar .sidebar-button{border-top:1px dotted #ccc;border-bottom:1px dotted #ccc}.sidebar .sidebar-button button{color:#fc6423;border:0;width:100%;display:block}.sidebar .sidebar-button button:hover{color:#e34603;background:0 0;border:0}.links-of-author{flex-wrap:wrap;justify-content:center;display:flex}.links-of-author-item{width:50%;margin:5px 0 0}.links-of-author-item a{box-sizing:border-box;text-overflow:ellipsis;white-space:nowrap;border-bottom:0;border-radius:4px;max-width:100%;padding:0 5px;display:inline-block;overflow:hidden}.links-of-author-item a:hover{background:var(--body-bg-color)}.links-of-blogroll-item a{padding:0 5px}}.main-inner{background:var(--content-bg-color);box-shadow:initial;padding:40px}@media (width<=991px){.main-inner{padding:20px}}.sub-menu{border-bottom:1px solid #ddd}.post-block:first-of-type{padding-top:40px}@media (width<=767px){.pagination{margin-bottom:10px}}</style><link integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet><link integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css rel=stylesheet><link integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"wulc.me","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.25.0","exturl":true,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500}},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script defer src=/js/config.js></script><meta content="这是一篇关于 maven 入门的相当好的文章，文章有点长，但是非常值得看。原文链接 Maven 简介 何为 Maven Maven 这个词可以翻译为 “知识的积累”，也可以翻译为 “专家” 或 “内行”。本书将介绍 Maven 这一跨平台的项目管理工具。作为 Apache 组织中的一个颇为成功的开源项目，Maven 主要服务于基于 Java 平 台的项目构建、依赖管理和项目信息管理。无论是小型的开" name=description><meta content=article property=og:type><meta content="Maven 的安装、配置及使用入门" property=og:title><meta content=https://wulc.me/2016/02/18/Maven%E7%9A%84%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/index.html property=og:url><meta content=吴良超的学习笔记 property=og:site_name><meta content="这是一篇关于 maven 入门的相当好的文章，文章有点长，但是非常值得看。原文链接 Maven 简介 何为 Maven Maven 这个词可以翻译为 “知识的积累”，也可以翻译为 “专家” 或 “内行”。本书将介绍 Maven 这一跨平台的项目管理工具。作为 Apache 组织中的一个颇为成功的开源项目，Maven 主要服务于基于 Java 平 台的项目构建、依赖管理和项目信息管理。无论是小型的开" property=og:description><meta content=zh_CN property=og:locale><meta content=https://wulc.me/imgs/e4f32577-29ad-35a7-b384-753eb4df2e37.jpg property=og:image><meta content=https://wulc.me/imgs/9a71aa9f-dc5e-32e1-8d0e-f71de55de5e9.jpg property=og:image><meta content=https://wulc.me/imgs/dc2c1bfc-ce95-3395-a5d7-16bdf5894101.jpg property=og:image><meta content=https://wulc.me/imgs/bb255ca9-2341-37fb-aa9c-de619c2bf80a.jpg property=og:image><meta content=https://wulc.me/imgs/09f3ec72-eb31-3f25-97af-545213fe4793.jpg property=og:image><meta content=2016-02-18T14:06:31.000Z property=article:published_time><meta content=2026-01-07T06:46:50.727Z property=article:modified_time><meta content=良超 property=article:author><meta content=转载 property=article:tag><meta content=Java property=article:tag><meta content=工具使用 property=article:tag><meta content=summary name=twitter:card><meta content=https://wulc.me/imgs/e4f32577-29ad-35a7-b384-753eb4df2e37.jpg name=twitter:image><link href=https://wulc.me/2016/02/18/Maven%E7%9A%84%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://wulc.me/2016/02/18/Maven%E7%9A%84%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/","path":"2016/02/18/Maven的安装、配置及使用入门/","title":"Maven 的安装、配置及使用入门"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Maven 的安装、配置及使用入门 | 吴良超的学习笔记</title><script integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js></script><script integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js></script><script integrity="sha256-JnmRRnJK7DC6RQJbAJb6AXOM9OmWzS6z8eYultk/48Y=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/pangu/7.2.0/pangu.umd.js></script><script defer src=/js/utils.js></script><script defer src=/js/motion.js></script><script defer src=/js/sidebar.js></script><script defer src=/js/next-boot.js></script><script integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js></script><script defer src=/js/third-party/search/local-search.js></script><script defer src=/js/third-party/fancybox.js></script><script class=next-config data-name=enableMath type=application/json>true</script><script class=next-config data-name=mathjax type=application/json>{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script defer src=/js/third-party/math/mathjax.js></script><noscript><link href=/css/noscript.css rel=stylesheet></noscript><link href=/atom.xml rel=alternate title=吴良超的学习笔记 type=application/atom+xml><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>吴良超的学习笔记</p> <i class=logo-line></i> </a></div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#maven%E7%AE%80%E4%BB%8B><span class=nav-number>1.</span> <span class=nav-text>Maven 简介</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%BD%95%E4%B8%BAmaven><span class=nav-number>1.1.</span> <span class=nav-text>何为 Maven</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#maven%E6%98%AF%E4%BC%98%E7%A7%80%E7%9A%84%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7><span class=nav-number>1.1.1.</span> <span class=nav-text>Maven 是优秀的构建工具</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#maven%E4%B8%8D%E4%BB%85%E4%BB%85%E6%98%AF%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7><span class=nav-number>1.1.2.</span> <span class=nav-text>Maven 不仅仅是构建工具</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81maven><span class=nav-number>1.2.</span> <span class=nav-text>为什么需要 Maven</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%84%E8%A3%85pc%E5%92%8C%E5%93%81%E7%89%8Cpc><span class=nav-number>1.2.1.</span> <span class=nav-text>组装 PC 和品牌 PC</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#ide%E4%B8%8D%E6%98%AF%E4%B8%87%E8%83%BD%E7%9A%84><span class=nav-number>1.2.2.</span> <span class=nav-text>IDE 不是万能的</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#make><span class=nav-number>1.2.3.</span> <span class=nav-text>Make</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%B8%8D%E9%87%8D%E5%A4%8D%E5%8F%91%E6%98%8E%E8%BD%AE%E5%AD%90><span class=nav-number>1.2.4.</span> <span class=nav-text>不重复发明轮子</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#maven%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE><span class=nav-number>2.</span> <span class=nav-text>Maven 的安装和配置</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%9C%A8windows%E4%B8%8A%E5%AE%89%E8%A3%85maven><span class=nav-number>2.1.</span> <span class=nav-text>在 Windows 上安装 Maven</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%A3%80%E6%9F%A5jdk%E5%AE%89%E8%A3%85><span class=nav-number>2.1.1.</span> <span class=nav-text>检查 JDK 安装</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%B8%8B%E8%BD%BDmaven><span class=nav-number>2.1.2.</span> <span class=nav-text>下载 Maven</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85><span class=nav-number>2.1.3.</span> <span class=nav-text>本地安装</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%8D%87%E7%BA%A7maven><span class=nav-number>2.1.4.</span> <span class=nav-text>升级 Maven</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%9C%A8%E5%9F%BA%E4%BA%8Eunix%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%B8%8A%E5%AE%89%E8%A3%85maven><span class=nav-number>2.2.</span> <span class=nav-text>在基于 Unix 的系统上安装 Maven</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%B8%8B%E8%BD%BD%E5%92%8C%E5%AE%89%E8%A3%85><span class=nav-number>2.2.1.</span> <span class=nav-text>下载和安装</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#m2><span class=nav-number>2.2.2.</span> <span class=nav-text>~/.m2</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E8%AE%BE%E7%BD%AEhttp%E4%BB%A3%E7%90%86><span class=nav-number>2.3.</span> <span class=nav-text>设置 HTTP 代理</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%BC%96%E5%86%99%E4%B8%BB%E4%BB%A3%E7%A0%81><span class=nav-number>2.4.</span> <span class=nav-text>编写主代码</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81><span class=nav-number>2.5.</span> <span class=nav-text>编写测试代码</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%89%93%E5%8C%85%E5%92%8C%E8%BF%90%E8%A1%8C><span class=nav-number>2.6.</span> <span class=nav-text>打包和运行</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#m2eclipse%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8><span class=nav-number>2.7.</span> <span class=nav-text>m2eclipse 简单使用</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AF%BC%E5%85%A5maven%E9%A1%B9%E7%9B%AE><span class=nav-number>2.7.1.</span> <span class=nav-text>导入 Maven 项目</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%88%9B%E5%BB%BAmaven%E9%A1%B9%E7%9B%AE><span class=nav-number>2.7.2.</span> <span class=nav-text>创建 Maven 项目</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E8%BF%90%E8%A1%8Cmvn%E5%91%BD%E4%BB%A4><span class=nav-number>2.7.3.</span> <span class=nav-text>运行 mvn 命令</span></a></ol></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=良超 class=site-author-image itemprop=image src=/files/profile.jpg><p class=site-author-name itemprop=name>良超<div class=site-description itemprop=description>盈亏同源，拥抱随机性</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>269</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><span class=site-state-item-count>33</span><span class=site-state-item-name>分类</span></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>51</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author animated"><span class=links-of-author-item> <span data-url="aHR0cHM6Ly9naXRodWIuY29tL1d1TEM=" title="GitHub → https://github.com/WuLC" class=exturl><i class="fab fa-github fa-fw"></i>GitHub</span> </span><span class=links-of-author-item> <span data-url="bWFpbHRvOmxpYW5nY2hhb3d1NUBnbWFpbC5jb20=" title="E-Mail → mailto:liangchaowu5@gmail.com" class=exturl><i class="fa fa-envelope fa-fw"></i>E-Mail</span> </span><span class=links-of-author-item> <a rel="noopener me" title="RSS → /atom.xml" href=/atom.xml><i class="fa fa-rss fa-fw"></i>RSS</a> </span></div><div class="cc-license animated" itemprop=license><span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img alt="Creative Commons" src=https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://wulc.me/2016/02/18/Maven%E7%9A%84%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/files/profile.jpg itemprop=image> <meta content=良超 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=吴良超的学习笔记 itemprop=name> <meta content=盈亏同源，拥抱随机性 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="Maven 的安装、配置及使用入门 | 吴良超的学习笔记" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>Maven 的安装、配置及使用入门</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2016-02-18 22:06:31" datetime=2016-02-18T22:06:31+08:00>2016-02-18</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="fa fa-tags"></i> </span> <span class=post-meta-item-text>标签</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/tags/%E8%BD%AC%E8%BD%BD/ itemprop=url rel=index><span itemprop=name>转载</span></a> </span> ， <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/tags/Java/ itemprop=url rel=index><span itemprop=name>Java</span></a> </span> ， <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/ itemprop=url rel=index><span itemprop=name>工具使用</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><p>这是一篇关于 maven 入门的相当好的文章，文章有点长，但是非常值得看。<span class=exturl data-url=aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9kY2JhMTExMi9hcmNoaXZlLzIwMTEvMDUvMDEvMjAzMzgwNS5odG1s>原文链接<i class="fa fa-external-link-alt"></i></span><h2 id=maven简介>Maven 简介</h2><h3 id=何为maven>何为 Maven</h3><p>Maven 这个词可以翻译为 “知识的积累”，也可以翻译为 “专家” 或 “内行”。本书将介绍 Maven 这一跨平台的项目管理工具。作为 Apache 组织中的一个颇为成功的开源项目，<strong>Maven 主要服务于基于 Java 平 台的项目构建、依赖管理和项目信息管理。</strong>无论是小型的开源类库项目，还是大型的企业级应用；无论是传统的瀑布式开发，还是流行的敏捷模式，Maven 都能 大显身手。<br> <span id=more></span><br> #### 何为构建<p>不管你是否意识到，构建（build）是每一位程序员每天都在做的工作。早上来到公司，我们做的第一件事情就是从源码库签出最新的源码，然后进行单元测试，如果发现失败的测试，会找相关的同事一起调试，修复错误代码。接着回到自己的工作上来，编写自己的单元测试及产品代码，我们会感激 IDE 随时报出的编译错误提示。<p>忙到午饭时间，代码编写得差不多了，测试也通过了，开心地享用午餐，然后休息。下午先在昏昏沉沉中开了个例会，会议结束后喝杯咖啡继续工作。刚才在会上经理要求看测试报告，于是找了相关工具集成进 IDE，生成了像 模像样的测试覆盖率报告，接着发了一封电子邮件给经理，松了口气。谁料 QA 小组又发过来了几个 bug，没办法，先本地重现再说，于是熟练地用 IDE 生成了一个 WAR 包，部署到 Web 容器下，启动容器。看到熟悉的界面了，遵循 bug 报告，一步步重现了 bug…… 快下班的时候，bug 修好了，提交代码，通知 QA 小组，在愉快中结束了一天的工作。<p>仔细总结一下，我们会发现，<strong>除了编写源代码，我们每天有相当一部分时间花在了编译、运行单元测试、生成文档、打包和部署等烦琐且不起眼的工作上，这就是构建。</strong>如果我们现在还手工这样做，那成本也太高了，于是有人用软件的方法让这一系列工作完全自动化，使得软件的构建可以像全自动流水线一样，只需要一条简单的命令，所有烦琐的步骤都能够自动完成，很快就能得到最终结果。<h4 id=maven是优秀的构建工具>Maven 是优秀的构建工具</h4><p>前面介绍了 <strong>Maven 的用途之一是服务于构建，它是一个异常强大的构建工具，能够帮我们自动化构建过程，从清理、编译、测试到生成报告，再到打包和部署。</strong>我们不需要也不应该一遍又一遍地输入命令，一次又一次地点击鼠标，我们要做的是使用 Maven 配置好项目，然后输入简单的命令 (如 mvn clean install)，Maven 会帮我们处理那些烦琐的任务。<p>Maven 是跨平台的，这意味着无论是在 Windows 上，还是在 Linux 或者 Mac 上，都可以使用同样的命令。<p>我们一直在不停地寻找避免重复的方法。设计的重复、编码的重复、文档的重复，当然还有构建的重复。Maven 最大化地消除了构建的重复，抽象了构建生命周期，并且为绝大部分的构建任务提供了已实现的插件，我们不再需要定义过程，甚至不需要再去实现这些过程中的一些任务。最简单的例子是测试，我们没必要告诉 Maven 去测试，更不需要告诉 Maven 如何运行测试，只需要遵循 Maven 的约定编写好测试用例，当我们运行构建的时候，这些测试便会自动运行。<p>想象一下，Maven 抽象了一个完整的构建生命周期模型，这个模型吸取了大量其他的构建脚本和构建工具的优点，总结了大量项目的实际需求。如果遵循这个模型，可以避免很多不必要的错误，可以直接使用大量成熟的 Maven 插件来完成我们的任务（很多时候我们可能都不知道自己在使用 Maven 插件）。此外，如果有非常特殊的需求，我们也可以轻松实现自己的插件。<p><strong>Maven 还有一个优点，它能帮助我们标准化构建过程</strong>。在 Maven 之前，十个项目可能有十种构建方式；有了 Maven 之后，所有项目的构建命令都是简单一致的，这极大地避免了不必要的学习成本，而且有利于促进项目团队的标准化。<p>综上所述，Maven 作为一个构建工具，不仅能帮我们自动化构建，还能够抽象构建过程，提供构建任务实现；它跨平台，对外提供了一致的操作接口，这一切足以使它成为优秀的、流行的构建工具。<h4 id=maven不仅仅是构建工具>Maven 不仅仅是构建工具</h4><p>Java 不仅是一门编程语言，还是一个平台，通过 JRuby 和 Jython，我们可以在 Java 平台上编写和运行 Ruby 和 Python 程序。我们也应该认识到，<strong>Maven 不仅是构建工具，还是一个依赖管理工具和项目信息管理工具。 它提供了中央仓库，能帮我们自动下载构件。</strong><p>在这个开源的年代里，几乎任何 Java 应用都会借用一些第三方的开源类库，这些类库都可通过依赖的方式引入到项目中来。随着依赖的增多，版本不一致、版本冲突、依赖臃肿等问题都会接踵而来。手工解决这些问题是十分枯燥的，幸运的是 <strong>Maven 提供了一个优秀的解决方案，它通过一个坐标系统准确地定位每一个构件（artifact），也就是通过一组坐标 Maven 能够找到任何一个 Java 类库（如 jar 文件）。</strong>Maven 给这个类库世界引入了经纬，让它们变得有秩序，于是我们可以借助它来有序地管理依赖，轻松地解决那些繁杂的依赖问题。<p>Maven 还能帮助我们管理原本分散在项目中各个角落的项目信息，包括项目描述、开发者列表、版本控制系统地址、许可证、缺陷管理系统地址等。这些微小的变化看起来很琐碎，并不起眼，但却在不知不觉中为我们节省了大量寻找信息的时间。除了直接的项目信息，通过 Maven 自动生成的站点，以及一些已有的插件，我们还能够轻松获得项目文档、测试报告、静态分析报告、源码版本日志报告等 非常具有价值的项目信息。<p>Maven 还为全世界的 Java 开发者提供了一个免费的中央仓库，在其中几乎可以找到任何的流行开源类库。通过一些 Maven 的衍生工具（如 Nexus），我们还能对其进行快速地搜索。只要定位了坐标，Maven 就能够帮我们自动下载，省去了手工劳动。<p>使用 Maven 还能享受一个额外的好处，即 Maven 对于项目目录结构、测试用 例命名方式等内容都有既定的规则，只要遵循了这些成熟的规则，用户在项目间切换的时候就免去了额外的学习成本，可以说是约定优于配置 （Convention Over Configuration）。<h3 id=为什么需要maven>为什么需要 Maven</h3><p><strong>Maven 不是 Java 领域唯一的构建管理的解决方案。本节将通过一些简单的例子解释 Maven 的必要性，并介绍其他构建解决方案，如 IDE、Make 和 Ant，并将它们与 Maven 进行比较。</strong><h4 id=组装pc和品牌pc>组装 PC 和品牌 PC</h4><p>笔者初中时开始接触计算机，到了高中时更是梦寐以求希望拥有一台自己的计算机。我的第一台计算机是赛扬 733 的，选购是一个漫长的过程，我先阅读了大量的杂志以了解各类配件的优劣，CPU、内存、主板、显卡，甚至声卡，我都仔细地挑选，后来还跑了很多商家，调货、讨价还价，组装好后自己装操作系统和驱动程序…… 虽然这花费了我大量时间，但我很享受这个过程。可是事实证明，装出来的机器稳定性不怎么好。<p>一年前我需要配一台工作站，这时候我已经没有太多时间去研究电脑配件了。我选择了某知名 PC 供应商的在线商店，大概浏览了一下主流的机型，选择了我需要的配置，然后下单、付款。接着 PC 供应商帮我组装电脑、安装操作系统和驱动程序。一周后，物流公司将电脑送到我的家里，我接上显示器、电源、鼠标和键盘就能直接使用了。这为我节省了大量时间，而且这台电脑十分稳定，商家在把电脑发送给我之前已经进行了很好的测试。对了，我还能享受两年的售后服务。<p>使用脚本建立高度自定义的构建系统就像买组装 PC，耗时费力，结果也不一定很好。当然，你可以享受从无到有的乐趣，但恐怕实际项目中无法给你那么多时间。使用 Maven 就像购买品牌 PC，省时省力，并能得到成熟的构建系统，还能得到来自于 Maven 社区的大量支持。唯一与购买品牌 PC 不同的是，Maven 是开源的，你无须为此付费。如果有兴趣，你还能去了解 Maven 是如何工作的，而我们无法知道那些 PC 巨头的商业秘密。<h4 id=ide不是万能的>IDE 不是万能的</h4><p>当然，我们无法否认优秀的 IDE 能大大提高开发效率。当前主流的 IDE 如 Eclipse 和 NetBeans 等都提供了强大的文本编辑、调试甚至重构功能。虽然使用简单的文本编辑器和命令行也能完成绝大部分开发工作，但很少有人愿意那样做。然而，IDE 是有其天生缺陷的：<ul><li><strong>IDE 依赖大量的手工操作</strong>。编译、测试、代码生成等工作都是相互独立的，很难一键完成所有工作。手工劳动往往意味着低效，意味着容易出错。<br><li><strong>很难在项目中统一所有的 IDE 配置，每个人都有自己的喜好</strong>。也正是由于这个原因，一个在机器 A 上可以成功运行的任务，到了机器 B 的 IDE 中可能就会失败。</ul><p>我们应该合理利用 IDE，而不是过多地依赖它。对于构建这样的任务，在 IDE 中一次次地点击鼠标是愚蠢的行为。Maven 是这方面的专家，而且主流 IDE 都集成了 Maven，我们可以在 IDE 中方便地运行 Maven 执行构建。<h4 id=make>Make</h4><p>Make 也许是最早的构建工具，它由 Stuart Feldman 于 1977 年在 Bell 实验室创建。Stuart Feldman 也因此于 2003 年获得了 ACM 国际计算机组织颁发的软件系统奖。目前 Make 有很多衍生实现，包括最流行的 GNU Make 和 BSD Make，还有 Windows 平台的 Microsoft nmake 等。<p><strong>Make 由一个名为 Makefile 的脚本文件驱动，该文件使用 Make 自己定义的语法格式。</strong>其基本组成部分为一系列规则（Rules），而<strong>每一条规则又包括目标（Target）、依赖（Prerequisite）和命令（Command）</strong>。Makefile 的基本结构如下：<figure class="highlight plaintext"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br></pre><td class=code><pre><span class=line>TARGET… : PREREQUISITE…  </span><br><span class=line>COMMAND  </span><br><span class=line>…  </span><br><span class=line>…  </span><br><span class=line>```  </span><br><span class=line>Make通过一系列目标和依赖将整个构建过程串联起来，同时利用本地命令完成每个目标的实际行为。**Make的强大之处在于它可以利用所有系统的本地命令，尤其是UNIX/Linux系统，丰富的功能、强大的命令能够帮助Make快速高效地完成任务。**</span><br><span class=line></span><br><span class=line>但是，Make将自己和操作系统绑定在一起了。也就是说，使用Make，就不能实现（至少很难）跨平台的构建，这对于Java来说是非常不友好的。此外，Makefile的语法也成问题，很多人抱怨Make构建失败的原因往往是一个难以发现的空格或Tab使用错误。</span><br><span class=line></span><br><span class=line>#### Ant</span><br><span class=line></span><br><span class=line>Ant不是指蚂蚁，而是意指“另一个整洁的工具”（Another Neat Tool），它最早用来构建著名的Tomcat，其作者James Duncan Davidson创作它的动机就是因为受不了Makefile的语法格式。我们可以将Ant看成是一个Java版本的Make，也正因为使用了Java，Ant是跨平台的。此外，Ant使用XML定义构建脚本，相对于Makefile来说，这也更加友好。</span><br><span class=line></span><br><span class=line>与Make类似，Ant有一个构建脚本build.xml，如下所示：  </span><br><span class=line>```xml  </span><br><span class=line>&lt;?xml version="1.0"?>  </span><br><span class=line>&lt;project name="Hello" default="compile">  </span><br><span class=line>  &lt;target name="compile" description="compile the Java source code to class files">  </span><br><span class=line>    &lt;mkdir dir="classes"/>  </span><br><span class=line>    &lt;javac srcdir="." destdir="classes"/>  </span><br><span class=line>  &lt;/target>  </span><br><span class=line>  &lt;target name="jar" depends="compile" description="create a Jar file ">  </span><br><span class=line>    &lt;jar destfile="hello.jar">  </span><br><span class=line>      &lt;fileset dir="classes" includes="**/*.class"/>  </span><br><span class=line>      &lt;manifest>  </span><br><span class=line>        &lt;attribute name="Main.Class" value="HelloProgram"/>  </span><br><span class=line>      &lt;/manifest>  </span><br><span class=line>    &lt;/jar>  </span><br><span class=line>  &lt;/target>  </span><br><span class=line>&lt;/project>  </span><br></pre></table></figure><p><strong>build.xml 的基本结构也是目标（target）、依赖（depends），以及实现目标的任务。</strong>比如在上面的脚本中，jar 目标用来创建应用程序 jar 文件，该目标依赖于 compile 目标，后者执行的任务是创建一个名为 classes 的文件夹，编译当前目录的 java 文件至 classes 目录。compile 目标完成后，jar 目标再执行自己的任务。Ant 有大量内置的用 Java 实现的任务，这保证了其跨平台的特质，同时，Ant 也有特殊的任务 exec 来执行本地命令。<p><strong>和 Make 一样，Ant 也都是过程式的，开发者显式地指定每一个目标，以及完成该目标所需要执行的任务。针对每一个项目，开发者都需要重新编写这一过程，这里其实隐含着很大的重复。</strong><p>Maven 是声明式的，项目构建过程和过程各个阶段所需的工作都由插件实现，并且大部分插件都是现成的，开发者只需要声明项目的基本元素，Maven 就执行内置的、完整的构建过程。这在很大程度上消除了重复。<p><strong>Ant 是没有依赖管理的</strong>，所以很长一段时间 Ant 用户都不得不手工管理依赖，这是一个令人头疼的问题。幸运的是，Ant 用户现在可以借助 Ivy 管理依赖。而对于 Maven 用户来说，依赖管理是理所当然的，Maven 不仅内置了依赖管理，更有一个可能拥有全世界最多 Java 开源软件包的中央仓库，Maven 用户无须进行任何配置就可以直接享用。<h4 id=不重复发明轮子>不重复发明轮子</h4><p>【该小节内容整理自网友 Arthas 最早在 Maven 中文 MSN 的群内的讨论，在此表示感谢】<br> 小张是一家小型民营软件公司的程序员，他所在的公司要开发一个新的 Web 项目。经过协商，决定使用 Spring、iBatis 和 Tapstry。jar 包去哪里找呢？公司里估计没有人能把 Spring、iBatis 和 Tapstry 所使用的 jar 包一个不少地找出来。大家的做法是，先到 Spring 的站点上去找一个 spring.with.dependencies，然后去 iBatis 的网站上把所有列出来的 jar 包下载下来，对 Tapstry、Apache commons 等执行同样的操作。项目还没有开始，WEB.INF/lib 下已经有近百个 jar 包了，带版本号的、不带版本号的、有用的、没用的、相冲突的，怎一个 “乱” 字了得！<p>在项目开发过程中，小张不时地发现版本错误和版本冲突问题，他只能硬着头皮逐一解决。项目开发到一半，经理发现最终部署的应用的体积实在太大了，要求小张去掉一些没用的 jar 包，于是小张只能加班加点地一个个删……<p>小张隐隐地觉得这些依赖需要一个框架或者系统来进行管理。<p>小张喜欢学习流行的技术，前几年 Ant 十分流行，他学了，并成为了公司这方面的专家。小张知道，Ant 打包，无非就是创建目录，复制文件，编译源代码，使用一堆任务，如 copydir、fileset、classpath、ref、target，然后再 jar、zip、war，打包就成功了。<p>项目经理发话了：“兄弟们，新项目来了，小张，你来写 Ant 脚本！”<p>“是，保证完成任务！” 接着，小张继续创建一个新的 XML 文件。target clean; target compile; target jar; …… 不知道他是否想过，在他写的这么多的 Ant 脚本中，有多少是重复劳动，有多少代码会在一个又一个项目中重现。既然都差不多，有些甚至完全相同，为什么每次都要重新编写？<p>终于有一天，小张意识到了这个问题，想复用 Ant 脚本，于是在开会时他说：“以后就都用我这个规范的 Ant 脚本吧，新的项目只要遵循我定义的目录结构就可以了。” 经理听后觉得很有道理：“嗯，确实是个进步。”<p>这时新来的研究生发言了：“经理，用 Maven 吧，这个在开源社区很流行，比 Ant 更方便。” 小张一听很惊讶，Maven 真比自己的 “规范化 Ant” 强大？其实他不知道自己只是在重新发明轮子，Maven 已经有一大把现成的插件，全世界都在用，你自己不用写任何代码！<h2 id=maven的安装和配置>Maven 的安装和配置</h2><p>前面介绍了 Maven 是什么，以及为什么要使用 Maven，我们将从本章实际开始实际接触 Maven。本章首先将介绍如何在主流的操作系统下安装 Maven，并详细解释 Maven 的安装文件；其次还会介绍如何在主流的 IDE 中集成 Maven，以及 Maven 安装的最佳实践。<h3 id=在windows上安装maven>在 Windows 上安装 Maven</h3><h4 id=检查jdk安装>检查 JDK 安装</h4><p>在安装 Maven 之前，首先要确认你已经正确安装了 JDK。Maven 可以运行在 JDK 1.4 及以上的版本上。本书的所有样例都基于 JDK 5 及以上版本。打开 Windows 的命令行，运行如下的命令来检查你的 Java 安装：<pre><code>C:\Users\Juven Xu>echo %JAVA_HOME%  
C:\Users\Juven Xu>java -version</code></pre><p>结果如下图所示：<p><img data-src=https://wulc.me/imgs/e4f32577-29ad-35a7-b384-753eb4df2e37.jpg><p>上述命令首先检查环境变量 JAVA_HOME 是否指向了正确的 JDK 目录，接着尝试运行 java 命令。如果 Windows 无法执行 java 命令，或者无法找到 JAVA_HOME 环境变量。你就需要检查 Java 是否安装了，或者环境变量是否设置正确。关于环境变量的设置，请参考 2.1.3 节。<h4 id=下载maven>下载 Maven</h4><p>请访问 Maven 的下载页面：http://maven.apache.org/download.html，其中包含针对不同平台的各种版本的 Maven 下载文件。对于首次接触 Maven 的读者来说，推荐使用 Maven3.0，因此下载 apache-maven-3.0-bin.zip。当然，如果你对 Maven 的源代码感兴趣并想自己构建 Maven，还可以下载 apache-maven-3.0 -src.zip。该下载页面还提供了 md5 校验和（checksum）文件和 asc 数字签名文件，可以用来检验 Maven 分发包的正确性和安全性。<p>在本书编写的时候，Maven 2 的最新版本是 2.2.1，Maven 3 基本完全兼容 Maven 2，而且较之于 Maven 2 它性能更好，还有不少功能的改进，如果你之前一直使用 Maven 2，现在正犹豫是否要升级，那就大可不必担心了，快点尝试下 Maven 3 吧！<h4 id=本地安装>本地安装</h4><p>将安装文件解压到你指定的目录中，如：<pre><code>D:\bin>jar xvf "C:\Users\Juven Xu\Downloads\apache-maven-3.0--bin.zip"</code></pre><p>这里的 Maven 安装目录是 D:-maven-3.0，接着需要设置环境变量，将 Maven 安装配置到操作系统环境中。<p>打开系统属性面板（桌面上右键单击 “我的电脑”→“属性”），点击高级系统设置，再点击环境变量，在系统变量中新建一个变量，变量名为 M2_HOME，变量值为 Maven 的安装目录 D:-maven-3.0。点击确定，接着在系统变量中找到一个名为 Path 的变量，在变量值的末尾加上 % M2_HOME%;，注意多个值之间需要有分号隔开，然后点击确定。至此，环境变量设置完成<p>现在打开一个新的 cmd 窗口（这里强调新的窗口是因为新的环境变量配置需要新的 cmd 窗口才能生效），运行如下命令检查 Maven 的安装情况：<pre><code>C:\Users\Juven Xu>echo %M2_HOME%  
C:\Users\Juven Xu>mvn -v</code></pre><p>第一条命令 echo % M2_HOME% 用来检查环境变量 M2_HOME 是否指向了正确的 Maven 安装目录；而 mvn –version 执行了第一条 Maven 命令，以检查 Windows 是否能够找到正确的 mvn 执行脚本。<h4 id=升级maven>升级 Maven</h4><p>Maven 还比较年轻，更新比较频繁，因此用户往往会需要更新 Maven 安装以获得更多更酷的新特性，以及避免一些旧的 bug。<p><strong>在 Windows 上更新 Maven 非常简便，只需要下载新的 Maven 安装文件，解压至本地目录，然后更新 M2_HOME 环境变量便可。</strong>例如，假设 Maven 推出了新版本 3.1，我们将其下载然后解压至目录 D:-maven-3.1，接着遵照前一节描述的步骤编辑环境变量 M2_HOME，更改其值为 D:-maven-3.1。至此，更新就完成了。同理，如果你需要使用某一个旧版本的 Maven，也只需要编辑 M2_HOME 环境变量指向旧版本的安装目录。<h3 id=在基于unix的系统上安装maven>在基于 Unix 的系统上安装 Maven</h3><p>Maven 是跨平台的，它可以在任何一种主流的操作系统上运行，本节将介绍如何在基于 Unix 的系统（包括 Linux、Mac OS 以及 FreeBSD 等）上安装 Maven。<h4 id=下载和安装>下载和安装</h4><p>首先，与在 Windows 上安装 Maven 一样，需要检查 JAVA_HOME 环境变量以及 Java 命令，细节不再赘述，命令如下：<pre><code>juven@juven-ubuntu:~$ echo $JAVA_HOME  
juven@juven-ubuntu:~$ java –version</code></pre><p>接着到 http://maven.apache.org/download.html 下载 Maven 安装文件，如 apache-maven-3.0-bin.tar.gz，然后解压到本地目录：<pre><code>juven@juven-ubuntu:bin$ tar -xvzf apache-maven-3.0-bin.tar.gz</code></pre><p>现在已经创建好了一个 Maven 安装目录 apache-maven-3.0，虽然直接使用该目录配置环境变量之后就能使用 Maven 了，但这里我更<strong>推荐做法是，在安装目录旁平行地创建一个符号链接，以方便日后的升级</strong>：<figure class="highlight sh"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line>juven@juven-ubuntu:bin$ <span class=built_in>ln</span> -s apache-maven-3.0 apache-maven  </span><br><span class=line>juven@juven-ubuntu:bin$ <span class=built_in>ls</span> -l  </span><br><span class=line>total 4  </span><br><span class=line>lrwxrwxrwx 1 juven juven   18 2009-09-20 15:43 apache-maven -> apache-maven-3.0  </span><br><span class=line>drwxr-xr-x 6 juven juven 4096 2009-09-20 15:39 apache-maven-3.0  </span><br></pre></table></figure><p>接下来，我们需要设置 M2_HOME 环境变量指向符号链接 apache-maven-，并且把 Maven 安装目录下的 bin / 文件夹添加到系统环境变量 PATH 中去：<br><figure class="highlight plaintext"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br></pre><td class=code><pre><span class=line>juven@juven-ubuntu:bin$ export M2_HOME=/home/juven/bin/apache-maven  </span><br><span class=line>juven@juven-ubuntu:bin$ export PATH=$PATH:$M2_HOME/bin  </span><br><span class=line>```  </span><br><span class=line>一般来说，需要将这两行命令加入到系统的登录shell脚本中去，以我现在的Ubuntu 8.10为例，编辑~/.bashrc文件，添加这两行命令。这样，每次启动一个终端，这些配置就能自动执行。</span><br><span class=line></span><br><span class=line>至此，安装完成，我们可以运行以下命令检查Maven安装：</span><br><span class=line></span><br><span class=line>    juven@juven-ubuntu:bin$ echo $M2_HOME  </span><br><span class=line>    juven@juven-ubuntu:bin$ mvn –version</span><br><span class=line></span><br><span class=line>#### 升级Maven</span><br><span class=line></span><br><span class=line>**在基于Unix的系统上，可以利用符号链接这一工具来简化Maven的升级，不必像在Windows上那样，每次升级都必须更新环境变量。**</span><br><span class=line></span><br><span class=line>前一小节中我们提到，解压Maven安装包到本地之后，平行地创建一个符号链接，然后在配置环境变量时引用该符号链接，这样做是为了方便升级。现在，假设我们需要升级到新的Maven 3.1版本，同理，将安装包解压到与前一版本平行的目录下，然后更新符号链接指向3.1版的目录便可：</span><br><span class=line></span><br><span class=line>    juven@juven-ubuntu:bin$ rm apache-maven  </span><br><span class=line>juven@juven-ubuntu:bin$ ln -s apache-maven-3.1/ apache-maven  </span><br><span class=line>    juven@juven-ubuntu:bin$ ls -l  </span><br><span class=line>    total 8  </span><br><span class=line>    lrwxrwxrwx 1 juven juven   17 2009-09-20 16:13 apache-maven -> apache-maven-3.1 /  </span><br><span class=line>    drwxr-xr-x 6 juven juven 4096 2009-09-20 15:39 apache-maven-3.0drwxr-xr-x 2 juven juven 4096 2009-09-20 16:09 apache-maven-3.1</span><br><span class=line></span><br><span class=line>同理，可以很方便地切换到Maven的任意一个版本。现在升级完成了，可以运行mvn -v进行检查。</span><br><span class=line></span><br><span class=line>### 安装目录分析  </span><br><span class=line></span><br><span class=line>本章前面的内容讲述了如何在各种操作系统中安装和升级Maven。现在我们来仔细分析一下Maven的安装文件。</span><br><span class=line></span><br><span class=line>#### M2_HOME</span><br><span class=line></span><br><span class=line>前面我们讲到设置M2_HOME环境变量指向Maven的安装目录，本书之后所有使用M2_HOME的地方都指代了该安装目录，让我们看一下该目录的结构和内容：</span><br><span class=line></span><br><span class=line>```  </span><br><span class=line>bin  </span><br><span class=line>boot  </span><br><span class=line>conf  </span><br><span class=line>lib  </span><br><span class=line>LICENSE.txt  </span><br><span class=line>NOTICE.txt  </span><br><span class=line>README.txt  </span><br></pre></table></figure><p><ul><li><p><strong>Bin</strong>： 该目录包含了 mvn 运行的脚本，这些脚本用来配置 Java 命令，准备好 classpath 和相关的 Java 系统属性，然后执行 Java 命令。其中 mvn 是基于 UNIX 平台的 shell 脚本，mvn.bat 是基于 Windows 平台的 bat 脚本。在命令行输入任何一条 mvn 命令时，实际上就是在调用这些脚本。该目录还包含了 mvnDebug 和 mvnDebug.bat 两个文件，同样，前者是 UNIX 平台的 shell 脚本，后者是 windows 的 bat 脚本。那么 mvn 和 mvnDebug 有什么区别和关系呢？打开文件我们就可以看到，两者基本是一样的，只是 mvnDebug 多了一条 MAVEN_DEBUG_OPTS 配置，作用就是在运行 Maven 时开启 debug，以便调试 Maven 本身。此外，该目录还包含 m2.conf 文件，这是 classworlds 的配置文件，稍微会介绍 classworlds。<li><p><strong>Boot</strong>： 该目录只包含一个文件，以 maven 3.0 为例，该文件为 plexus-classworlds-2.2.3.jar。plexus-classworlds 是一个类加载器框架，相对于默认的 java 类加载器，它提供了更丰富的语法以方便配置，Maven 使用该框架加载自己的类库。更多关于 classworlds 的信息请参考 http://classworlds.codehaus.org/。对于一般的 Maven 用户来说，不必关心该文件。<li><p><strong>Conf</strong>： 该目录包含了一个非常重要的文件 settings.xml。直接修改该文件，就能在机器上全局地定制 Maven 的行为。一般情况下，我们更偏向于复制该文件至<sub> /.m2 / 目录下（这里</sub>表示用户目录），然后修改该文件，在用户范围定制 Maven 的行为。本书的后面将会多次提到该 settings.xml，并逐步分析其中的各个元素。<li><p><strong>Lib</strong>： 该目录包含了所有 Maven 运行时需要的 Java 类库，Maven 本身是分模块开发的，因此用户能看到诸如 mavn-core-3.0.jar、maven-model-3.0.jar 之类的文件，此外这里还包含一些 Maven 用到的第三方依赖如 common-cli-1.2.jar、google-collection-1.0.jar 等等。（对于 Maven 2 来说，该目录只包含一个如 maven-2.2.1-uber.jar 的文件原本各为独立 JAR 文件的 Maven 模块和第三方类库都被拆解后重新合并到了这个 JAR 文件中）。可以说，这个 lib 目录就是真正的 Maven。关于该文件，还有一点值得一提的是，用户可以在这个目录中找到 Maven 内置的超级 POM，这一点在 8.5 小节详细解释。其他： LICENSE.txt 记录了 Maven 使用的软件许可证 Apache License Version 2.0； NOTICE.txt 记录了 Maven 包含的第三方软件；而 README.txt 则包含了 Maven 的简要介绍，包括安装需求及如何安装的简要指令等等。</ul><h4 id=m2>~/.m2</h4><p>在讲述该小节之前，我们先运行一条简单的命令：mvn help:system。该命令会打印出所有的 Java 系统属性和环境变量，这些信息对我们日常的编程工作很有帮助。这里暂不解释 help:system 涉及的语法，运行这条命令的目的是为了让 Maven 执行一个真正的任务。我们可以从命令行输出看到 Maven 会下载 maven-help-plugin，包括 pom 文件和 jar 文件。这些文件都被下载到了 Maven 本地仓库中。<p>现在打开用户目录，比如当前的用户目录是 C:Xu，你可以在 Vista 和 Windows7 中找到类似的用户目录。如果是更早版本的 Windows，该目录应该类似于 C:and SettingsXu。在基于 Unix 的系统上，直接输入 cd 回车，就可以转到用户目录。为了方便，本书统一使用符号～ 指代用户目录。<p>在用户目录下，我们可以发现.m2 文件夹。默认情况下，该文件夹下放置了 Maven 本地仓库.m2/repository。所有的 Maven 构件（artifact）都被存储到该仓库中，以方便重用。我们可以到～/.m2/repository/org/apache/maven/plugins/maven-help-plugins/ 目录下找到刚才下载的 maven-help-plugin 的 pom 文件和 jar 文件。Maven 根据一套规则来确定任何一个构件在仓库中的位置，这一点本书第 6 章将会详细阐述。由于 Maven 仓库是通过简单文件系统透明地展示给 Maven 用户的，有些时候可以绕过 Maven 直接查看或修改仓库文件，在遇到疑难问题时，这往往十分有用。<p>默认情况下，<sub>/.m2 目录下除了 repository 仓库之外就没有其他目录和文件了，不过大多数 Maven 用户需要复制 M2_HOME/conf/settings.xml 文件到</sub> /.m2/settings.xml。这是一条最佳实践，我们将在本章最后一小节详细解释。<h3 id=设置http代理>设置 HTTP 代理</h3><p>有时候你所在的公司由于安全因素考虑，要求你使用通过安全认证的代理访问因特网。这种情况下，就需要为 Maven 配置 HTTP 代理，才能让它正常访问外部仓库，以下载所需要的资源。<p>首先确认自己无法直接访问公共的 Maven 中央仓库，直接运行命令 ping repo1.maven.org 可以检查网络。如果真的需要代理，先检查一下代理服务器是否畅通，比如现在有一个 IP 地址为 218.14.227.197，端口为 3128 的代理服务，我们可以运行 telnet 218.14.227.197 3128 来检测该地址的该端口是否畅通。如果得到出错信息，需要先获取正确的代理服务信息；如果 telnet 连接正确，则输入 ctrl+]，然后 q，回车，退出即可。<p>检查完毕之后，编辑～/.m2/settings.xml 文件（如果没有该文件，则复制 $M2_HOME/conf/settings.xml）。添加代理配置如下：<figure class="highlight plaintext"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br></pre><td class=code><pre><span class=line>&lt;settings>  </span><br><span class=line>…  </span><br><span class=line>&lt;proxies>  </span><br><span class=line>    &lt;proxy>  </span><br><span class=line>      &lt;id>my-proxy&lt;/id>  </span><br><span class=line>      &lt;active>true&lt;/active>  </span><br><span class=line>      &lt;protocol>http&lt;/protocol>  </span><br><span class=line>      &lt;host>218.14.227.197&lt;/host>  </span><br><span class=line>      &lt;port>3128&lt;/port>  </span><br><span class=line>      &lt;!--  </span><br><span class=line>      &lt;username>***&lt;/username>  </span><br><span class=line>      &lt;password>***&lt;/password>  </span><br><span class=line>      &lt;nonProxyHosts>repository.mycom.com|*.google.com&lt;/nonProxyHosts>  </span><br><span class=line>      -->  </span><br><span class=line>    &lt;/proxy>  </span><br><span class=line>  &lt;/proxies>  </span><br><span class=line>  …  </span><br><span class=line>&lt;/settings>  </span><br><span class=line>```  </span><br><span class=line>这段配置十分简单，proxies下可以有多个proxy元素，如果你声明了多个proxy元素，则默认情况下第一个被激活的proxy会生效。这里声明了一个id为my-proxy的代理，active的值为true表示激活该代理，protocol表示使用的代理协议，这里是http。当然，最重要的是指定正确的主机名（host元素）和端口（port元素）。上述XML配置中我注释掉了username、password、nonProxyHost几个元素，当你的代理服务需要认证时，就需要配置username和password。nonProxyHost元素用来指定哪些主机名不需要代理，可以使用 | 符号来分隔多个主机名。此外，该配置也支持通配符，如*.google.com表示所有以google.com结尾的域名访问都不要通过代理。</span><br><span class=line></span><br><span class=line>### 安装m2eclipse  </span><br><span class=line></span><br><span class=line>Eclipse是一款非常优秀的IDE。除了基本的语法标亮、代码补齐、XML编辑等基本功能外，最新版的Eclipse还能很好地支持重构，并且集成了JUnit、CVS、Mylyn等各种流行工具。可惜Eclipse默认没有集成对Maven的支持。幸运的是，由Maven之父Jason Van Zyl创立的Sonatype公司建立了m2eclipse项目，这是Eclipse下的一款十分强大的Maven插件，可以访问http://m2eclipse.sonatype.org/ 了解更多该项目的信息。</span><br><span class=line></span><br><span class=line>本小节将先介绍如何安装m2eclipse插件，本书后续的章节会逐步介绍m2eclipse插件的使用。</span><br><span class=line></span><br><span class=line>现在我以Eclipse 3.6为例逐步讲解m2eclipse的安装。启动Eclipse之后，在菜单栏中选择Help，然后选择Install New Software…，接着你会看到一个Install对话框，点击Work with:字段边上的Add按钮，你会得到一个新的Add Repository对话框，在Name字段中输入m2e，Location字段中输入http://m2eclipse.sonatype.org/sites/m2e，然后点击OK。Eclipse会下载m2eclipse安装站点上的资源信息。等待资源载入完成之后，我们再将其全部展开，就能看到下图所示的界面：</span><br><span class=line></span><br><span class=line>![][3]</span><br><span class=line></span><br><span class=line>如图显示了m2eclipse的核心模块Maven Integration for Eclipse (Required)，选择后点击Next >，Eclipse会自动计算模块间依赖，然后给出一个将被安装的模块列表，确认无误后，继续点击Next >，这时我们会看到许可证信息，m2eclipse使用的开源许可证是Eclipse Public License v1.0，选择I accept the terms of the license agreements，然后点击Finish，接着就耐心等待Eclipse下载安装这些模块，如下图所示：</span><br><span class=line></span><br><span class=line>![][4]</span><br><span class=line></span><br><span class=line>除了核心组件之外，m2eclipse还提供了一组额外组件，主要是为了方便与其它工具如Subversion进行集成，这些组件的安装地址为http://m2eclipse.sonatype.org/sites/m2e-extras。使用前面类似的安装方法，我们可以看到如下图的组件列表：</span><br><span class=line></span><br><span class=line>![][5]</span><br><span class=line></span><br><span class=line>下面简单解释一下这些组件的用途：</span><br><span class=line></span><br><span class=line>**1.重要的**  </span><br><span class=line> Maven SCM handler for Subclipse(Optional）：Subversion是非常流行的版本管理工具，该模块能够帮助我们直接从Subversion服务器签出Maven项目，不过前提是需要首先安装Subclipse（http://subclipse.tigris.org/）。  </span><br><span class=line> Maven SCM Integration (Optional）：Eclipse环境中Maven与SCM集成核心的模块，它利用各种SCM工具如SVN实现Maven项目的签出和具体化等操作。</span><br><span class=line></span><br><span class=line>**2. 不重要的**  </span><br><span class=line> Maven issue tracking configurator for Mylyn 3.x (Optional）：该模块能够帮助我们使用POM中的缺陷跟踪系统信息连接Mylyn至服务器。  </span><br><span class=line> Maven SCM handler for Team/CVS (Optional）：该模块帮助我们从CVS服务器签出Maven项目，如果你还在使用CVS，就需要安装它。  </span><br><span class=line> Maven Integration for WTP (Optional）：使用该模块可以让Eclipse自动读取POM信息并配置WTP项目。、  </span><br><span class=line> M2eclipse Extensions Development Support (Optional)：用来支持扩展m2eclipse，一般用户不会用到。  </span><br><span class=line> Project configurators for commonly used maven plugins (temporary)：一个临时的组件，用来支持一些Maven插件与Eclipse的集成，建议安装。  </span><br><span class=line>读者可以根据自己的需要安装相应组件，具体步骤不再赘述。</span><br><span class=line></span><br><span class=line>待安装完毕后，重启Eclipse，现在让我们验证一下m2eclipse是否正确安装了。首先，点击菜单栏中的Help，然后选择About Eclipse，在弹出的对话框中，点击Installation Details按钮，会得到一个对话框，在Installed Software标签栏中，检查刚才我们选择的模块是否在这个列表中  </span><br><span class=line>![][6]  </span><br><span class=line>如果一切没问题，我们再检查一下Eclipse现在是否已经支持创建Maven项目，依次点击菜单栏中的File→New→Other，在弹出的对话框中，找到Maven一项，再将其展开，你应该能够看到如下所示的对话框：</span><br><span class=line></span><br><span class=line>![][7]</span><br><span class=line></span><br><span class=line>如果一切正常，说明m2eclipse已经正确安装了。</span><br><span class=line></span><br><span class=line>最后，关于m2eclipse的安装，需要提醒的一点是，你可能会在使用m2eclipse时遇到类似这样的错误：</span><br><span class=line></span><br><span class=line>09-10-6 上午01时14分49秒: Eclipse is running in a JRE, but a JDK is required  </span><br><span class=line>Some Maven plugins may not work when importing projects or updating source folders.</span><br><span class=line></span><br><span class=line>这是因为**Eclipse默认是运行在JRE上的，而m2eclipse的一些功能要求使用JDK**，解决方法是配置Eclipse安装目录的eclipse.ini文件，添加vm配置指向JDK，如：</span><br><span class=line></span><br><span class=line>    --launcher.XXMaxPermSize  </span><br><span class=line>    256m  </span><br><span class=line>    -vm  </span><br><span class=line>    D:\java\jdk1.6.0_07\bin\javaw.exe  </span><br><span class=line>    -vmargs  </span><br><span class=line>    -Dosgi.requiredJavaVersion=1.5  </span><br><span class=line>    -Xms128m  </span><br><span class=line>    -Xmx256m</span><br><span class=line></span><br><span class=line></span><br><span class=line>### Maven安装最佳实践  </span><br><span class=line></span><br><span class=line>本节介绍一些在安装Maven过程中不是必须的，但十分有用的实践。</span><br><span class=line></span><br><span class=line>#### 设置MAVEN_OPTS环境变量</span><br><span class=line></span><br><span class=line>本章前面介绍Maven安装目录时我们了解到，**运行mvn命令实际上是执行了Java命令，既然是运行Java，那么运行Java命令可用的参数当然也应该在运行mvn命令时可用**。这个时候，MAVEN_OPTS环境变量就能派上用场。</span><br><span class=line></span><br><span class=line>我们通常需要设置MAVEN_OPTS的值为：-Xms128m -Xmx512m，因为**Java默认的最大可用内存往往不能够满足Maven运行的需要，比如在项目较大时，使用Maven生成项目站点需要占用大量的内存，如果没有该配置，我们很容易得到java.lang.OutOfMemeoryError。**因此，一开始就配置该变量是推荐的做法。</span><br><span class=line></span><br><span class=line>关于如何设置环境变量，请参考前面设置M2_HOME环境变量的做法，尽量不要直接修改mvn.bat或者mvn这两个Maven执行脚本文件。因为如果修改了脚本文件，升级Maven时你就不得不再次修改，一来麻烦，二来容易忘记。同理，我们应该尽可能地不去修改任何Maven安装目录下的文件。</span><br><span class=line></span><br><span class=line>#### 配置用户范围settings.xml</span><br><span class=line></span><br><span class=line>**Maven用户可以选择配置$M2_HOME/conf/settings.xml或者~/.m2/settings.xml。前者是全局范围的，整台机器上的所有用户都会直接受到该配置的影响，而后者是用户范围的，只有当前用户才会受到该配置的影响。**</span><br><span class=line></span><br><span class=line>我们推荐使用用户范围的settings.xml，主要原因是为了避免无意识地影响到系统中的其他用户。当然，如果你有切实的需求，需要统一系统中所有用户的settings.xml配置，当然应该使用全局范围的settings.xml。</span><br><span class=line></span><br><span class=line>除了影响范围这一因素，配置用户范围settings.xml文件还便于Maven升级。直接修改conf目录下的settings.xml会导致Maven升级不便，每次升级到新版本的Maven，都需要复制settings.xml文件，如果使用~/.m2目录下的settings.xml，就不会影响到Maven安装文件，升级时就不需要触动settings.xml文件。</span><br><span class=line></span><br><span class=line>#### 不要使用IDE内嵌的Maven</span><br><span class=line></span><br><span class=line>无论是Eclipse还是NetBeans，当我们集成Maven时，都会安装上一个内嵌的Maven，这个内嵌的Maven通常会比较新，但不一定很稳定，而且往往也会和我们在命令行使用的Maven不是同一个版本。这里有会出现两个潜在的问题：首先，较新版本的Maven存在很多不稳定因素，容易造成一些难以理解的问题；其次，除了IDE，我们也经常还会使用命令行的Maven，如果版本不一致，容易造成构建行为的不一致，这是我们所不希望看到的。因此，我们应该在IDE中配置Maven插件时使用与命令行一致的Maven。</span><br><span class=line></span><br><span class=line>在m2eclipse环境中，点击菜单栏中的Windows，然后选择Preferences，在弹出的对话框中，展开左边的Maven项，选择Installation子项，在右边的面板中，我们能够看到有一个默认的Embedded Maven安装被选中了，点击Add…然后选择我们的Maven安装目录M2_HOME，添加完毕之后选择这一个外部的Maven，如下图所示：  </span><br><span class=line>![][8]  </span><br><span class=line>### 小结  </span><br><span class=line></span><br><span class=line>本章详细介绍了在各种操作系统平台上安装Maven，并对Maven安装目录进行了深入的分析，在命令行的基础上，本章又进一步介绍了Maven与主流IDE Eclipse及NetBeans的集成，本章最后还介绍了一些与Maven安装相关的最佳实践。本书下一章会创建一个Hello World项目，带领读者配置和构建Maven项目。</span><br><span class=line></span><br><span class=line>## Maven使用入门  </span><br><span class=line></span><br><span class=line>到目前为止，我们已经大概了解并安装好了Maven，现在，我们开始 创建一个最简单的Hello World项目。如果你是初次接触Maven，我建议你按照本章的内容一步步地编写代码并执行，可能你会碰到一些概念暂时难以理解，不用着急，记下这些疑 难点，相信本书的后续章节会帮你逐一解答。 </span><br><span class=line></span><br><span class=line>**就像Make的Makefile，Ant的build.xml一样，Maven项目的核心是pom.xml。POM（Project Object Model，项目对象模型）定义了项目的基本信息，用于描述项目如何构建，声明项目依赖，等等。**</span><br><span class=line></span><br><span class=line>### 编写pom.xml文件  </span><br><span class=line>现在我们先为Hello World项目编写一个最简单的pom.xml。</span><br><span class=line></span><br><span class=line>首先创建一个名为hello-world的文件夹（本书中各章的代码都会对应一个以ch开头的项目），打开该文件夹，新建一个名为pom.xml的文件，输入其内容如代码清单3-1：</span><br><span class=line></span><br><span class=line>代码清单3-1：Hello World的POM</span><br><span class=line></span><br><span class=line>```xml  </span><br><span class=line>&lt;?xml version="1.0" encoding="UTF-8"?>  </span><br><span class=line>&lt;project xmlns="http://maven.apache.org/POM/4.0.0"  </span><br><span class=line>         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  </span><br><span class=line>         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0  </span><br><span class=line>http://maven.apache.org/maven-v4_0_0.xsd">  </span><br><span class=line>  &lt;modelVersion>4.0.0&lt;/modelVersion>  </span><br><span class=line>  &lt;groupId>com.juvenxu.mvnbook&lt;/groupId>  </span><br><span class=line>  &lt;artifactId>hello-world&lt;/artifactId>  </span><br><span class=line>  &lt;version>1.0-SNAPSHOT&lt;/version>  </span><br><span class=line>  &lt;name>Maven Hello World Project&lt;/name>  </span><br><span class=line>&lt;/project>  </span><br></pre></table></figure><p>代码的第一行是 XML 头，指定了该 xml 文档的版本和编码方式。紧接着是 project 元素，<strong>project 是所有 pom.xml 的根元素</strong>，它还声明了一些 POM 相关的命名空间及 xsd 元素，虽然这些属性不是必须的，但使用这些属性能够让第三方工具（如 IDE 中的 XML 编辑器）帮助我们快速编辑 POM。<p>根元素下的第一个子元素 modelVersion 指定了当前 POM 模型的版本，对于 Maven2 及 Maven 3 来说，它只能是 4.0.0。<p>这段代码中<strong>最重要的是 groupId，artifactId 和 version 三行。这三个元素定义了一个项目基本的坐标，在 Maven 的世界，任何的 jar、pom 或者 war 都是以基于这些基本的坐标进行区分的。</strong><ul><li><p><strong>groupId 定义了项目属于哪个组，这个组往往和项目所在的组织或公司存在关联</strong>，譬如你在 googlecode 上建立了一个名为 myapp 的项目，那么 groupId 就应该是 com.googlecode.myapp，如果你的公司是 mycom，有一个项目为 myapp，那么 groupId 就应该是 com.mycom.myapp。本书中所有的代码都基于 groupId com.juvenxu.mvnbook。<li><p><strong>artifactId 定义了当前 Maven 项目在组中唯一的 ID</strong>，我们为这个 Hello World 项目定义 artifactId 为 hello-world，本书其他章节代码会被分配其他的 artifactId。而在前面的 groupId 为 com.googlecode.myapp 的例子中，你可能会为不同的子项目（模块）分配 artifactId，如：myapp-util、myapp-domain、myapp-web 等等。<li><p><strong>version 指定了 Hello World 项目当前的版本 ——1.0-SNAPSHOT</strong>。<em>SNAPSHOT 意为快照，说明该项目还处于开发中，是不稳定的版本</em>。随着项目的发展，version 会不断更新，如升级为 1.0、1.1-SNAPSHOT、1.1、2.0 等等。本书的 6.5 小节会详细介绍 SNAPSHOT，第 13 章介绍如何使用 Maven 管理项目版本的升级发布。</ul><p>最后一个 name 元素声明了一个对于用户更为友好的项目名称，虽然这不是必须的，但我还是推荐为每个 POM 声明 name，以方便信息交流。<p><strong>没有任何实际的 Java 代码，我们就能够定义一个 Maven 项目的 POM，这体现了 Maven 的一大优点</strong>，它能让项目对象模型最大程度地与实际代码相独立，我们可以称之为解耦，或者正交性，这在很大程度上避免了 Java 代码和 POM 代码的相互影响。比如当项目需要升级版本时，只需要修改 POM，而不需要更改 Java 代码；而在 POM 稳定之后，日常的 Java 代码开发工作基本不涉及 POM 的修改。<h3 id=编写主代码>编写主代码</h3><p><strong>项目主代码和测试代码不同，项目的主代码会被打包到最终的构件中（比如 jar），而测试代码只在运行测试时用到，不会被打包。</strong>默认情况下，Maven 假设项目主代码位于 src/main/java 目录，我们遵循 Maven 的约定，创建该目录，然后在该目录下创建文件 com/juvenxu/mvnbook/helloworld/HelloWorld.java，其内容如代码清单 3-2：<p>代码清单 3-2：Hello World 的主代码<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.juvenxu.mvnbook.helloworld;  </span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">HelloWorld</span>  </span><br><span class=line>{  </span><br><span class=line>   <span class=keyword>public</span> String <span class="title function_">sayHello</span><span class=params>()</span>  </span><br><span class=line>   {  </span><br><span class=line>     <span class=keyword>return</span> <span class=string>"Hello Maven"</span>;  </span><br><span class=line>   }  </span><br><span class=line></span><br><span class=line>  <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span>  </span><br><span class=line>  {  </span><br><span class=line>  System.out.print( <span class=keyword>new</span> <span class="title class_">HelloWorld</span>().sayHello());  </span><br><span class=line>  }  </span><br><span class=line>}  </span><br></pre></table></figure><p>这是一个简单的 Java 类，它有一个 sayHello () 方法，返回一个 String。同时这个类还带有一个 main 方法，创建一个 HelloWorld 实例，调用 sayHello () 方法，并将结果输出到控制台。<p>关于该 Java 代码有两点需要注意。首先，在 95% 以上的情况下，我们<strong>应该把项目主代码放到 src/main/java/ 目录下（遵循 Maven 的约定），而无须额外的配置，Maven 会自动搜寻该目录找到项目主代码。</strong>其次，该 Java 类的包名是 com.juvenxu.mvnbook.helloworld，这与我们之前在 POM 中定义的 groupId 和 artifactId 相吻合。<strong>一般来说，项目中 Java 类的包都应该基于项目的 groupId 和 artifactId，这样更加清晰，更加符合逻辑，也方便搜索构件或者 Java 类。</strong><p>代码编写完毕后，我们使用 Maven 进行编译，在项目根目录下运行命令 <code>mvn clean compile</code>，我们会得到如下输出：<pre><code>[INFO] Scanning for projects...  
[INFO] ------------------------------------------------------------------------  
[INFO] Building Maven Hello World Project  
[INFO]    task-segment: [clean, compile]  
[INFO] ------------------------------------------------------------------------  
[INFO] [clean:clean {execution: default-clean}]  
[INFO] Deleting directory D:\code\hello-world\target  
[INFO] [resources:resources {execution: default-resources}]  
[INFO] skip non existing resourceDirectory D: \code\hello-world\src\main\resources  
[INFO] [compiler:compile {execution: default-compile}]  
[INFO] Compiling 1 source file to D: \code\hello-world\target\classes  
[INFO] ------------------------------------------------------------------------  
[INFO] BUILD SUCCESSFUL  
[INFO] ------------------------------------------------------------------------  
[INFO] Total time: 1 second  
[INFO] Finished at: Fri Oct 09 02:08:09 CST 2009  
[INFO] Final Memory: 9M/16M  
[INFO] ------------------------------------------------------------------------  </code></pre><p>clean 告诉 Maven 清理输出目录 target，compile 告诉 Maven 编译项目主代码，从输出中我们看到 Maven 首先执行了 clean:clean 任务，删除 target / 目录，<strong>默认情况下 Maven 构建的所有输出都在 target / 目录中</strong>；接着执行 resources:resources 任务（未定义项目资源，暂且略过）；最后执行 compiler:compile 任务，将项目主代码编译至 target/classes 目录 (编译好的类为 com/juvenxu/mvnbook/helloworld/HelloWorld.Class）。<p>上文提到的 clean:clean、resources:resources，以及 compiler:compile 对应了一些 Maven 插件及插件目标，比如 clean:clean 是 clean 插件的 clean 目标，compiler:compile 是 compiler 插件的 compile 目标，后文会详细讲述 Maven 插件及其编写方法。<p>至此，Maven 在没有任何额外的配置的情况下就执行了项目的清理和编译任务，接下来，我们编写一些单元测试代码并让 Maven 执行自动化测试。<h3 id=编写测试代码>编写测试代码</h3><p>为了使项目结构保持清晰，主代码与测试代码应该分别位于独立的目录中。3.2 节讲过 Maven 项目中默认的主代码目录是 src/main/java，对应地，Maven 项目中默认的测试代码目录是 src/test/java。因此，在编写测试用例之前，我们先创建该目录。<p>在 Java 世界中，由 Kent Beck 和 Erich Gamma 建立的 <strong>JUnit 是事实上的单元测试标准。要使用 JUnit，我们首先需要为 Hello World 项目添加一个 JUnit 依赖</strong>，修改项目的 POM 如代码清单 3-3：<p>代码清单 3-3：为 Hello World 的 POM 添加依赖<figure class="highlight plaintext"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br></pre><td class=code><pre><span class=line>&lt;?xml version="1.0" encoding="UTF-8"?>  </span><br><span class=line>&lt;project xmlns="http://maven.apache.org/POM/4.0.0"  </span><br><span class=line>         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  </span><br><span class=line>         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0  </span><br><span class=line>http://maven.apache.org/maven-v4_0_0.xsd">  </span><br><span class=line>  &lt;modelVersion>4.0.0&lt;/modelVersion>  </span><br><span class=line>  &lt;groupId>com.juvenxu.mvnbook&lt;/groupId>  </span><br><span class=line>  &lt;artifactId>hello-world&lt;/artifactId>  </span><br><span class=line>  &lt;version>1.0-SNAPSHOT&lt;/version>  </span><br><span class=line>  &lt;name>Maven Hello World Project&lt;/name>  </span><br><span class=line>  &lt;dependencies>  </span><br><span class=line>    &lt;dependency>  </span><br><span class=line>       &lt;groupId>junit&lt;/groupId>  </span><br><span class=line>       &lt;artifactId>junit&lt;/artifactId>  </span><br><span class=line>       &lt;version>4.7&lt;/version>  </span><br><span class=line>       &lt;scope>test&lt;/scope>  </span><br><span class=line>    &lt;/dependency>  </span><br><span class=line>  &lt;/dependencies>  </span><br><span class=line>&lt;/project>  </span><br></pre></table></figure><p>代码中添加了 dependencies 元素，该元素下可以包含多个 dependency 元素以声明项目的依赖，这里我们添加了一个依赖 ——groupId 是 junit，artifactId 是 junit，version 是 4.7。前面我们提到 groupId、artifactId 和 version 是任何一个 Maven 项目最基本的坐标，JUnit 也不例外，有了这段声明，Maven 就能够自动下载 junit-4.7.jar。也许你会问，Maven 从哪里下载这个 jar 呢？<strong>在 Maven 之前，我们可以去 JUnit 的官网下载分发包。而现在有了 Maven，它会自动访问中央仓库（http://repo1.maven.org/maven2/），下载需要的文件。</strong>读者也可以自己访问该仓库，打开路径 junit/junit/4.7/，就能看到 junit-4.7.pom 和 junit-4.7.jar。本书第 6 章会详细介绍 Maven 仓库及中央仓库。<p>上述 POM 代码中还有一个值为 test 的元素 scope，scope 为依赖范围，若依赖范围为 test 则表示该依赖只对测试有效，换句话说，测试代码中的 import JUnit 代码是没有问题的，但是如果我们在主代码中用 import JUnit 代码，就会造成编译错误。如果不声明依赖范围，那么默认值就是 compile，表示该依赖对主代码和测试代码都有效。<p>配置了测试依赖，接着就可以编写测试类，回顾一下前面的 HelloWorld 类，现在我们要测试该类的 sayHello () 方法，检查其返回值是否为 “Hello Maven”。在 src/test/java 目录下创建文件，其内容如代码清单 3-4：<p>代码清单 3-4：Hello World 的测试代码<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.juvenxu.mvnbook.helloworld;  </span><br><span class=line><span class=keyword>import</span> <span class=keyword>static</span> org.junit.Assert.assertEquals;  </span><br><span class=line><span class=keyword>import</span> org.junit.Test;  </span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">HelloWorldTest</span>  </span><br><span class=line>{  </span><br><span class=line>    <span class=meta>@Test</span>  </span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">testSayHello</span><span class=params>()</span>  </span><br><span class=line>    {  </span><br><span class=line>        <span class=type>HelloWorld</span> <span class=variable>helloWorld</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">HelloWorld</span>();  </span><br><span class=line>        <span class=type>String</span> <span class=variable>result</span> <span class=operator>=</span> helloWorld.sayHello();  </span><br><span class=line>        assertEquals( <span class=string>"Hello Maven"</span>, result );  </span><br><span class=line>    }  </span><br><span class=line>}  </span><br></pre></table></figure><p><strong>一个典型的单元测试包含三个步骤：<br> 1. 准备测试类及数据；<br> 2. 执行要测试的行为；<br> 3. 检查结果。</strong><p>上述样例中，我们首先初始化了一个要测试的 HelloWorld 实例，接着执行该实例的 sayHello () 方法并保存结果到 result 变量中，最后使用 JUnit 框架的 Assert 类检查结果是否为我们期望的”Hello Maven”。在 JUnit 3 中，约定所有需要执行测试的方法都以 test 开头，这里我们使用了 JUnit 4，但我们仍然遵循这一约定，在 JUnit 4 中，需要执行的测试方法都应该以 @Test 进行标注。<p>测试用例编写完毕之后就可以调用 Maven 执行测试，运行 <code>mvn clean test</code> ：<figure class="highlight plaintext"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br></pre><td class=code><pre><span class=line>[INFO] Scanning for projects...  </span><br><span class=line>[INFO] ------------------------------------------------------------------------  </span><br><span class=line>[INFO] Building Maven Hello World Project  </span><br><span class=line>[INFO]    task-segment: [clean, test]  </span><br><span class=line>[INFO] ------------------------------------------------------------------------  </span><br><span class=line>[INFO] [clean:clean {execution: default-clean}]  </span><br><span class=line>[INFO] Deleting directory D:\git-juven\mvnbook\code\hello-world\target  </span><br><span class=line>[INFO] [resources:resources {execution: default-resources}]  </span><br><span class=line>…  </span><br><span class=line>Downloading: http://repo1.maven.org/maven2/junit/junit/4.7/junit-4.7.pom  </span><br><span class=line>1K downloaded  (junit-4.7.pom)  </span><br><span class=line>[INFO] [compiler:compile {execution: default-compile}]  </span><br><span class=line>[INFO] Compiling 1 source file to D: \code\hello-world\target\classes  </span><br><span class=line>[INFO] [resources:testResources {execution: default-testResources}]  </span><br><span class=line>…  </span><br><span class=line>Downloading: http://repo1.maven.org/maven2/junit/junit/4.7/junit-4.7.jar  </span><br><span class=line>226K downloaded  (junit-4.7.jar)  </span><br><span class=line>[INFO] [compiler:testCompile {execution: default-testCompile}]  </span><br><span class=line>[INFO] Compiling 1 source file to D:\ code\hello-world\target\test-classes  </span><br><span class=line>[INFO] ------------------------------------------------------------------------  </span><br><span class=line>[ERROR] BUILD FAILURE  </span><br><span class=line>[INFO] ------------------------------------------------------------------------  </span><br><span class=line>[INFO] Compilation failure  </span><br><span class=line>D:\code\hello-world\src\test\java\com\juvenxu\mvnbook\helloworld\HelloWorldTest.java:[8,5] -source 1.3 中不支持注释  </span><br><span class=line>（请使用 -source 5 或更高版本以启用注释）  </span><br><span class=line>    @Test  </span><br><span class=line>[INFO] ------------------------------------------------------------------------  </span><br><span class=line>[INFO] For more information, run Maven with the -e switch  </span><br><span class=line>  …  </span><br></pre></table></figure><p>不幸的是构建失败了，不过我们先耐心分析一下这段输出（为了本书的简洁，一些不重要的信息我用省略号略去了）。命令行输入的是 mvn clean test，而 Maven 实际执行的可不止这两个任务，还有 clean:clean、resources:resources、compiler:compile、resources:testResources 以及 compiler:testCompile。暂时我们需要了解的是，在 Maven 执行测试（test）之前，它会先自动执行项目主资源处理，主代码编译，测试资源处理，测试代码编译等工作，这是 Maven 生命周期的一个特性，本书后续章节会详细解释 Maven 的生命周期。<p>从输出中我们还看到：Maven 从中央仓库下载了 junit-4.7.pom 和 junit-4.7.jar 这两个文件到本地仓库（~/.m2/repository）中，供所有 Maven 项目使用。<p>构建在执行 compiler:testCompile 任务的时候失败了，Maven 输出提示我们需要使用 - source 5 或更高版本以启动注释，也就是前面提到的 JUnit 4 的 @Test 注解。这是 Maven 初学者常常会遇到的一个问题。<strong>由于历史原因，Maven 的核心插件之一 compiler 插件默认只支持编译 Java 1.3，因此我们需要配置该插件使其支持 Java 5</strong>，见代码清单 3-5：<p>代码清单 3-5：配置 maven-compiler-plugin 支持 Java 5<figure class="highlight plaintext"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br></pre><td class=code><pre><span class=line>&lt;project>  </span><br><span class=line>…  </span><br><span class=line>  &lt;build>  </span><br><span class=line>    &lt;plugins>  </span><br><span class=line>       &lt;plugin>  </span><br><span class=line>         &lt;groupId>org.apache.maven.plugins&lt;/groupId>  </span><br><span class=line>         &lt;artifactId>maven-compiler-plugin&lt;/artifactId>  </span><br><span class=line>         &lt;configuration>  </span><br><span class=line>           &lt;source>1.5&lt;/source>  </span><br><span class=line>           &lt;target>1.5&lt;/target>  </span><br><span class=line>         &lt;/configuration>  </span><br><span class=line>       &lt;/plugin>  </span><br><span class=line>    &lt;/plugins>  </span><br><span class=line>  &lt;/build>  </span><br><span class=line>…  </span><br><span class=line>&lt;/project>  </span><br><span class=line></span><br></pre></table></figure><p>该 POM 省略了除插件配置以外的其他部分，我们暂且不去关心插件配置的细节，只需要知道 compiler 插件支持 Java 5 的编译。现在再执行 mvn clean test，输出如下：<pre><code>[INFO] Compiling 1 source file to D: \code\hello-world\target\test-classes  
[INFO] [surefire:test {execution: default-test}]  
[INFO] Surefire report directory: D:\code\hello-world\target\surefire-reports  

 T E S T S  

Running com.juvenxu.mvnbook.helloworld.HelloWorldTest  
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.055 sec  
Results :  
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0  
[INFO]  
[INFO] BUILD SUCCESSFUL  
[INFO] </code></pre><p>我们看到 compiler:testCompile 任务执行成功了，测试代码通过编译之后在 target/test-classes 下生成了二进制文件，紧接着 surefire:test 任务运行测试，surefire 是 Maven 世界中负责执行测试的插件，这里它运行测试用例 HelloWorldTest，并且输出测试报告，显示一共运行了多少测试，失败了多少，出错了多少，跳过了多少。显然，我们的测试通过了 ——BUILD SUCCESSFUL。<h3 id=打包和运行>打包和运行</h3><p>将项目进行编译、测试之后，下一个重要步骤就是打包（package）。Hello World 的 POM 中没有指定打包类型，使用默认打包类型 jar，我们可以简单地执行命令 <code>mvn clean package</code> 进行打包，可以看到如下输出：<figure class="highlight plaintext"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br></pre><td class=code><pre><span class=line>…  </span><br><span class=line>Tests run: 1, Failures: 0, Errors: 0, Skipped: 0  </span><br><span class=line></span><br><span class=line>[INFO] [jar:jar {execution: default-jar}]  </span><br><span class=line>[INFO] Building jar: D:\code\hello-world\target\hello-world-1.0-SNAPSHOT.jar  </span><br><span class=line>[INFO]   </span><br><span class=line></span><br><span class=line>[INFO] BUILD SUCCESSFUL  </span><br><span class=line>…  </span><br><span class=line>```  </span><br><span class=line>类似地，Maven会在打包之前执行编译、测试等操作。这里我们看到jar:jar任务负责打包，实际上就是jar插件的jar目标将项目主代码打包成一个名为hello-world-1.0-SNAPSHOT.jar的文件，**该文件也位于target/输出目录中，它是根据artifact-version.jar规则进行命名的**，如有需要，我们还可以使用finalName来自定义该文件的名称，这里暂且不展开，本书后面会详细解释。</span><br><span class=line></span><br><span class=line>至此，我们得到了项目的输出，如果有需要的话，就可以复制这个jar文件到其他项目的Classpath中从而使用HelloWorld类。但是，**如何才能让其他的Maven项目直接引用这个jar呢？**我们还需要一个安装的步骤，执行 `mvn clean install`：</span><br><span class=line></span><br><span class=line></span><br><span class=line>   [INFO] [jar:jar {execution: default-jar}]  </span><br><span class=line>   [INFO] Building jar: D: \code\hello-world\target\hello-world-1.0-SNAPSHOT.jar  </span><br><span class=line>   [INFO] [install:install {execution: default-install}]  </span><br><span class=line>   [INFO] Installing D:\code\hello-world\target\hello-world-1.0-SNAPSHOT.jar to C:\Users\juven\.m2\repository\com\juvenxu\mvnbook\hello-world\1.0-SNAPSHOT\hello-world-1.0-SNAPSHOT.jar  </span><br><span class=line>   [INFO]  </span><br><span class=line></span><br><span class=line>   [INFO] BUILD SUCCESSFUL  </span><br><span class=line></span><br><span class=line></span><br><span class=line>在打包之后，我们又执行了安装任务install:install，从输出我们看到该任务将项目输出的jar安装到了Maven本地仓库中，我们可以打开相应的文件夹看到Hello World项目的pom和jar。之前讲述JUnit的POM及jar的下载的时候，我们说只有构件被下载到本地仓库后，才能由所有Maven项目使用，这里是同样的道理，只有将Hello World的构件安装到本地仓库之后，其他Maven项目才能使用它。</span><br><span class=line></span><br><span class=line>我们已经将体验了Maven最主要的命令：`mvn clean compile`、`mvn clean test`、`mvn clean package`、`mvn clean install`。**执行test之前是会先执行compile的，执行package之前是会先执行test的，而类似地，install之前会执行package**。我们可以在任何一个Maven项目中执行这些命令，而且我们已经清楚它们是用来做什么的。</span><br><span class=line></span><br><span class=line>到目前为止，我们还没有运行Hello World项目，不要忘了HelloWorld类可是有一个main方法的。默认打包生成的jar是不能够直接运行的，因为带有main方法的类信息不会添加到manifest中(我们可以打开jar文件中的META-INF/MANIFEST.MF文件，将无法看到Main-Class一行)。为了生成可执行的jar文件，我们需要借助maven-shade-plugin，配置该插件如下：</span><br><span class=line></span><br><span class=line>```  </span><br><span class=line>&lt;plugin>  </span><br><span class=line>&lt;groupId>org.apache.maven.plugins&lt;/groupId>  </span><br><span class=line>  &lt;artifactId>maven-shade-plugin&lt;/artifactId>  </span><br><span class=line>  &lt;version>1.2.1&lt;/version>  </span><br><span class=line>  &lt;executions>  </span><br><span class=line>    &lt;execution>  </span><br><span class=line>      &lt;phase>package&lt;/phase>  </span><br><span class=line>      &lt;goals>  </span><br><span class=line>        &lt;goal>shade&lt;/goal>  </span><br><span class=line>      &lt;/goals>  </span><br><span class=line>      &lt;configuration>  </span><br><span class=line>        &lt;transformers>  </span><br><span class=line>          &lt;transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">            &lt;mainClass>com.juvenxu.mvnbook.helloworld.HelloWorld&lt;/mainClass>  </span><br><span class=line>         &lt;/transformer>  </span><br><span class=line>       &lt;/transformers>  </span><br><span class=line>     &lt;/configuration>  </span><br><span class=line>     &lt;/execution>  </span><br><span class=line>  &lt;/executions>  </span><br><span class=line>&lt;/plugin>  </span><br><span class=line>```  </span><br><span class=line>plugin元素在POM中的相对位置应该在`&lt;project>&lt;build>&lt;plugins>`下面。我们配置了mainClass为com.juvenxu.mvnbook.helloworld.HelloWorld，项目在打包时会将该信息放到MANIFEST中。现在执行 mvn clean install ，待构建完成之后打开target/目录，我们可以看到hello-world-1.0-SNAPSHOT.jar和original-hello-world-1.0-SNAPSHOT.jar，前者是带有Main-Class信息的可运行jar，后者是原始的jar，打开hello-world-1.0-SNAPSHOT.jar的META-INF/MANIFEST.MF，可以看到它包含这样一行信息：</span><br><span class=line></span><br><span class=line>    Main-Class: com.juvenxu.mvnbook.helloworld.HelloWorld</span><br><span class=line></span><br><span class=line>现在，我们在项目根目录中执行该jar文件：</span><br><span class=line></span><br><span class=line>    D: \code\hello-world>java -jar target\hello-world-1.0-SNAPSHOT.jar  </span><br><span class=line>    Hello Maven</span><br><span class=line></span><br><span class=line>控制台输出为 Hello Maven，这正是我们所期望的。</span><br><span class=line></span><br><span class=line>本小节介绍了Hello World项目，侧重点是Maven而非Java代码本身，介绍了POM、Maven项目结构、以及如何编译、测试、打包，等等。</span><br><span class=line></span><br><span class=line>### 使用Archetype生成项目骨架  </span><br><span class=line></span><br><span class=line>Hello World项目中有一些Maven的约定：在项目的根目录中放置pom.xml，在src/main/java目录中放置项目的主代码，在src/test/java中放置项目的测试代码。我之所以一步一步地展示这些步骤，是为了能让可能是Maven初学者的你得到最实际的感受。我们称这些基本的目录结构和pom.xml文件内容称为项目的骨架，当你第一次创建项目骨架的时候，你还会饶有兴趣地去体会这些默认约定背后的思想，第二次，第三次，你也许还会满意自己的熟练程度，但第四、第五次做同样的事情，就会让程序员恼火了，为此**Maven提供了Archetype以帮助我们快速勾勒出项目骨架。**</span><br><span class=line></span><br><span class=line>还是以Hello World为例，我们使用maven archetype来创建该项目的骨架，离开当前的Maven项目目录。  </span><br><span class=line>如果是Maven 3，简单的运行：</span><br><span class=line></span><br><span class=line>    mvn archetype:generate</span><br><span class=line></span><br><span class=line>如果是Maven 2，最好运行如下命令：</span><br><span class=line></span><br><span class=line>    mvn org.apache.maven.plugins:maven-archetype-plugin:2.0-alpha-5:generate</span><br><span class=line></span><br><span class=line>很多资料会让你直接使用更为简单的 mvn archetype:generate 命令，但在Maven2中这是不安全的，因为该命令没有指定archetype插件的版本，于是Maven会自动去下载最新的版本，进而可能得到不稳定的SNAPSHOT版本，导致运行失败。然而在Maven 3中，即使用户没有指定版本，Maven也只会解析最新的稳定版本，因此这是安全的，具体内容见7.7小节。</span><br><span class=line></span><br><span class=line>我们实际上是在运行插件**maven-archetype-plugin**，注意冒号的分隔，其格式为 groupId:artifactId:version:goal ，org.apache.maven.plugins 是maven官方插件的groupId，maven-archetype-plugin 是archetype插件的artifactId，2.0-alpha-5 是目前该插件最新的稳定版，generate是我们要使用的插件目标。</span><br><span class=line></span><br><span class=line>紧接着我们会看到一段长长的输出，有很多可用的archetype供我们选择，包括著名的Appfuse项目的archetype，JPA项目的archetype等等。每一个archetype前面都会对应有一个编号，同时命令行会提示一个默认的编号，其对应的archetype为maven-archetype-quickstart，我们直接回车以选择该archetype，紧接着Maven会提示我们输入要创建项目的groupId、artifactId、 version、以及包名package，如下输入并确认：</span><br><span class=line></span><br><span class=line>```  </span><br><span class=line>Define value for groupId: : com.juvenxu.mvnbook  </span><br><span class=line>Define value for artifactId: : hello-world  </span><br><span class=line>Define value for version:  1.0-SNAPSHOT: :  </span><br><span class=line>Define value for package:  com.juvenxu.mvnbook: : com.juvenxu.mvnbook.helloworld  </span><br><span class=line>Confirm properties configuration:  </span><br><span class=line>groupId: com.juvenxu.mvnbook  </span><br><span class=line>artifactId: hello-world  </span><br><span class=line>version: 1.0-SNAPSHOT  </span><br><span class=line>package: com.juvenxu.mvnbook.helloworld  </span><br><span class=line> Y: : Y  </span><br></pre></table></figure><p>Archetype 插件将根据我们提供的信息创建项目骨架。在当前目录下，Archetype 插件会创建一个名为 hello-world（我们定义的 artifactId）的子目录，从中可以看到项目的基本结构：基本的 pom.xml 已经被创建，里面包含了必要的信息以及一个 junit 依赖；主代码目录 src/main/java 已经被创建，在该目录下还有一个 Java 类 com.juvenxu.mvnbook.helloworld.App，注意这里使用到了我们刚才定义的包名，而这个类也仅仅只有一个简单的输出 Hello World! 的 main 方法；测试代码目录 src/test/java 也被创建好了，并且包含了一个测试用例 com.juvenxu.mvnbook.helloworld.AppTest。<p>Archetype 可以帮助我们迅速地构建起项目的骨架，在前面的例子中，我们完全可以在 Archetype 生成的骨架的基础上开发 Hello World 项目以节省我们大量时间。<p>此外，我们这里仅仅是看到了一个最简单的 archetype，如果你有很多项目拥有类似的自定义项目结构以及配置文件，你完全可以一劳永逸地开发自己的 archetype，然后在这些项目中使用自定义的 archetype 来快速生成项目骨架，本书后面的章节会详细阐述如何开发 Maven Archetype。<h3 id=m2eclipse简单使用>m2eclipse 简单使用</h3><p>介绍前面 Hello World 项目的时候，我们并没有涉及 IDE，如此简单的一个项目，使用最简单的编辑器也能很快完成，但对于稍微大一些的项目来说，没有 IDE 就是不可想象的，本节我们先介绍 m2eclipse 的基本使用。<h4 id=导入maven项目>导入 Maven 项目</h4><p>第 2 章介绍了如何安装 m2eclipse，现在，我们使用 m2ecilpse 导入 Hello World 项目。选择菜单项 File，然后选择 Import，我们会看到一个 Import 对话框，在该对话框中选择 General 目录下的 Maven Projects，然后点击 Next，就会出现 Import Projects 对话框，在该对话框中点击 Browse… 选择 Hello World 的根目录（即包含 pom.xml 文件的那个目录），这时对话框中的 Projects: 部分就会显示该目录包含的 Maven 项目，如下图所示：<br> <img data-src=https://wulc.me/imgs/9a71aa9f-dc5e-32e1-8d0e-f71de55de5e9.jpg><p>点击 Finish 之后，m2ecilpse 就会将该项目导入到当前的 workspace 中，导入完成之后，我们就可以在 Package Explorer 视图中看到如下图的项目结构：<p><img data-src=https://wulc.me/imgs/dc2c1bfc-ce95-3395-a5d7-16bdf5894101.jpg><p>我们看到主代码目录 src/main/java 和测试代码目录 src/test/java 成了 Eclipse 中的资源目录，包和类的结构也十分清晰，当然 pom.xml 永远在项目的根目录下，而从这个视图中我们甚至还能看到项目的依赖 junit-4.7.jar，其实际的位置指向了 Maven 本地仓库（这里我自定义了 Maven 本地仓库地址为 D:，后续章节会介绍如何自定义本地仓库位置）。<h4 id=创建maven项目>创建 Maven 项目</h4><p>创建一个 Maven 项目也十分简单，选择菜单项 File -> New -> Other，在弹出的对话框中选择 Maven 下的 Maven Project，然后点击 Next >，在弹出的 New Maven Project 对话框中，我们使用默认的选项（不要选择 Create a simple project 选项，那样我们就能使用 Maven Archetype），点击 Next >，此时 m2eclipse 会提示我们选择一个 Archetype，我们选择 maven-archetype-quickstart，再点击 Next >。由于 m2eclipse 实际上是在使用 maven-archetype-plugin 插件创建项目，因此这个步骤与上一节我们使用 archetype 创建项目骨架类似，输入 groupId,、artifactId、version、package（暂时我们不考虑 Properties），如下图所示：<br> <img data-src=https://wulc.me/imgs/bb255ca9-2341-37fb-aa9c-de619c2bf80a.jpg><br> 注意，为了不和前面已导入的 Hello World 项目产生冲突和混淆，我们使用不同的 artifactId 和 package。OK，点击 Finish，Maven 项目就创建完成了，其结构与前一个已导入的 Hello World 项目基本一致。<h4 id=运行mvn命令>运行 mvn 命令</h4><p>我们需要在命令行输入如 mvn clean install 之类的命令来执行 maven 构建，m2eclipse 中也有对应的功能，在 Maven 项目或者 pom.xml 上右击，再选择 Run As，就能看到如下的常见 Maven 命令，如下图所示：<br> <img data-src=https://wulc.me/imgs/09f3ec72-eb31-3f25-97af-545213fe4793.jpg><br> 选择想要执行的 Maven 命令就能执行相应的构建，同时我们也能在 Eclipse 的 console 中看到构建输出。这里常见的一个问题是，默认选项中没有我们想要执行的 Maven 命令怎么办？比如，默认带有 mvn test，但我们想执行 mvn clean test，很简单，选择 Maven buid…<br> 以自定义 Maven 运行命令，在弹出对话框中的 Goals 一项中输入我们想要执行的命令，如 clean test，设置一下 Name，点击 Run 即可。并且，下一次我们选择 Maven build，或者使用快捷键 Alt + Shift + X, M 快速执行 Maven 构建的时候，上次的配置直接就能在历史记录中找到。</div><footer class=post-footer><div class=post-copyright><ul><li class=post-copyright-author><strong>本文作者： </strong>良超<li class=post-copyright-link><strong>本文链接：</strong> <a title="Maven 的安装、配置及使用入门" href=https://wulc.me/2016/02/18/Maven%E7%9A%84%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/>https://wulc.me/2016/02/18/Maven的安装、配置及使用入门/</a><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8=" class=exturl><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！</ul></div><div class=post-tags><a href=/tags/%E8%BD%AC%E8%BD%BD/ rel=tag><i class="fa fa-tag"></i> 转载</a><a href=/tags/Java/ rel=tag><i class="fa fa-tag"></i> Java</a><a href=/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/ rel=tag><i class="fa fa-tag"></i> 工具使用</a></div><div class=post-nav><div class=post-nav-item><a title="python 中的类属性和实例属性" href=/2016/02/14/python%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%B1%9E%E6%80%A7%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%B1%9E%E6%80%A7/ rel=prev> <i class="fa fa-angle-left"></i> python 中的类属性和实例属性 </a></div><div class=post-nav-item><a title="Hadoop2.6.0 安装注意事项" href=/2016/02/20/Hadoop2-6-0%E5%AE%89%E8%A3%85%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/ rel=next> Hadoop2.6.0 安装注意事项 <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© 2015 – <span itemprop=copyrightYear>2026</span><span class=with-love> <i class="fa fa-pen"></i> </span><span class=author itemprop=copyrightHolder>良超</span></div><div class=powered-by>由 <span class=exturl data-url=aHR0cHM6Ly9oZXhvLmlv>Hexo</span> & <span class=exturl data-url=aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9waXNjZXMv>NexT.Pisces</span> 强力驱动</div><!-- 51LA 网站统计 --><script charset=UTF-8 id=LA_COLLECT src=https://sdk.51.la/js-sdk-pro.min.js></script><script>LA.init({id: "JmI6QmP3fMkLet6B",ck: "JmI6QmP3fMkLet6B"})</script></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><div class=reading-progress-bar></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript>