<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id: "JmI6QmP3fMkLet6B",ck: "JmI6QmP3fMkLet6B"})</script>

  <link rel="apple-touch-icon" sizes="180x180" href="/imgs/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/imgs/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/imgs/favicon.ico">
  <link rel="mask-icon" href="/imgs/favicon.ico" color="#222">
  <meta name="google-site-verification" content="VcC-PHB4Om9SIR3Roqm7k1N-SHiBtQ6c3LJLVMKgU4U">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"wulc.me","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.15.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="这是一篇关于maven入门的相当好的文章，文章有点长，但是非常值得看。原文链接 Maven简介 何为Maven Maven这个词可以翻译为“知识的积累”，也可以翻译为“专家”或“内行”。本书将介绍Maven这一跨平台的项目管理工具。作为Apache组织中的一个颇为成功的开源项目，Maven主要服务于基于Java平 台的项目构建、依赖管理和项目信息管理。无论是小型的开源类库项目，还是大型的企业级应用">
<meta property="og:type" content="article">
<meta property="og:title" content="Maven的安装、配置及使用入门">
<meta property="og:url" content="https://wulc.me/2016/02/18/Maven%E7%9A%84%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/index.html">
<meta property="og:site_name" content="吴良超的学习笔记">
<meta property="og:description" content="这是一篇关于maven入门的相当好的文章，文章有点长，但是非常值得看。原文链接 Maven简介 何为Maven Maven这个词可以翻译为“知识的积累”，也可以翻译为“专家”或“内行”。本书将介绍Maven这一跨平台的项目管理工具。作为Apache组织中的一个颇为成功的开源项目，Maven主要服务于基于Java平 台的项目构建、依赖管理和项目信息管理。无论是小型的开源类库项目，还是大型的企业级应用">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wulc.me/imgs/e4f32577-29ad-35a7-b384-753eb4df2e37.jpg">
<meta property="og:image" content="https://wulc.me/imgs/1ae54751-ad82-3066-ba5a-e8818cfc504d.jpg">
<meta property="og:image" content="https://wulc.me/imgs/d36bea18-262e-35e3-8a44-e3bac9ba225b.jpg">
<meta property="og:image" content="https://wulc.me/imgs/8c938c76-5859-33ea-aee2-b1f6e3a182ac.jpg">
<meta property="og:image" content="https://wulc.me/imgs/c6793b02-251d-3e1f-833c-8ff12d14ba05.jpg">
<meta property="og:image" content="https://wulc.me/imgs/897a084a-6965-3d4a-b437-36c3a4ea5c09.jpg">
<meta property="og:image" content="https://wulc.me/imgs/93cb4cf7-4027-397d-9e42-185acb6fc868.jpg">
<meta property="og:image" content="https://wulc.me/imgs/9a71aa9f-dc5e-32e1-8d0e-f71de55de5e9.jpg">
<meta property="og:image" content="https://wulc.me/imgs/dc2c1bfc-ce95-3395-a5d7-16bdf5894101.jpg">
<meta property="og:image" content="https://wulc.me/imgs/bb255ca9-2341-37fb-aa9c-de619c2bf80a.jpg">
<meta property="og:image" content="https://wulc.me/imgs/09f3ec72-eb31-3f25-97af-545213fe4793.jpg">
<meta property="article:published_time" content="2016-02-18T14:06:31.000Z">
<meta property="article:modified_time" content="2023-07-16T15:28:28.202Z">
<meta property="article:author" content="良超">
<meta property="article:tag" content="转载">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="工具使用">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wulc.me/imgs/e4f32577-29ad-35a7-b384-753eb4df2e37.jpg">


<link rel="canonical" href="https://wulc.me/2016/02/18/Maven%E7%9A%84%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://wulc.me/2016/02/18/Maven%E7%9A%84%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/","path":"2016/02/18/Maven的安装、配置及使用入门/","title":"Maven的安装、配置及使用入门"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Maven的安装、配置及使用入门 | 吴良超的学习笔记</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">吴良超的学习笔记</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#maven%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">Maven简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%95%E4%B8%BAmaven"><span class="nav-number">1.1.</span> <span class="nav-text">何为Maven</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#maven%E6%98%AF%E4%BC%98%E7%A7%80%E7%9A%84%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7"><span class="nav-number">1.1.1.</span> <span class="nav-text">Maven是优秀的构建工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#maven%E4%B8%8D%E4%BB%85%E4%BB%85%E6%98%AF%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7"><span class="nav-number">1.1.2.</span> <span class="nav-text">Maven不仅仅是构建工具</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81maven"><span class="nav-number">1.2.</span> <span class="nav-text">为什么需要Maven</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%84%E8%A3%85pc%E5%92%8C%E5%93%81%E7%89%8Cpc"><span class="nav-number">1.2.1.</span> <span class="nav-text">组装PC和品牌PC</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ide%E4%B8%8D%E6%98%AF%E4%B8%87%E8%83%BD%E7%9A%84"><span class="nav-number">1.2.2.</span> <span class="nav-text">IDE不是万能的</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#make"><span class="nav-number">1.2.3.</span> <span class="nav-text">Make</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ant"><span class="nav-number">1.2.4.</span> <span class="nav-text">Ant</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E9%87%8D%E5%A4%8D%E5%8F%91%E6%98%8E%E8%BD%AE%E5%AD%90"><span class="nav-number">1.2.5.</span> <span class="nav-text">不重复发明轮子</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#maven%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE"><span class="nav-number">2.</span> <span class="nav-text">Maven的安装和配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8windows%E4%B8%8A%E5%AE%89%E8%A3%85maven"><span class="nav-number">2.1.</span> <span class="nav-text">在Windows上安装Maven</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5jdk%E5%AE%89%E8%A3%85"><span class="nav-number">2.1.1.</span> <span class="nav-text">检查JDK安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BDmaven"><span class="nav-number">2.1.2.</span> <span class="nav-text">下载Maven</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85"><span class="nav-number">2.1.3.</span> <span class="nav-text">本地安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%87%E7%BA%A7maven"><span class="nav-number">2.1.4.</span> <span class="nav-text">升级Maven</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8%E5%9F%BA%E4%BA%8Eunix%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%B8%8A%E5%AE%89%E8%A3%85maven"><span class="nav-number">2.2.</span> <span class="nav-text">在基于Unix的系统上安装Maven</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BD%E5%92%8C%E5%AE%89%E8%A3%85"><span class="nav-number">2.2.1.</span> <span class="nav-text">下载和安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%87%E7%BA%A7maven-1"><span class="nav-number">2.2.2.</span> <span class="nav-text">升级Maven</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95%E5%88%86%E6%9E%90"><span class="nav-number">2.3.</span> <span class="nav-text">安装目录分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#m2_home"><span class="nav-number">2.3.1.</span> <span class="nav-text">M2_HOME</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#m2"><span class="nav-number">2.3.2.</span> <span class="nav-text">~&#x2F;.m2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AEhttp%E4%BB%A3%E7%90%86"><span class="nav-number">2.4.</span> <span class="nav-text">设置HTTP代理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85m2eclipse"><span class="nav-number">2.5.</span> <span class="nav-text">安装m2eclipse</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#maven%E5%AE%89%E8%A3%85%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-number">2.6.</span> <span class="nav-text">Maven安装最佳实践</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AEmaven_opts%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-number">2.6.1.</span> <span class="nav-text">设置MAVEN_OPTS环境变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E7%94%A8%E6%88%B7%E8%8C%83%E5%9B%B4settings.xml"><span class="nav-number">2.6.2.</span> <span class="nav-text">配置用户范围settings.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8ide%E5%86%85%E5%B5%8C%E7%9A%84maven"><span class="nav-number">2.6.3.</span> <span class="nav-text">不要使用IDE内嵌的Maven</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#maven%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8"><span class="nav-number">3.</span> <span class="nav-text">Maven使用入门</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99pom.xml%E6%96%87%E4%BB%B6"><span class="nav-number">3.1.</span> <span class="nav-text">编写pom.xml文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E4%B8%BB%E4%BB%A3%E7%A0%81"><span class="nav-number">3.2.</span> <span class="nav-text">编写主代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81"><span class="nav-number">3.3.</span> <span class="nav-text">编写测试代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E5%92%8C%E8%BF%90%E8%A1%8C"><span class="nav-number">3.4.</span> <span class="nav-text">打包和运行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8archetype%E7%94%9F%E6%88%90%E9%A1%B9%E7%9B%AE%E9%AA%A8%E6%9E%B6"><span class="nav-number">3.5.</span> <span class="nav-text">使用Archetype生成项目骨架</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#m2eclipse%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="nav-number">3.6.</span> <span class="nav-text">m2eclipse简单使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5maven%E9%A1%B9%E7%9B%AE"><span class="nav-number">3.6.1.</span> <span class="nav-text">导入Maven项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAmaven%E9%A1%B9%E7%9B%AE"><span class="nav-number">3.6.2.</span> <span class="nav-text">创建Maven项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%90%E8%A1%8Cmvn%E5%91%BD%E4%BB%A4"><span class="nav-number">3.6.3.</span> <span class="nav-text">运行mvn命令</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="良超"
      src="/files/profile.jpg">
  <p class="site-author-name" itemprop="name">良超</p>
  <div class="site-description" itemprop="description">盈亏同源，享受生活的随机性</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">254</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">48</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/WuLC" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;WuLC" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:liangchaowu5@gmail.com" title="E-Mail → mailto:liangchaowu5@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wulc.me/2016/02/18/Maven%E7%9A%84%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/files/profile.jpg">
      <meta itemprop="name" content="良超">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴良超的学习笔记">
      <meta itemprop="description" content="盈亏同源，享受生活的随机性">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Maven的安装、配置及使用入门 | 吴良超的学习笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Maven的安装、配置及使用入门
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-02-18 22:06:31" itemprop="dateCreated datePublished" datetime="2016-02-18T22:06:31+08:00">2016-02-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="fa fa-tags"></i>
      </span>
      <span class="post-meta-item-text">标签</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/tags/%E8%BD%AC%E8%BD%BD/" itemprop="url" rel="index"><span itemprop="name">转载</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/tags/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" itemprop="url" rel="index"><span itemprop="name">工具使用</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>这是一篇关于maven入门的相当好的文章，文章有点长，但是非常值得看。<a
target="_blank" rel="noopener" href="http://www.cnblogs.com/dcba1112/archive/2011/05/01/2033805.html">原文链接</a></p>
<h2 id="maven简介">Maven简介</h2>
<h3 id="何为maven">何为Maven</h3>
<p>Maven这个词可以翻译为“知识的积累”，也可以翻译为“专家”或“内行”。本书将介绍Maven这一跨平台的项目管理工具。作为Apache组织中的一个颇为成功的开源项目，<strong>Maven主要服务于基于Java平
台的项目构建、依赖管理和项目信息管理。</strong>无论是小型的开源类库项目，还是大型的企业级应用；无论是传统的瀑布式开发，还是流行的敏捷模式，Maven都能
大显身手。 <span id="more"></span> #### 何为构建</p>
<p>不管你是否意识到，构建（build）是每一位程序员每天都在做的工作。早上来到公司，我们做的第一件事情就是从源码库签出最新的源码，然后进行单元测试，如果发现失败的测试，会找相关的同事一起调试，修复错误代码。接着回到自己的工作上来，编写自己的单元测试及产品代码，我们会感激IDE随时报出的编译错误提示。</p>
<p>忙到午饭时间，代码编写得差不多了，测试也通过了，开心地享用午餐，然后休息。下午先在昏昏沉沉中开了个例会，会议结束后喝杯咖啡继续工作。刚才在会上经理要求看测试报告，于是找了相关工具集成进IDE，生成了像
模像样的测试覆盖率报告，接着发了一封电子邮件给经理，松了口气。谁料QA小组又发过来了几个bug，没办法，先本地重现再说，于是熟练地用IDE生成了一个WAR包，部署到Web容器下，启动容器。看到熟悉的界面了，遵循bug报告，一步步重现了bug……快下班的时候，bug修好了，提交代码，通知
QA小组，在愉快中结束了一天的工作。</p>
<p>仔细总结一下，我们会发现，<strong>除了编写源代码，我们每天有相当一部分时间花在了编译、运行单元测试、生成文档、打包和部署等烦琐且不起眼的工作上，这就是构建。</strong>如果我们现在还手工这样做，那成本也太高了，于是有人用软件的方法让这一系列工作完全自动化，使得软件的构建可以像全自动流水线一样，只需要一条简单的命令，所有烦琐的步骤都能够自动完成，很快就能得到最终结果。</p>
<h4 id="maven是优秀的构建工具">Maven是优秀的构建工具</h4>
<p>前面介绍了<strong>Maven的用途之一是服务于构建，它是一个异常强大的构建工具，能够帮我们自动化构建过程，从清理、编译、测试到生成报告，再到打包和部署。</strong>我们不需要也不应该一遍又一遍地输入命令，一次又一次地点击鼠标，我们要做的是使用Maven配置好项目，然后输入简单的命令(如mvn
clean install)，Maven会帮我们处理那些烦琐的任务。</p>
<p>Maven是跨平台的，这意味着无论是在Windows上，还是在Linux或者Mac上，都可以使用同样的命令。</p>
<p>我们一直在不停地寻找避免重复的方法。设计的重复、编码的重复、文档的重复，当然还有构建的重复。Maven最大化地消除了构建的重复，抽象了构建生命周期，并且为绝大部分的构建任务提供了已实现的插件，我们不再需要定义过程，甚至不需要再去实现这些过程中的一些任务。最简单的例子是测试，我们没必要告诉Maven去测试，更不需要告诉Maven如何运行测试，只需要遵循Maven的约定编写好测试用例，当我们运行构建的时候，这些测试便会自动运行。</p>
<p>想象一下，Maven抽象了一个完整的构建生命周期模型，这个模型吸取了大量其他的构建脚本和构建工具的优点，总结了大量项目的实际需求。如果遵循这个模型，可以避免很多不必要的错误，可以直接使用大量成熟的Maven插件来完成我们的任务（很多时候我们可能都不知道自己在使用Maven插件）。此外，如果有非常特殊的需求，我们也可以轻松实现自己的插件。</p>
<p><strong>Maven还有一个优点，它能帮助我们标准化构建过程</strong>。在Maven之前，十个项目可能有十种构建方式；有了Maven之后，所有项目的构建命令都是简单一致的，这极大地避免了不必要的学习成本，而且有利于促进项目团队的标准化。</p>
<p>综上所述，Maven作为一个构建工具，不仅能帮我们自动化构建，还能够抽象构建过程，提供构建任务实现；它跨平台，对外提供了一致的操作接口，这一切足以使它成为优秀的、流行的构建工具。</p>
<h4 id="maven不仅仅是构建工具">Maven不仅仅是构建工具</h4>
<p>Java不仅是一门编程语言，还是一个平台，通过JRuby和Jython，我们可以在Java平台上编写和运行Ruby和Python程序。我们也应该认识到，<strong>Maven不仅是构建工具，还是一个依赖管理工具和项目信息管理工具。
它提供了中央仓库，能帮我们自动下载构件。</strong></p>
<p>在这个开源的年代里，几乎任何Java应用都会借用一些第三方的开源类库，这些类库都可通过依赖的方式引入到项目中来。随着依赖的增多，版本不一致、版本冲突、依赖臃肿等问题都会接踵而来。手工解决这些问题是十分枯燥的，幸运的是<strong>Maven提供了一个优秀的解决方案，它通过一个坐标系统准确地定位每一个构件（artifact），也就是通过一组坐标Maven能够找到任何一个
Java类库（如jar文件）。</strong>Maven给这个类库世界引入了经纬，让它们变得有秩序，于是我们可以借助它来有序地管理依赖，轻松地解决那些繁杂的依赖问题。</p>
<p>Maven还能帮助我们管理原本分散在项目中各个角落的项目信息，包括项目描述、开发者列表、版本控制系统地址、许可证、缺陷管理系统地址等。这些微小的变化看起来很琐碎，并不起眼，但却在不知不觉中为我们节省了大量寻找信息的时间。除了直接的项目信息，通过Maven自动生成的站点，以及一些已有的插件，我们还能够轻松获得项目文档、测试报告、静态分析报告、源码版本日志报告等
非常具有价值的项目信息。</p>
<p>Maven还为全世界的Java开发者提供了一个免费的中央仓库，在其中几乎可以找到任何的流行开源类库。通过一些Maven的衍生工具（如Nexus），我们还能对其进行快速地搜索。只要定位了坐标，Maven就能够帮我们自动下载，省去了手工劳动。</p>
<p>使用Maven还能享受一个额外的好处，即Maven对于项目目录结构、测试用
例命名方式等内容都有既定的规则，只要遵循了这些成熟的规则，用户在项目间切换的时候就免去了额外的学习成本，可以说是约定优于配置
（Convention Over Configuration）。</p>
<h3 id="为什么需要maven">为什么需要Maven</h3>
<p><strong>Maven不是Java领域唯一的构建管理的解决方案。本节将通过一些简单的例子解释Maven的必要性，并介绍其他构建解决方案，如IDE、Make和Ant，并将它们与Maven进行比较。</strong></p>
<h4 id="组装pc和品牌pc">组装PC和品牌PC</h4>
<p>笔者初中时开始接触计算机，到了高中时更是梦寐以求希望拥有一台自己的计算机。我的第一台计算机是赛扬733的，选购是一个漫长的过程，我先阅读了大量的杂志以了解各类配件的优劣，CPU、内存、主板、显卡，甚至声卡，我都仔细地挑选，后来还跑了很多商家，调货、讨价还价，组装好后自己装操作系统和驱动程序……虽然这花费了我大量时间，但我很享受这个过程。可是事实证明，装出来的机器稳定性不怎么好。</p>
<p>一年前我需要配一台工作站，这时候我已经没有太多时间去研究电脑配件了。我选择了某知名PC供应商的在线商店，大概浏览了一下主流的机型，选择了我需要的配置，然后下单、付款。接着PC供应商帮我组装电脑、安装操作系统和驱动程序。一周后，物流公司将电脑送到我的家里，我接上显示器、电源、鼠标和键盘就能直接使用了。这为我节省了大量时间，而且这台电脑十分稳定，商家在把电脑发送给我之前已经进行了很好的测试。对了，我还能享受两年的售后服务。</p>
<p>使用脚本建立高度自定义的构建系统就像买组装PC，耗时费力，结果也不一定很好。当然，你可以享受从无到有的乐趣，但恐怕实际项目中无法给你那么多时间。使用Maven就像购买品牌PC，省时省力，并能得到成熟的构建系统，还能得到来自于Maven社区的大量支持。唯一与购买品牌PC不同的是，Maven是开源的，你无须为此付费。如果有兴趣，你还能去了解Maven是如何工作的，而我们无法知道那些PC巨头的商业秘密。</p>
<h4 id="ide不是万能的">IDE不是万能的</h4>
<p>当然，我们无法否认优秀的IDE能大大提高开发效率。当前主流的IDE如Eclipse和NetBeans等都提供了强大的文本编辑、调试甚至重构功能。虽然使用简单的文本编辑器和命令行也能完成绝大部分开发工作，但很少有人愿意那样做。然而，IDE是有其天生缺陷的：</p>
<ul>
<li><strong>IDE依赖大量的手工操作</strong>。编译、测试、代码生成等工作都是相互独立的，很难一键完成所有工作。手工劳动往往意味着低效，意味着容易出错。</li>
<li><strong>很难在项目中统一所有的IDE配置，每个人都有自己的喜好</strong>。也正是由于这个原因，一个在机器A上可以成功运行的任务，到了机器B的IDE中可能就会失败。</li>
</ul>
<p>我们应该合理利用IDE，而不是过多地依赖它。对于构建这样的任务，在IDE中一次次地点击鼠标是愚蠢的行为。Maven是这方面的专家，而且主流IDE都集成了Maven，我们可以在IDE中方便地运行Maven执行构建。</p>
<h4 id="make">Make</h4>
<p>Make也许是最早的构建工具，它由Stuart
Feldman于1977年在Bell实验室创建。Stuart
Feldman也因此于2003年获得了ACM国际计算机组织颁发的软件系统奖。目前Make有很多衍生实现，包括最流行的GNU
Make和BSD Make，还有Windows平台的Microsoft nmake等。</p>
<p><strong>Make由一个名为Makefile的脚本文件驱动，该文件使用Make自己定义的语法格式。</strong>其基本组成部分为一系列规则（Rules），而<strong>每一条规则又包括目标（Target）、依赖（Prerequisite）和命令（Command）</strong>。Makefile的基本结构如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TARGET… : PREREQUISITE…</span><br><span class="line">COMMAND  </span><br><span class="line">…  </span><br><span class="line">…  </span><br></pre></td></tr></table></figure>
<p>Make通过一系列目标和依赖将整个构建过程串联起来，同时利用本地命令完成每个目标的实际行为。<strong>Make的强大之处在于它可以利用所有系统的本地命令，尤其是UNIX/Linux系统，丰富的功能、强大的命令能够帮助Make快速高效地完成任务。</strong></p>
<p>但是，Make将自己和操作系统绑定在一起了。也就是说，使用Make，就不能实现（至少很难）跨平台的构建，这对于Java来说是非常不友好的。此外，Makefile的语法也成问题，很多人抱怨Make构建失败的原因往往是一个难以发现的空格或Tab使用错误。</p>
<h4 id="ant">Ant</h4>
<p>Ant不是指蚂蚁，而是意指“另一个整洁的工具”（Another Neat
Tool），它最早用来构建著名的Tomcat，其作者James Duncan
Davidson创作它的动机就是因为受不了Makefile的语法格式。我们可以将Ant看成是一个Java版本的Make，也正因为使用了Java，Ant是跨平台的。此外，Ant使用XML定义构建脚本，相对于Makefile来说，这也更加友好。</p>
<p>与Make类似，Ant有一个构建脚本build.xml，如下所示： <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">name</span>=<span class="string">&quot;Hello&quot;</span> <span class="attr">default</span>=<span class="string">&quot;compile&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">target</span> <span class="attr">name</span>=<span class="string">&quot;compile&quot;</span> <span class="attr">description</span>=<span class="string">&quot;compile the Java source code to class files&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mkdir</span> <span class="attr">dir</span>=<span class="string">&quot;classes&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">javac</span> <span class="attr">srcdir</span>=<span class="string">&quot;.&quot;</span> <span class="attr">destdir</span>=<span class="string">&quot;classes&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">target</span> <span class="attr">name</span>=<span class="string">&quot;jar&quot;</span> <span class="attr">depends</span>=<span class="string">&quot;compile&quot;</span> <span class="attr">description</span>=<span class="string">&quot;create a Jar file &quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jar</span> <span class="attr">destfile</span>=<span class="string">&quot;hello.jar&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">fileset</span> <span class="attr">dir</span>=<span class="string">&quot;classes&quot;</span> <span class="attr">includes</span>=<span class="string">&quot;**/*.class&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">manifest</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;Main.Class&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HelloProgram&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">jar</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><strong>build.xml的基本结构也是目标（target）、依赖（depends），以及实现目标的任务。</strong>比如在上面的脚本中，jar目标用来创建应用程序jar文件，该目标依赖于compile目标，后者执行的任务是创建一个名为classes的文件夹，编译当前目录的java文件至classes目录。compile目标完成后，jar目标再执行自己的任务。Ant有大量内置的用Java实现的任务，这保证了其跨平台的特质，同时，Ant也有特殊的任务exec来执行本地命令。</p>
<p><strong>和Make一样，Ant也都是过程式的，开发者显式地指定每一个目标，以及完成该目标所需要执行的任务。针对每一个项目，开发者都需要重新编写这一过程，这里其实隐含着很大的重复。</strong></p>
<p>Maven是声明式的，项目构建过程和过程各个阶段所需的工作都由插件实现，并且大部分插件都是现成的，开发者只需要声明项目的基本元素，Maven就执行内置的、完整的构建过程。这在很大程度上消除了重复。</p>
<p><strong>Ant是没有依赖管理的</strong>，所以很长一段时间Ant用户都不得不手工管理依赖，这是一个令人头疼的问题。幸运的是，Ant用户现在可以借助Ivy管理依赖。而对于Maven用户来说，依赖管理是理所当然的，Maven不仅内置了依赖管理，更有一个可能拥有全世界最多Java开源软件包的中央仓库，Maven用户无须进行任何配置就可以直接享用。</p>
<h4 id="不重复发明轮子">不重复发明轮子</h4>
<p>【该小节内容整理自网友Arthas最早在Maven中文MSN的群内的讨论，在此表示感谢】
小张是一家小型民营软件公司的程序员，他所在的公司要开发一个新的Web项目。经过协商，决定使用Spring、iBatis和Tapstry。jar包去哪里找呢？公司里估计没有人能把Spring、iBatis和Tapstry所使用的jar包一个不少地找出来。大家的做法是，先到Spring的站点上去找一个spring.with.dependencies，然后去iBatis的网站上把所有列出来的jar包下载下来，对Tapstry、Apache
commons等执行同样的操作。项目还没有开始，WEB.INF/lib下已经有近百个jar包了，带版本号的、不带版本号的、有用的、没用的、相冲突的，怎一个“乱”字了得！</p>
<p>在项目开发过程中，小张不时地发现版本错误和版本冲突问题，他只能硬着头皮逐一解决。项目开发到一半，经理发现最终部署的应用的体积实在太大了，要求小张去掉一些没用的jar包，于是小张只能加班加点地一个个删……</p>
<p>小张隐隐地觉得这些依赖需要一个框架或者系统来进行管理。</p>
<p>小张喜欢学习流行的技术，前几年Ant十分流行，他学了，并成为了公司这方面的专家。小张知道，Ant打包，无非就是创建目录，复制文件，编译源代码，使用一堆任务，如copydir、fileset、classpath、ref、target，然后再jar、zip、war，打包就成功了。</p>
<p>项目经理发话了：“兄弟们，新项目来了，小张，你来写Ant脚本！”</p>
<p>“是，保证完成任务！”接着，小张继续创建一个新的XML文件。target clean;
target compile; target jar; ……
不知道他是否想过，在他写的这么多的Ant脚本中，有多少是重复劳动，有多少代码会在一个又一个项目中重现。既然都差不多，有些甚至完全相同，为什么每次都要重新编写？</p>
<p>终于有一天，小张意识到了这个问题，想复用Ant脚本，于是在开会时他说：“以后就都用我这个规范的Ant脚本吧，新的项目只要遵循我定义的目录结构就可以了。”经理听后觉得很有道理：“嗯，确实是个进步。”</p>
<p>这时新来的研究生发言了：“经理，用Maven吧，这个在开源社区很流行，比Ant更方便。”小张一听很惊讶，Maven真比自己的“规范化Ant”强大？其实他不知道自己只是在重新发明轮子，Maven已经有一大把现成的插件，全世界都在用，你自己不用写任何代码！</p>
<h2 id="maven的安装和配置">Maven的安装和配置</h2>
<p>前面介绍了Maven是什么，以及为什么要使用Maven，我们将从本章实际开始实际接触Maven。本章首先将介绍如何在主流的操作系统下安装Maven，并详细解释Maven的安装文件；其次还会介绍如何在主流的IDE中集成Maven，以及Maven安装的最佳实践。</p>
<h3 id="在windows上安装maven">在Windows上安装Maven</h3>
<h4 id="检查jdk安装">检查JDK安装</h4>
<p>在安装Maven之前，首先要确认你已经正确安装了JDK。Maven可以运行在JDK
1.4及以上的版本上。本书的所有样例都基于JDK
5及以上版本。打开Windows的命令行，运行如下的命令来检查你的Java安装：</p>
<pre><code>C:\Users\Juven Xu&gt;echo %JAVA_HOME%
C:\Users\Juven Xu&gt;java -version</code></pre>
<p>结果如下图所示：</p>
<p><img data-src="https://wulc.me/imgs/e4f32577-29ad-35a7-b384-753eb4df2e37.jpg" /></p>
<p>上述命令首先检查环境变量JAVA_HOME是否指向了正确的JDK目录，接着尝试运行java命令。如果Windows无法执行java命令，或者无法找到JAVA_HOME环境变量。你就需要检查Java是否安装了，或者环境变量是否设置正确。关于环境变量的设置，请参考2.1.3节。</p>
<h4 id="下载maven">下载Maven</h4>
<p>请访问Maven的下载页面：http://maven.apache.org/download.html，其中包含针对不同平台的各种版本的Maven下载文件。对于首次接触Maven的读者来说，推荐使用Maven3.0，因此下载apache-maven-3.0-bin.zip。当然，如果你对Maven的源代码感兴趣并想自己构建Maven，还可以下载apache-maven-3.0
-src.zip。该下载页面还提供了md5校验和（checksum）文件和asc数字签名文件，可以用来检验Maven分发包的正确性和安全性。</p>
<p>在本书编写的时候，Maven 2的最新版本是2.2.1，Maven 3基本完全兼容Maven
2，而且较之于Maven
2它性能更好，还有不少功能的改进，如果你之前一直使用Maven
2，现在正犹豫是否要升级，那就大可不必担心了，快点尝试下Maven 3吧！</p>
<h4 id="本地安装">本地安装</h4>
<p>将安装文件解压到你指定的目录中，如：</p>
<pre><code>D:\bin&gt;jar xvf &quot;C:\Users\Juven Xu\Downloads\apache-maven-3.0--bin.zip&quot;</code></pre>
<p>这里的Maven安装目录是D:-maven-3.0，接着需要设置环境变量，将Maven安装配置到操作系统环境中。</p>
<p>打开系统属性面板（桌面上右键单击“我的电脑”→“属性”），点击高级系统设置，再点击环境变量，在系统变量中新建一个变量，变量名为M2_HOME，变量值为Maven的安装目录D:-maven-3.0。点击确定，接着在系统变量中找到一个名为Path的变量，在变量值的末尾加上%M2_HOME%;，注意多个值之间需要有分号隔开，然后点击确定。至此，环境变量设置完成</p>
<p>现在打开一个新的cmd窗口（这里强调新的窗口是因为新的环境变量配置需要新的cmd窗口才能生效），运行如下命令检查Maven的安装情况：</p>
<pre><code>C:\Users\Juven Xu&gt;echo %M2_HOME%
C:\Users\Juven Xu&gt;mvn -v</code></pre>
<p>第一条命令echo
%M2_HOME%用来检查环境变量M2_HOME是否指向了正确的Maven安装目录；而mvn
–version执行了第一条Maven命令，以检查Windows是否能够找到正确的mvn执行脚本。</p>
<h4 id="升级maven">升级Maven</h4>
<p>Maven还比较年轻，更新比较频繁，因此用户往往会需要更新Maven安装以获得更多更酷的新特性，以及避免一些旧的bug。</p>
<p><strong>在Windows上更新Maven非常简便，只需要下载新的Maven安装文件，解压至本地目录，然后更新M2_HOME环境变量便可。</strong>例如，假设Maven推出了新版本3.1，我们将其下载然后解压至目录D:-maven-3.1，接着遵照前一节描述的步骤编辑环境变量M2_HOME，更改其值为D:-maven-3.1。至此，更新就完成了。同理，如果你需要使用某一个旧版本的Maven，也只需要编辑M2_HOME环境变量指向旧版本的安装目录。</p>
<h3 id="在基于unix的系统上安装maven">在基于Unix的系统上安装Maven</h3>
<p>Maven是跨平台的，它可以在任何一种主流的操作系统上运行，本节将介绍如何在基于Unix的系统（包括Linux、Mac
OS以及FreeBSD等）上安装Maven。</p>
<h4 id="下载和安装">下载和安装</h4>
<p>首先，与在Windows上安装Maven一样，需要检查JAVA_HOME环境变量以及Java命令，细节不再赘述，命令如下：</p>
<pre><code>juven@juven-ubuntu:~$ echo $JAVA_HOME
juven@juven-ubuntu:~$ java –version</code></pre>
<p>接着到http://maven.apache.org/download.html
下载Maven安装文件，如apache-maven-3.0-bin.tar.gz，然后解压到本地目录：</p>
<pre><code>juven@juven-ubuntu:bin$ tar -xvzf apache-maven-3.0-bin.tar.gz</code></pre>
<p>现在已经创建好了一个Maven安装目录apache-maven-3.0，虽然直接使用该目录配置环境变量之后就能使用Maven了，但这里我更<strong>推荐做法是，在安装目录旁平行地创建一个符号链接，以方便日后的升级</strong>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">juven@juven-ubuntu:bin$ <span class="built_in">ln</span> -s apache-maven-3.0 apache-maven</span><br><span class="line">juven@juven-ubuntu:bin$ <span class="built_in">ls</span> -l</span><br><span class="line">total 4</span><br><span class="line">lrwxrwxrwx 1 juven juven   18 2009-09-20 15:43 apache-maven -&gt; apache-maven-3.0</span><br><span class="line">drwxr-xr-x 6 juven juven 4096 2009-09-20 15:39 apache-maven-3.0</span><br></pre></td></tr></table></figure>
<p>接下来，我们需要设置M2_HOME环境变量指向符号链接apache-maven-，并且把Maven安装目录下的bin/文件夹添加到系统环境变量PATH中去：
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">juven@juven-ubuntu:bin$ export M2_HOME=/home/juven/bin/apache-maven</span><br><span class="line">juven@juven-ubuntu:bin$ export PATH=$PATH:$M2_HOME/bin</span><br></pre></td></tr></table></figure>
一般来说，需要将这两行命令加入到系统的登录shell脚本中去，以我现在的Ubuntu
8.10为例，编辑~/.bashrc文件，添加这两行命令。这样，每次启动一个终端，这些配置就能自动执行。</p>
<p>至此，安装完成，我们可以运行以下命令检查Maven安装：</p>
<pre><code>juven@juven-ubuntu:bin$ echo $M2_HOME
juven@juven-ubuntu:bin$ mvn –version</code></pre>
<h4 id="升级maven-1">升级Maven</h4>
<p><strong>在基于Unix的系统上，可以利用符号链接这一工具来简化Maven的升级，不必像在Windows上那样，每次升级都必须更新环境变量。</strong></p>
<p>前一小节中我们提到，解压Maven安装包到本地之后，平行地创建一个符号链接，然后在配置环境变量时引用该符号链接，这样做是为了方便升级。现在，假设我们需要升级到新的Maven
3.1版本，同理，将安装包解压到与前一版本平行的目录下，然后更新符号链接指向3.1版的目录便可：</p>
<pre><code>juven@juven-ubuntu:bin$ rm apache-maven</code></pre>
<p>juven@juven-ubuntu:bin$ ln -s apache-maven-3.1/ apache-maven
juven@juven-ubuntu:bin$ ls -l total 8 lrwxrwxrwx 1 juven juven 17
2009-09-20 16:13 apache-maven -&gt; apache-maven-3.1 / drwxr-xr-x 6
juven juven 4096 2009-09-20 15:39 apache-maven-3.0drwxr-xr-x 2 juven
juven 4096 2009-09-20 16:09 apache-maven-3.1</p>
<p>同理，可以很方便地切换到Maven的任意一个版本。现在升级完成了，可以运行mvn
-v进行检查。</p>
<h3 id="安装目录分析">安装目录分析</h3>
<p>本章前面的内容讲述了如何在各种操作系统中安装和升级Maven。现在我们来仔细分析一下Maven的安装文件。</p>
<h4 id="m2_home">M2_HOME</h4>
<p>前面我们讲到设置M2_HOME环境变量指向Maven的安装目录，本书之后所有使用M2_HOME的地方都指代了该安装目录，让我们看一下该目录的结构和内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">conf</span><br><span class="line">lib</span><br><span class="line">LICENSE.txt</span><br><span class="line">NOTICE.txt</span><br><span class="line">README.txt</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>Bin</strong>：
该目录包含了mvn运行的脚本，这些脚本用来配置Java命令，准备好classpath和相关的Java系统属性，然后执行Java命令。其中mvn是基于UNIX平台的shell脚本，mvn.bat是基于Windows平台的bat脚本。在命令行输入任何一条mvn命令时，实际上就是在调用这些脚本。该目录还包含了mvnDebug和mvnDebug.bat两个文件，同样，前者是UNIX平台的shell脚本，后者是windows的bat脚本。那么mvn和mvnDebug有什么区别和关系呢？打开文件我们就可以看到，两者基本是一样的，只是mvnDebug多了一条MAVEN_DEBUG_OPTS配置，作用就是在运行Maven时开启debug，以便调试Maven本身。此外，该目录还包含m2.conf文件，这是classworlds的配置文件，稍微会介绍classworlds。</p></li>
<li><p><strong>Boot</strong>： 该目录只包含一个文件，以maven
3.0为例，该文件为plexus-classworlds-2.2.3.jar。plexus-classworlds是一个类加载器框架，相对于默认的java类加载器，它提供了更丰富的语法以方便配置，Maven使用该框架加载自己的类库。更多关于classworlds的信息请参考http://classworlds.codehaus.org/。对于一般的Maven用户来说，不必关心该文件。</p></li>
<li><p><strong>Conf</strong>：
该目录包含了一个非常重要的文件settings.xml。直接修改该文件，就能在机器上全局地定制Maven的行为。一般情况下，我们更偏向于复制该文件至<sub>/.m2/目录下（这里</sub>表示用户目录），然后修改该文件，在用户范围定制Maven的行为。本书的后面将会多次提到该settings.xml，并逐步分析其中的各个元素。</p></li>
<li><p><strong>Lib</strong>：
该目录包含了所有Maven运行时需要的Java类库，Maven本身是分模块开发的，因此用户能看到诸如mavn-core-3.0.jar、maven-model-3.0.jar之类的文件，此外这里还包含一些Maven用到的第三方依赖如common-cli-1.2.jar、google-collection-1.0.jar等等。（对于Maven
2来说，该目录只包含一个如maven-2.2.1-uber.jar的文件原本各为独立JAR文件的Maven模块和第三方类库都被拆解后重新合并到了这个JAR文件中）。可以说，这个lib目录就是真正的Maven。关于该文件，还有一点值得一提的是，用户可以在这个目录中找到Maven内置的超级POM，这一点在8.5小节详细解释。其他：
LICENSE.txt记录了Maven使用的软件许可证Apache License Version 2.0；
NOTICE.txt记录了Maven包含的第三方软件；而README.txt则包含了Maven的简要介绍，包括安装需求及如何安装的简要指令等等。</p></li>
</ul>
<h4 id="m2">~/.m2</h4>
<p>在讲述该小节之前，我们先运行一条简单的命令：mvn
help:system。该命令会打印出所有的Java系统属性和环境变量，这些信息对我们日常的编程工作很有帮助。这里暂不解释help:system涉及的语法，运行这条命令的目的是为了让Maven执行一个真正的任务。我们可以从命令行输出看到Maven会下载maven-help-plugin，包括pom文件和jar文件。这些文件都被下载到了Maven本地仓库中。</p>
<p>现在打开用户目录，比如当前的用户目录是C:Xu，你可以在Vista和Windows7中找到类似的用户目录。如果是更早版本的Windows，该目录应该类似于C:and
SettingsXu。在基于Unix的系统上，直接输入cd
回车，就可以转到用户目录。为了方便，本书统一使用符号 ~
指代用户目录。</p>
<p>在用户目录下，我们可以发现.m2文件夹。默认情况下，该文件夹下放置了Maven本地仓库.m2/repository。所有的Maven构件（artifact）都被存储到该仓库中，以方便重用。我们可以到~/.m2/repository/org/apache/maven/plugins/maven-help-plugins/目录下找到刚才下载的maven-help-plugin的pom文件和jar文件。Maven根据一套规则来确定任何一个构件在仓库中的位置，这一点本书第6章将会详细阐述。由于Maven仓库是通过简单文件系统透明地展示给Maven用户的，有些时候可以绕过Maven直接查看或修改仓库文件，在遇到疑难问题时，这往往十分有用。</p>
<p>默认情况下，<sub>/.m2目录下除了repository仓库之外就没有其他目录和文件了，不过大多数Maven用户需要复制M2_HOME/conf/settings.xml文件到</sub>/.m2/settings.xml。这是一条最佳实践，我们将在本章最后一小节详细解释。</p>
<h3 id="设置http代理">设置HTTP代理</h3>
<p>有时候你所在的公司由于安全因素考虑，要求你使用通过安全认证的代理访问因特网。这种情况下，就需要为Maven配置HTTP代理，才能让它正常访问外部仓库，以下载所需要的资源。</p>
<p>首先确认自己无法直接访问公共的Maven中央仓库，直接运行命令ping
repo1.maven.org可以检查网络。如果真的需要代理，先检查一下代理服务器是否畅通，比如现在有一个IP地址为218.14.227.197，端口为3128的代理服务，我们可以运行telnet
218.14.227.197
3128来检测该地址的该端口是否畅通。如果得到出错信息，需要先获取正确的代理服务信息；如果telnet连接正确，则输入ctrl+]，然后q，回车，退出即可。</p>
<p>检查完毕之后，编辑~/.m2/settings.xml文件（如果没有该文件，则复制$M2_HOME/conf/settings.xml）。添加代理配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;settings&gt;</span><br><span class="line">…  </span><br><span class="line">&lt;proxies&gt;</span><br><span class="line">    &lt;proxy&gt;</span><br><span class="line">      &lt;id&gt;my-proxy&lt;/id&gt;</span><br><span class="line">      &lt;active&gt;true&lt;/active&gt;</span><br><span class="line">      &lt;protocol&gt;http&lt;/protocol&gt;</span><br><span class="line">      &lt;host&gt;218.14.227.197&lt;/host&gt;</span><br><span class="line">      &lt;port&gt;3128&lt;/port&gt;</span><br><span class="line">      &lt;!--</span><br><span class="line">      &lt;username&gt;***&lt;/username&gt;</span><br><span class="line">      &lt;password&gt;***&lt;/password&gt;</span><br><span class="line">      &lt;nonProxyHosts&gt;repository.mycom.com|*.google.com&lt;/nonProxyHosts&gt;</span><br><span class="line">      --&gt;</span><br><span class="line">    &lt;/proxy&gt;</span><br><span class="line">  &lt;/proxies&gt;</span><br><span class="line">  …</span><br><span class="line">&lt;/settings&gt;</span><br></pre></td></tr></table></figure>
<p>这段配置十分简单，proxies下可以有多个proxy元素，如果你声明了多个proxy元素，则默认情况下第一个被激活的proxy会生效。这里声明了一个id为my-proxy的代理，active的值为true表示激活该代理，protocol表示使用的代理协议，这里是http。当然，最重要的是指定正确的主机名（host元素）和端口（port元素）。上述XML配置中我注释掉了username、password、nonProxyHost几个元素，当你的代理服务需要认证时，就需要配置username和password。nonProxyHost元素用来指定哪些主机名不需要代理，可以使用
|
符号来分隔多个主机名。此外，该配置也支持通配符，如*.google.com表示所有以google.com结尾的域名访问都不要通过代理。</p>
<h3 id="安装m2eclipse">安装m2eclipse</h3>
<p>Eclipse是一款非常优秀的IDE。除了基本的语法标亮、代码补齐、XML编辑等基本功能外，最新版的Eclipse还能很好地支持重构，并且集成了JUnit、CVS、Mylyn等各种流行工具。可惜Eclipse默认没有集成对Maven的支持。幸运的是，由Maven之父Jason
Van
Zyl创立的Sonatype公司建立了m2eclipse项目，这是Eclipse下的一款十分强大的Maven插件，可以访问http://m2eclipse.sonatype.org/
了解更多该项目的信息。</p>
<p>本小节将先介绍如何安装m2eclipse插件，本书后续的章节会逐步介绍m2eclipse插件的使用。</p>
<p>现在我以Eclipse
3.6为例逐步讲解m2eclipse的安装。启动Eclipse之后，在菜单栏中选择Help，然后选择Install
New Software…，接着你会看到一个Install对话框，点击Work
with:字段边上的Add按钮，你会得到一个新的Add
Repository对话框，在Name字段中输入m2e，Location字段中输入http://m2eclipse.sonatype.org/sites/m2e，然后点击OK。Eclipse会下载m2eclipse安装站点上的资源信息。等待资源载入完成之后，我们再将其全部展开，就能看到下图所示的界面：</p>
<p><img data-src="https://wulc.me/imgs/1ae54751-ad82-3066-ba5a-e8818cfc504d.jpg" /></p>
<p>如图显示了m2eclipse的核心模块Maven Integration for Eclipse
(Required)，选择后点击Next
&gt;，Eclipse会自动计算模块间依赖，然后给出一个将被安装的模块列表，确认无误后，继续点击Next
&gt;，这时我们会看到许可证信息，m2eclipse使用的开源许可证是Eclipse
Public License v1.0，选择I accept the terms of the license
agreements，然后点击Finish，接着就耐心等待Eclipse下载安装这些模块，如下图所示：</p>
<p><img data-src="https://wulc.me/imgs/d36bea18-262e-35e3-8a44-e3bac9ba225b.jpg" /></p>
<p>除了核心组件之外，m2eclipse还提供了一组额外组件，主要是为了方便与其它工具如Subversion进行集成，这些组件的安装地址为http://m2eclipse.sonatype.org/sites/m2e-extras。使用前面类似的安装方法，我们可以看到如下图的组件列表：</p>
<p><img data-src="https://wulc.me/imgs/8c938c76-5859-33ea-aee2-b1f6e3a182ac.jpg" /></p>
<p>下面简单解释一下这些组件的用途：</p>
<p><strong>1.重要的</strong> Maven SCM handler for
Subclipse(Optional）：Subversion是非常流行的版本管理工具，该模块能够帮助我们直接从Subversion服务器签出Maven项目，不过前提是需要首先安装Subclipse（http://subclipse.tigris.org/）。
Maven SCM Integration
(Optional）：Eclipse环境中Maven与SCM集成核心的模块，它利用各种SCM工具如SVN实现Maven项目的签出和具体化等操作。</p>
<p><strong>2. 不重要的</strong> Maven issue tracking configurator for
Mylyn 3.x
(Optional）：该模块能够帮助我们使用POM中的缺陷跟踪系统信息连接Mylyn至服务器。
Maven SCM handler for Team/CVS
(Optional）：该模块帮助我们从CVS服务器签出Maven项目，如果你还在使用CVS，就需要安装它。
Maven Integration for WTP
(Optional）：使用该模块可以让Eclipse自动读取POM信息并配置WTP项目。、
M2eclipse Extensions Development Support
(Optional)：用来支持扩展m2eclipse，一般用户不会用到。 Project
configurators for commonly used maven plugins
(temporary)：一个临时的组件，用来支持一些Maven插件与Eclipse的集成，建议安装。
读者可以根据自己的需要安装相应组件，具体步骤不再赘述。</p>
<p>待安装完毕后，重启Eclipse，现在让我们验证一下m2eclipse是否正确安装了。首先，点击菜单栏中的Help，然后选择About
Eclipse，在弹出的对话框中，点击Installation
Details按钮，会得到一个对话框，在Installed
Software标签栏中，检查刚才我们选择的模块是否在这个列表中 <img data-src="https://wulc.me/imgs/c6793b02-251d-3e1f-833c-8ff12d14ba05.jpg" />
如果一切没问题，我们再检查一下Eclipse现在是否已经支持创建Maven项目，依次点击菜单栏中的File→New→Other，在弹出的对话框中，找到Maven一项，再将其展开，你应该能够看到如下所示的对话框：</p>
<p><img data-src="https://wulc.me/imgs/897a084a-6965-3d4a-b437-36c3a4ea5c09.jpg" /></p>
<p>如果一切正常，说明m2eclipse已经正确安装了。</p>
<p>最后，关于m2eclipse的安装，需要提醒的一点是，你可能会在使用m2eclipse时遇到类似这样的错误：</p>
<p>09-10-6 上午01时14分49秒: Eclipse is running in a JRE, but a JDK is
required Some Maven plugins may not work when importing projects or
updating source folders.</p>
<p>这是因为<strong>Eclipse默认是运行在JRE上的，而m2eclipse的一些功能要求使用JDK</strong>，解决方法是配置Eclipse安装目录的eclipse.ini文件，添加vm配置指向JDK，如：</p>
<pre><code>--launcher.XXMaxPermSize
256m
-vm
D:\java\jdk1.6.0_07\bin\javaw.exe
-vmargs
-Dosgi.requiredJavaVersion=1.5
-Xms128m
-Xmx256m</code></pre>
<h3 id="maven安装最佳实践">Maven安装最佳实践</h3>
<p>本节介绍一些在安装Maven过程中不是必须的，但十分有用的实践。</p>
<h4 id="设置maven_opts环境变量">设置MAVEN_OPTS环境变量</h4>
<p>本章前面介绍Maven安装目录时我们了解到，<strong>运行mvn命令实际上是执行了Java命令，既然是运行Java，那么运行Java命令可用的参数当然也应该在运行mvn命令时可用</strong>。这个时候，MAVEN_OPTS环境变量就能派上用场。</p>
<p>我们通常需要设置MAVEN_OPTS的值为：-Xms128m
-Xmx512m，因为<strong>Java默认的最大可用内存往往不能够满足Maven运行的需要，比如在项目较大时，使用Maven生成项目站点需要占用大量的内存，如果没有该配置，我们很容易得到java.lang.OutOfMemeoryError。</strong>因此，一开始就配置该变量是推荐的做法。</p>
<p>关于如何设置环境变量，请参考前面设置M2_HOME环境变量的做法，尽量不要直接修改mvn.bat或者mvn这两个Maven执行脚本文件。因为如果修改了脚本文件，升级Maven时你就不得不再次修改，一来麻烦，二来容易忘记。同理，我们应该尽可能地不去修改任何Maven安装目录下的文件。</p>
<h4 id="配置用户范围settings.xml">配置用户范围settings.xml</h4>
<p><strong>Maven用户可以选择配置$M2_HOME/conf/settings.xml或者~/.m2/settings.xml。前者是全局范围的，整台机器上的所有用户都会直接受到该配置的影响，而后者是用户范围的，只有当前用户才会受到该配置的影响。</strong></p>
<p>我们推荐使用用户范围的settings.xml，主要原因是为了避免无意识地影响到系统中的其他用户。当然，如果你有切实的需求，需要统一系统中所有用户的settings.xml配置，当然应该使用全局范围的settings.xml。</p>
<p>除了影响范围这一因素，配置用户范围settings.xml文件还便于Maven升级。直接修改conf目录下的settings.xml会导致Maven升级不便，每次升级到新版本的Maven，都需要复制settings.xml文件，如果使用~/.m2目录下的settings.xml，就不会影响到Maven安装文件，升级时就不需要触动settings.xml文件。</p>
<h4 id="不要使用ide内嵌的maven">不要使用IDE内嵌的Maven</h4>
<p>无论是Eclipse还是NetBeans，当我们集成Maven时，都会安装上一个内嵌的Maven，这个内嵌的Maven通常会比较新，但不一定很稳定，而且往往也会和我们在命令行使用的Maven不是同一个版本。这里有会出现两个潜在的问题：首先，较新版本的Maven存在很多不稳定因素，容易造成一些难以理解的问题；其次，除了IDE，我们也经常还会使用命令行的Maven，如果版本不一致，容易造成构建行为的不一致，这是我们所不希望看到的。因此，我们应该在IDE中配置Maven插件时使用与命令行一致的Maven。</p>
<p>在m2eclipse环境中，点击菜单栏中的Windows，然后选择Preferences，在弹出的对话框中，展开左边的Maven项，选择Installation子项，在右边的面板中，我们能够看到有一个默认的Embedded
Maven安装被选中了，点击Add…然后选择我们的Maven安装目录M2_HOME，添加完毕之后选择这一个外部的Maven，如下图所示：
<img data-src="https://wulc.me/imgs/93cb4cf7-4027-397d-9e42-185acb6fc868.jpg" />
### 小结</p>
<p>本章详细介绍了在各种操作系统平台上安装Maven，并对Maven安装目录进行了深入的分析，在命令行的基础上，本章又进一步介绍了Maven与主流IDE
Eclipse及NetBeans的集成，本章最后还介绍了一些与Maven安装相关的最佳实践。本书下一章会创建一个Hello
World项目，带领读者配置和构建Maven项目。</p>
<h2 id="maven使用入门">Maven使用入门</h2>
<p>到目前为止，我们已经大概了解并安装好了Maven，现在，我们开始
创建一个最简单的Hello
World项目。如果你是初次接触Maven，我建议你按照本章的内容一步步地编写代码并执行，可能你会碰到一些概念暂时难以理解，不用着急，记下这些疑
难点，相信本书的后续章节会帮你逐一解答。</p>
<p><strong>就像Make的Makefile，Ant的build.xml一样，Maven项目的核心是pom.xml。POM（Project
Object
Model，项目对象模型）定义了项目的基本信息，用于描述项目如何构建，声明项目依赖，等等。</strong></p>
<h3 id="编写pom.xml文件">编写pom.xml文件</h3>
<p>现在我们先为Hello World项目编写一个最简单的pom.xml。</p>
<p>首先创建一个名为hello-world的文件夹（本书中各章的代码都会对应一个以ch开头的项目），打开该文件夹，新建一个名为pom.xml的文件，输入其内容如代码清单3-1：</p>
<p>代码清单3-1：Hello World的POM</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span>  </span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>  </span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0  </span></span></span><br><span class="line"><span class="string"><span class="tag">http://maven.apache.org/maven-v4_0_0.xsd&quot;</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.juvenxu.mvnbook<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hello-world<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>Maven Hello World Project<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span>   </span><br></pre></td></tr></table></figure>
<p>代码的第一行是XML头，指定了该xml文档的版本和编码方式。紧接着是project元素，<strong>project是所有pom.xml的根元素</strong>，它还声明了一些POM相关的命名空间及xsd元素，虽然这些属性不是必须的，但使用这些属性能够让第三方工具（如IDE中的XML编辑器）帮助我们快速编辑POM。</p>
<p>根元素下的第一个子元素modelVersion指定了当前POM模型的版本，对于Maven2及Maven
3来说，它只能是4.0.0。</p>
<p>这段代码中<strong>最重要的是groupId，artifactId和version三行。这三个元素定义了一个项目基本的坐标，在Maven的世界，任何的jar、pom或者war都是以基于这些基本的坐标进行区分的。</strong></p>
<ul>
<li><p><strong>groupId定义了项目属于哪个组，这个组往往和项目所在的组织或公司存在关联</strong>，譬如你在googlecode上建立了一个名为myapp的项目，那么groupId就应该是com.googlecode.myapp，如果你的公司是mycom，有一个项目为myapp，那么groupId就应该是com.mycom.myapp。本书中所有的代码都基于groupId
com.juvenxu.mvnbook。</p></li>
<li><p><strong>artifactId定义了当前Maven项目在组中唯一的ID</strong>，我们为这个Hello
World项目定义artifactId为hello-world，本书其他章节代码会被分配其他的artifactId。而在前面的groupId为com.googlecode.myapp的例子中，你可能会为不同的子项目（模块）分配artifactId，如：myapp-util、myapp-domain、myapp-web等等。</p></li>
<li><p><strong>version指定了Hello
World项目当前的版本——1.0-SNAPSHOT</strong>。<em>SNAPSHOT意为快照，说明该项目还处于开发中，是不稳定的版本</em>。随着项目的发展，version会不断更新，如升级为1.0、1.1-SNAPSHOT、1.1、2.0等等。本书的6.5小节会详细介绍SNAPSHOT，第13章介绍如何使用Maven管理项目版本的升级发布。</p></li>
</ul>
<p>最后一个name元素声明了一个对于用户更为友好的项目名称，虽然这不是必须的，但我还是推荐为每个POM声明name，以方便信息交流。</p>
<p><strong>没有任何实际的Java代码，我们就能够定义一个Maven项目的POM，这体现了Maven的一大优点</strong>，它能让项目对象模型最大程度地与实际代码相独立，我们可以称之为解耦，或者正交性，这在很大程度上避免了Java代码和POM代码的相互影响。比如当项目需要升级版本时，只需要修改POM，而不需要更改Java代码；而在POM稳定之后，日常的Java代码开发工作基本不涉及POM的修改。</p>
<h3 id="编写主代码">编写主代码</h3>
<p><strong>项目主代码和测试代码不同，项目的主代码会被打包到最终的构件中（比如jar），而测试代码只在运行测试时用到，不会被打包。</strong>默认情况下，Maven假设项目主代码位于src/main/java目录，我们遵循Maven的约定，创建该目录，然后在该目录下创建文件com/juvenxu/mvnbook/helloworld/HelloWorld.java，其内容如代码清单3-2：</p>
<p>代码清单3-2：Hello World的主代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.juvenxu.mvnbook.helloworld;  </span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span>  </span><br><span class="line">&#123;  </span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">()</span>  </span><br><span class="line">   &#123;  </span><br><span class="line">     <span class="keyword">return</span> <span class="string">&quot;Hello Maven&quot;</span>;  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">  &#123;</span><br><span class="line">  System.out.print( <span class="keyword">new</span> <span class="title class_">HelloWorld</span>().sayHello());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p>这是一个简单的Java类，它有一个sayHello()方法，返回一个String。同时这个类还带有一个main方法，创建一个HelloWorld实例，调用sayHello()方法，并将结果输出到控制台。</p>
<p>关于该Java代码有两点需要注意。首先，在95%以上的情况下，我们<strong>应该把项目主代码放到src/main/java/目录下（遵循Maven的约定），而无须额外的配置，Maven会自动搜寻该目录找到项目主代码。</strong>其次，该Java类的包名是com.juvenxu.mvnbook.helloworld，这与我们之前在POM中定义的groupId和artifactId相吻合。<strong>一般来说，项目中Java类的包都应该基于项目的groupId和artifactId，这样更加清晰，更加符合逻辑，也方便搜索构件或者Java类。</strong></p>
<p>代码编写完毕后，我们使用Maven进行编译，在项目根目录下运行命令
<code>mvn clean compile</code>，我们会得到如下输出：</p>
<pre><code>[INFO] Scanning for projects...  
[INFO] ------------------------------------------------------------------------  
[INFO] Building Maven Hello World Project  
[INFO]    task-segment: [clean, compile]  
[INFO] ------------------------------------------------------------------------  
[INFO] [clean:clean &#123;execution: default-clean&#125;]  
[INFO] Deleting directory D:\code\hello-world\target  
[INFO] [resources:resources &#123;execution: default-resources&#125;]  
[INFO] skip non existing resourceDirectory D: \code\hello-world\src\main\resources  
[INFO] [compiler:compile &#123;execution: default-compile&#125;]  
[INFO] Compiling 1 source file to D: \code\hello-world\target\classes  
[INFO] ------------------------------------------------------------------------  
[INFO] BUILD SUCCESSFUL  
[INFO] ------------------------------------------------------------------------  
[INFO] Total time: 1 second  
[INFO] Finished at: Fri Oct 09 02:08:09 CST 2009  
[INFO] Final Memory: 9M/16M  
[INFO] ------------------------------------------------------------------------  </code></pre>
<p>clean告诉Maven清理输出目录target，compile告诉Maven编译项目主代码，从输出中我们看到Maven首先执行了clean:clean任务，删除target/目录，<strong>默认情况下Maven构建的所有输出都在target/目录中</strong>；接着执行resources:resources任务（未定义项目资源，暂且略过）；最后执行compiler:compile任务，将项目主代码编译至target/classes目录(编译好的类为com/juvenxu/mvnbook/helloworld/HelloWorld.Class）。</p>
<p>上文提到的clean:clean、resources:resources，以及compiler:compile对应了一些Maven插件及插件目标，比如clean:clean是clean插件的clean目标，compiler:compile是compiler插件的compile目标，后文会详细讲述Maven插件及其编写方法。</p>
<p>至此，Maven在没有任何额外的配置的情况下就执行了项目的清理和编译任务，接下来，我们编写一些单元测试代码并让Maven执行自动化测试。</p>
<h3 id="编写测试代码">编写测试代码</h3>
<p>为了使项目结构保持清晰，主代码与测试代码应该分别位于独立的目录中。3.2节讲过Maven项目中默认的主代码目录是src/main/java，对应地，Maven项目中默认的测试代码目录是src/test/java。因此，在编写测试用例之前，我们先创建该目录。</p>
<p>在Java世界中，由Kent Beck和Erich
Gamma建立的<strong>JUnit是事实上的单元测试标准。要使用JUnit，我们首先需要为Hello
World项目添加一个JUnit依赖</strong>，修改项目的POM如代码清单3-3：</p>
<p>代码清单3-3：为Hello World的POM添加依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;  </span><br><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;  </span><br><span class="line">         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;  </span><br><span class="line">         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0  </span><br><span class="line">http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;  </span><br><span class="line">  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;  </span><br><span class="line">  &lt;groupId&gt;com.juvenxu.mvnbook&lt;/groupId&gt;  </span><br><span class="line">  &lt;artifactId&gt;hello-world&lt;/artifactId&gt;  </span><br><span class="line">  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;  </span><br><span class="line">  &lt;name&gt;Maven Hello World Project&lt;/name&gt;  </span><br><span class="line">  &lt;dependencies&gt;  </span><br><span class="line">    &lt;dependency&gt;  </span><br><span class="line">       &lt;groupId&gt;junit&lt;/groupId&gt;  </span><br><span class="line">       &lt;artifactId&gt;junit&lt;/artifactId&gt;  </span><br><span class="line">       &lt;version&gt;4.7&lt;/version&gt;  </span><br><span class="line">       &lt;scope&gt;test&lt;/scope&gt;  </span><br><span class="line">    &lt;/dependency&gt;  </span><br><span class="line">  &lt;/dependencies&gt;  </span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
<p>代码中添加了dependencies元素，该元素下可以包含多个dependency元素以声明项目的依赖，这里我们添加了一个依赖——groupId是junit，artifactId是junit，version是4.7。前面我们提到groupId、artifactId和version是任何一个Maven项目最基本的坐标，JUnit也不例外，有了这段声明，Maven就能够自动下载junit-4.7.jar。也许你会问，Maven从哪里下载这个jar呢？<strong>在Maven之前，我们可以去JUnit的官网下载分发包。而现在有了Maven，它会自动访问中央仓库（http://repo1.maven.org/maven2/），下载需要的文件。</strong>读者也可以自己访问该仓库，打开路径junit/junit/4.7/，就能看到junit-4.7.pom和junit-4.7.jar。本书第6章会详细介绍Maven仓库及中央仓库。</p>
<p>上述POM代码中还有一个值为test的元素scope，scope为依赖范围，若依赖范围为test则表示该依赖只对测试有效，换句话说，测试代码中的import
JUnit代码是没有问题的，但是如果我们在主代码中用import
JUnit代码，就会造成编译错误。如果不声明依赖范围，那么默认值就是compile，表示该依赖对主代码和测试代码都有效。</p>
<p>配置了测试依赖，接着就可以编写测试类，回顾一下前面的HelloWorld类，现在我们要测试该类的sayHello()方法，检查其返回值是否为“Hello
Maven”。在src/test/java目录下创建文件，其内容如代码清单3-4：</p>
<p>代码清单3-4：Hello World的测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.juvenxu.mvnbook.helloworld;  </span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.assertEquals;  </span><br><span class="line"><span class="keyword">import</span> org.junit.Test;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorldTest</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="meta">@Test</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSayHello</span><span class="params">()</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="type">HelloWorld</span> <span class="variable">helloWorld</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HelloWorld</span>();  </span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> helloWorld.sayHello();  </span><br><span class="line">        assertEquals( <span class="string">&quot;Hello Maven&quot;</span>, result );  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p><strong>一个典型的单元测试包含三个步骤： 1.准备测试类及数据；
2.执行要测试的行为； 3.检查结果。</strong></p>
<p>上述样例中，我们首先初始化了一个要测试的HelloWorld实例，接着执行该实例的sayHello()方法并保存结果到result变量中，最后使用JUnit框架的Assert类检查结果是否为我们期望的”Hello
Maven”。在JUnit
3中，约定所有需要执行测试的方法都以test开头，这里我们使用了JUnit
4，但我们仍然遵循这一约定，在JUnit
4中，需要执行的测试方法都应该以@Test进行标注。</p>
<p>测试用例编写完毕之后就可以调用Maven执行测试，运行
<code>mvn clean test</code> ：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[INFO] Scanning for projects...  </span><br><span class="line">[INFO] ------------------------------------------------------------------------  </span><br><span class="line">[INFO] Building Maven Hello World Project  </span><br><span class="line">[INFO]    task-segment: [clean, test]  </span><br><span class="line">[INFO] ------------------------------------------------------------------------  </span><br><span class="line">[INFO] [clean:clean &#123;execution: default-clean&#125;]  </span><br><span class="line">[INFO] Deleting directory D:\git-juven\mvnbook\code\hello-world\target  </span><br><span class="line">[INFO] [resources:resources &#123;execution: default-resources&#125;]  </span><br><span class="line">…  </span><br><span class="line">Downloading: http://repo1.maven.org/maven2/junit/junit/4.7/junit-4.7.pom  </span><br><span class="line">1K downloaded  (junit-4.7.pom)  </span><br><span class="line">[INFO] [compiler:compile &#123;execution: default-compile&#125;]  </span><br><span class="line">[INFO] Compiling 1 source file to D: \code\hello-world\target\classes  </span><br><span class="line">[INFO] [resources:testResources &#123;execution: default-testResources&#125;]  </span><br><span class="line">…  </span><br><span class="line">Downloading: http://repo1.maven.org/maven2/junit/junit/4.7/junit-4.7.jar  </span><br><span class="line">226K downloaded  (junit-4.7.jar)  </span><br><span class="line">[INFO] [compiler:testCompile &#123;execution: default-testCompile&#125;]  </span><br><span class="line">[INFO] Compiling 1 source file to D:\ code\hello-world\target\test-classes  </span><br><span class="line">[INFO] ------------------------------------------------------------------------  </span><br><span class="line">[ERROR] BUILD FAILURE  </span><br><span class="line">[INFO] ------------------------------------------------------------------------  </span><br><span class="line">[INFO] Compilation failure  </span><br><span class="line">D:\code\hello-world\src\test\java\com\juvenxu\mvnbook\helloworld\HelloWorldTest.java:[8,5] -source 1.3 中不支持注释  </span><br><span class="line">（请使用 -source 5 或更高版本以启用注释）  </span><br><span class="line">    @Test  </span><br><span class="line">[INFO] ------------------------------------------------------------------------  </span><br><span class="line">[INFO] For more information, run Maven with the -e switch  </span><br><span class="line">  …  </span><br></pre></td></tr></table></figure>
<p>不幸的是构建失败了，不过我们先耐心分析一下这段输出（为了本书的简洁，一些不重要的信息我用省略号略去了）。命令行输入的是mvn
clean
test，而Maven实际执行的可不止这两个任务，还有clean:clean、resources:resources、compiler:compile、resources:testResources以及compiler:testCompile。暂时我们需要了解的是，在Maven执行测试（test）之前，它会先自动执行项目主资源处理，主代码编译，测试资源处理，测试代码编译等工作，这是Maven生命周期的一个特性，本书后续章节会详细解释Maven的生命周期。</p>
<p>从输出中我们还看到：Maven从中央仓库下载了junit-4.7.pom和junit-4.7.jar这两个文件到本地仓库（~/.m2/repository）中，供所有Maven项目使用。</p>
<p>构建在执行compiler:testCompile任务的时候失败了，Maven输出提示我们需要使用-source
5或更高版本以启动注释，也就是前面提到的JUnit
4的@Test注解。这是Maven初学者常常会遇到的一个问题。<strong>由于历史原因，Maven的核心插件之一compiler插件默认只支持编译Java
1.3，因此我们需要配置该插件使其支持Java 5</strong>，见代码清单3-5：</p>
<p>代码清单3-5：配置maven-compiler-plugin支持Java 5</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;project&gt;  </span><br><span class="line">…  </span><br><span class="line">  &lt;build&gt;  </span><br><span class="line">    &lt;plugins&gt;  </span><br><span class="line">       &lt;plugin&gt;  </span><br><span class="line">         &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;  </span><br><span class="line">         &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;  </span><br><span class="line">         &lt;configuration&gt;  </span><br><span class="line">           &lt;source&gt;1.5&lt;/source&gt;  </span><br><span class="line">           &lt;target&gt;1.5&lt;/target&gt;  </span><br><span class="line">         &lt;/configuration&gt;  </span><br><span class="line">       &lt;/plugin&gt;  </span><br><span class="line">    &lt;/plugins&gt;  </span><br><span class="line">  &lt;/build&gt;  </span><br><span class="line">…  </span><br><span class="line">&lt;/project&gt;  </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>该POM省略了除插件配置以外的其他部分，我们暂且不去关心插件配置的细节，只需要知道compiler插件支持Java
5的编译。现在再执行mvn clean test，输出如下：</p>
<pre><code>[INFO] Compiling 1 source file to D: \code\hello-world\target\test-classes  
[INFO] [surefire:test &#123;execution: default-test&#125;]  
[INFO] Surefire report directory: D:\code\hello-world\target\surefire-reports  
 
 T E S T S  
 
Running com.juvenxu.mvnbook.helloworld.HelloWorldTest  
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.055 sec  
Results :  
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0  
[INFO] 
[INFO] BUILD SUCCESSFUL  
[INFO] </code></pre>
<p>我们看到compiler:testCompile任务执行成功了，测试代码通过编译之后在target/test-classes下生成了二进制文件，紧接着surefire:test任务运行测试，surefire是Maven世界中负责执行测试的插件，这里它运行测试用例HelloWorldTest，并且输出测试报告，显示一共运行了多少测试，失败了多少，出错了多少，跳过了多少。显然，我们的测试通过了——BUILD
SUCCESSFUL。</p>
<h3 id="打包和运行">打包和运行</h3>
<p>将项目进行编译、测试之后，下一个重要步骤就是打包（package）。Hello
World的POM中没有指定打包类型，使用默认打包类型jar，我们可以简单地执行命令
<code>mvn clean package</code> 进行打包，可以看到如下输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">…  </span><br><span class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0  </span><br><span class="line">  </span><br><span class="line">[INFO] [jar:jar &#123;execution: default-jar&#125;]  </span><br><span class="line">[INFO] Building jar: D:\code\hello-world\target\hello-world-1.0-SNAPSHOT.jar  </span><br><span class="line">[INFO]   </span><br><span class="line"></span><br><span class="line">[INFO] BUILD SUCCESSFUL  </span><br><span class="line">…  </span><br></pre></td></tr></table></figure>
<p>类似地，Maven会在打包之前执行编译、测试等操作。这里我们看到jar:jar任务负责打包，实际上就是jar插件的jar目标将项目主代码打包成一个名为hello-world-1.0-SNAPSHOT.jar的文件，<strong>该文件也位于target/输出目录中，它是根据artifact-version.jar规则进行命名的</strong>，如有需要，我们还可以使用finalName来自定义该文件的名称，这里暂且不展开，本书后面会详细解释。</p>
<p>至此，我们得到了项目的输出，如果有需要的话，就可以复制这个jar文件到其他项目的Classpath中从而使用HelloWorld类。但是，<strong>如何才能让其他的Maven项目直接引用这个jar呢？</strong>我们还需要一个安装的步骤，执行
<code>mvn clean install</code>：</p>
<p>[INFO] [jar:jar {execution: default-jar}]<br />
[INFO] Building jar: D: -world-world-1.0-SNAPSHOT.jar<br />
[INFO] [install:install {execution: default-install}]<br />
[INFO] Installing D:-world-world-1.0-SNAPSHOT.jar to
C:.m2-world\1.0-SNAPSHOT-world-1.0-SNAPSHOT.jar<br />
[INFO]</p>
<p>[INFO] BUILD SUCCESSFUL</p>
<p>在打包之后，我们又执行了安装任务install:install，从输出我们看到该任务将项目输出的jar安装到了Maven本地仓库中，我们可以打开相应的文件夹看到Hello
World项目的pom和jar。之前讲述JUnit的POM及jar的下载的时候，我们说只有构件被下载到本地仓库后，才能由所有Maven项目使用，这里是同样的道理，只有将Hello
World的构件安装到本地仓库之后，其他Maven项目才能使用它。</p>
<p>我们已经将体验了Maven最主要的命令：<code>mvn clean compile</code>、<code>mvn clean test</code>、<code>mvn clean package</code>、<code>mvn clean install</code>。<strong>执行test之前是会先执行compile的，执行package之前是会先执行test的，而类似地，install之前会执行package</strong>。我们可以在任何一个Maven项目中执行这些命令，而且我们已经清楚它们是用来做什么的。</p>
<p>到目前为止，我们还没有运行Hello
World项目，不要忘了HelloWorld类可是有一个main方法的。默认打包生成的jar是不能够直接运行的，因为带有main方法的类信息不会添加到manifest中(我们可以打开jar文件中的META-INF/MANIFEST.MF文件，将无法看到Main-Class一行)。为了生成可执行的jar文件，我们需要借助maven-shade-plugin，配置该插件如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;  </span><br><span class="line">&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;  </span><br><span class="line">  &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;  </span><br><span class="line">  &lt;version&gt;1.2.1&lt;/version&gt;  </span><br><span class="line">  &lt;executions&gt;  </span><br><span class="line">    &lt;execution&gt;  </span><br><span class="line">      &lt;phase&gt;package&lt;/phase&gt;  </span><br><span class="line">      &lt;goals&gt;  </span><br><span class="line">        &lt;goal&gt;shade&lt;/goal&gt;  </span><br><span class="line">      &lt;/goals&gt;  </span><br><span class="line">      &lt;configuration&gt;  </span><br><span class="line">        &lt;transformers&gt;  </span><br><span class="line">          &lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&gt;            &lt;mainClass&gt;com.juvenxu.mvnbook.helloworld.HelloWorld&lt;/mainClass&gt;  </span><br><span class="line">         &lt;/transformer&gt;  </span><br><span class="line">       &lt;/transformers&gt;  </span><br><span class="line">     &lt;/configuration&gt;  </span><br><span class="line">     &lt;/execution&gt;  </span><br><span class="line">  &lt;/executions&gt;  </span><br><span class="line">&lt;/plugin&gt;  </span><br></pre></td></tr></table></figure>
<p>plugin元素在POM中的相对位置应该在<code>&lt;project&gt;&lt;build&gt;&lt;plugins&gt;</code>下面。我们配置了mainClass为com.juvenxu.mvnbook.helloworld.HelloWorld，项目在打包时会将该信息放到MANIFEST中。现在执行
mvn clean install
，待构建完成之后打开target/目录，我们可以看到hello-world-1.0-SNAPSHOT.jar和original-hello-world-1.0-SNAPSHOT.jar，前者是带有Main-Class信息的可运行jar，后者是原始的jar，打开hello-world-1.0-SNAPSHOT.jar的META-INF/MANIFEST.MF，可以看到它包含这样一行信息：</p>
<pre><code>Main-Class: com.juvenxu.mvnbook.helloworld.HelloWorld</code></pre>
<p>现在，我们在项目根目录中执行该jar文件：</p>
<pre><code>D: \code\hello-world&gt;java -jar target\hello-world-1.0-SNAPSHOT.jar
Hello Maven</code></pre>
<p>控制台输出为 Hello Maven，这正是我们所期望的。</p>
<p>本小节介绍了Hello
World项目，侧重点是Maven而非Java代码本身，介绍了POM、Maven项目结构、以及如何编译、测试、打包，等等。</p>
<h3 id="使用archetype生成项目骨架">使用Archetype生成项目骨架</h3>
<p>Hello
World项目中有一些Maven的约定：在项目的根目录中放置pom.xml，在src/main/java目录中放置项目的主代码，在src/test/java中放置项目的测试代码。我之所以一步一步地展示这些步骤，是为了能让可能是Maven初学者的你得到最实际的感受。我们称这些基本的目录结构和pom.xml文件内容称为项目的骨架，当你第一次创建项目骨架的时候，你还会饶有兴趣地去体会这些默认约定背后的思想，第二次，第三次，你也许还会满意自己的熟练程度，但第四、第五次做同样的事情，就会让程序员恼火了，为此<strong>Maven提供了Archetype以帮助我们快速勾勒出项目骨架。</strong></p>
<p>还是以Hello World为例，我们使用maven
archetype来创建该项目的骨架，离开当前的Maven项目目录。 如果是Maven
3，简单的运行：</p>
<pre><code>mvn archetype:generate</code></pre>
<p>如果是Maven 2，最好运行如下命令：</p>
<pre><code>mvn org.apache.maven.plugins:maven-archetype-plugin:2.0-alpha-5:generate</code></pre>
<p>很多资料会让你直接使用更为简单的 mvn archetype:generate
命令，但在Maven2中这是不安全的，因为该命令没有指定archetype插件的版本，于是Maven会自动去下载最新的版本，进而可能得到不稳定的SNAPSHOT版本，导致运行失败。然而在Maven
3中，即使用户没有指定版本，Maven也只会解析最新的稳定版本，因此这是安全的，具体内容见7.7小节。</p>
<p>我们实际上是在运行插件<strong>maven-archetype-plugin</strong>，注意冒号的分隔，其格式为
groupId:artifactId:version:goal ，org.apache.maven.plugins
是maven官方插件的groupId，maven-archetype-plugin
是archetype插件的artifactId，2.0-alpha-5
是目前该插件最新的稳定版，generate是我们要使用的插件目标。</p>
<p>紧接着我们会看到一段长长的输出，有很多可用的archetype供我们选择，包括著名的Appfuse项目的archetype，JPA项目的archetype等等。每一个archetype前面都会对应有一个编号，同时命令行会提示一个默认的编号，其对应的archetype为maven-archetype-quickstart，我们直接回车以选择该archetype，紧接着Maven会提示我们输入要创建项目的groupId、artifactId、
version、以及包名package，如下输入并确认：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Define value for groupId: : com.juvenxu.mvnbook  </span><br><span class="line">Define value for artifactId: : hello-world  </span><br><span class="line">Define value for version:  1.0-SNAPSHOT: :  </span><br><span class="line">Define value for package:  com.juvenxu.mvnbook: : com.juvenxu.mvnbook.helloworld  </span><br><span class="line">Confirm properties configuration:  </span><br><span class="line">groupId: com.juvenxu.mvnbook  </span><br><span class="line">artifactId: hello-world  </span><br><span class="line">version: 1.0-SNAPSHOT  </span><br><span class="line">package: com.juvenxu.mvnbook.helloworld  </span><br><span class="line"> Y: : Y  </span><br></pre></td></tr></table></figure>
<p>Archetype插件将根据我们提供的信息创建项目骨架。在当前目录下，Archetype插件会创建一个名为hello-world（我们定义的artifactId）的子目录，从中可以看到项目的基本结构：基本的pom.xml已经被创建，里面包含了必要的信息以及一个junit依赖；主代码目录src/main/java已经被创建，在该目录下还有一个Java类com.juvenxu.mvnbook.helloworld.App，注意这里使用到了我们刚才定义的包名，而这个类也仅仅只有一个简单的输出Hello
World!的main方法；测试代码目录src/test/java也被创建好了，并且包含了一个测试用例com.juvenxu.mvnbook.helloworld.AppTest。</p>
<p>Archetype可以帮助我们迅速地构建起项目的骨架，在前面的例子中，我们完全可以在Archetype生成的骨架的基础上开发Hello
World项目以节省我们大量时间。</p>
<p>此外，我们这里仅仅是看到了一个最简单的archetype，如果你有很多项目拥有类似的自定义项目结构以及配置文件，你完全可以一劳永逸地开发自己的archetype，然后在这些项目中使用自定义的archetype来快速生成项目骨架，本书后面的章节会详细阐述如何开发Maven
Archetype。</p>
<h3 id="m2eclipse简单使用">m2eclipse简单使用</h3>
<p>介绍前面Hello
World项目的时候，我们并没有涉及IDE，如此简单的一个项目，使用最简单的编辑器也能很快完成，但对于稍微大一些的项目来说，没有IDE就是不可想象的，本节我们先介绍m2eclipse的基本使用。</p>
<h4 id="导入maven项目">导入Maven项目</h4>
<p>第2章介绍了如何安装m2eclipse，现在，我们使用m2ecilpse导入Hello
World项目。选择菜单项File，然后选择Import，我们会看到一个Import对话框，在该对话框中选择General目录下的Maven
Projects，然后点击Next，就会出现Import
Projects对话框，在该对话框中点击Browse…选择Hello
World的根目录（即包含pom.xml文件的那个目录），这时对话框中的Projects:部分就会显示该目录包含的Maven项目，如下图所示：
<img data-src="https://wulc.me/imgs/9a71aa9f-dc5e-32e1-8d0e-f71de55de5e9.jpg" /></p>
<p>点击Finish之后，m2ecilpse就会将该项目导入到当前的workspace中，导入完成之后，我们就可以在Package
Explorer视图中看到如下图的项目结构：</p>
<p><img data-src="https://wulc.me/imgs/dc2c1bfc-ce95-3395-a5d7-16bdf5894101.jpg" /></p>
<p>我们看到主代码目录src/main/java和测试代码目录src/test/java成了Eclipse中的资源目录，包和类的结构也十分清晰，当然pom.xml永远在项目的根目录下，而从这个视图中我们甚至还能看到项目的依赖junit-4.7.jar，其实际的位置指向了Maven本地仓库（这里我自定义了Maven本地仓库地址为D:，后续章节会介绍如何自定义本地仓库位置）。</p>
<h4 id="创建maven项目">创建Maven项目</h4>
<p>创建一个Maven项目也十分简单，选择菜单项File -&gt; New -&gt;
Other，在弹出的对话框中选择Maven下的Maven Project，然后点击Next
&gt;，在弹出的New Maven
Project对话框中，我们使用默认的选项（不要选择Create a simple
project选项，那样我们就能使用Maven Archetype），点击Next
&gt;，此时m2eclipse会提示我们选择一个Archetype，我们选择maven-archetype-quickstart，再点击Next
&gt;。由于m2eclipse实际上是在使用maven-archetype-plugin插件创建项目，因此这个步骤与上一节我们使用archetype创建项目骨架类似，输入groupId,、artifactId、version、package（暂时我们不考虑Properties），如下图所示：
<img data-src="https://wulc.me/imgs/bb255ca9-2341-37fb-aa9c-de619c2bf80a.jpg" />
注意，为了不和前面已导入的Hello
World项目产生冲突和混淆，我们使用不同的artifactId和package。OK，点击Finish，Maven项目就创建完成了，其结构与前一个已导入的Hello
World项目基本一致。</p>
<h4 id="运行mvn命令">运行mvn命令</h4>
<p>我们需要在命令行输入如mvn clean
install之类的命令来执行maven构建，m2eclipse中也有对应的功能，在Maven项目或者pom.xml上右击，再选择Run
As，就能看到如下的常见Maven命令，如下图所示： <img data-src="https://wulc.me/imgs/09f3ec72-eb31-3f25-97af-545213fe4793.jpg" />
选择想要执行的Maven命令就能执行相应的构建，同时我们也能在Eclipse的console中看到构建输出。这里常见的一个问题是，默认选项中没有我们想要执行的Maven命令怎么办？比如，默认带有mvn
test，但我们想执行mvn clean test，很简单，选择Maven buid…
以自定义Maven运行命令，在弹出对话框中的Goals一项中输入我们想要执行的命令，如clean
test，设置一下Name，点击Run即可。并且，下一次我们选择Maven
build，或者使用快捷键Alt + Shift + X,
M快速执行Maven构建的时候，上次的配置直接就能在历史记录中找到。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E8%BD%AC%E8%BD%BD/" rel="tag"><i class="fa fa-tag"></i> 转载</a>
              <a href="/tags/Java/" rel="tag"><i class="fa fa-tag"></i> Java</a>
              <a href="/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" rel="tag"><i class="fa fa-tag"></i> 工具使用</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2016/02/14/python%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%B1%9E%E6%80%A7%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%B1%9E%E6%80%A7/" rel="prev" title="python中的类属性和实例属性">
                  <i class="fa fa-chevron-left"></i> python中的类属性和实例属性
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2016/02/20/Hadoop2-6-0%E5%AE%89%E8%A3%85%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/" rel="next" title="Hadoop2.6.0安装注意事项">
                  Hadoop2.6.0安装注意事项 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2015 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-pen"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">良超</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js" integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>



  <script src="/js/third-party/fancybox.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
